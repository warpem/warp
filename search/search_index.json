{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Overview","text":"Process your cryo-EM data. Fast.  <p>   Welcome to warpem.com, the home of Warp, M, and friends on the internet. </p>"},{"location":"papers/","title":"Papers","text":""},{"location":"papers/#warp","title":"Warp","text":"<p>Real-time cryo-electron microscopy data preprocessing with Warp</p>"},{"location":"papers/#m","title":"M","text":"<p>Multi-particle cryo-EM refinement with M visualizes ribosome-antibiotic complex at 3.5\u00c5 in cells</p>"},{"location":"team/","title":"Team","text":"<ul> <li> <p>Dimitry Tegunov</p></li> <li> <p>Alister Burt</p></li> </ul> <p>Dimitry leads a research group at Genentech in the San Francisco Bay Area. He wrote Warp, M and friends during his PhD in Patrick Cramer's lab at the Max Planck Institute for Biophysical Chemistry in G\u00f6ttingen, Germany.</p> <p>Alister joined Dimitry at Genentech in late 2023. Alister was an early adopter of the Warp/M ecosystem who now helps out with development.</p>"},{"location":"home/m/","title":"M","text":"<ul> <li> Frame Series</li> <li> Tilt Series</li> <li> Reference Based</li> <li> High Resolution</li> <li> Refine Pose</li> <li> Model Electron Optics</li> <li> Model Sample Deformations</li> <li> Denoise References</li> </ul> <p>M is a reference based refinement engine which simultaneously refines particle poses, deformation models and electron optical parameters to get  the highest resolution maps from your frame series or tilt series data.</p> <p>Check out the User Guide to get started!</p>"},{"location":"home/warp/","title":"Warp","text":"<ul> <li> Frame Alignment</li> <li> Defocus Estimation</li> <li> Particle Picking</li> <li> Tomography</li> <li> Plug it in</li> <li> Beautiful UI</li> </ul> <p>Warp integrates algorithms for frame alignment, defocus estimation, particle picking and tomographic reconstruction in a rich user interface. Thanks to its on-the-fly processing mode and integration with SPA tools like cryoSPARC and RELION, you can monitor data quality in real time, analyze data at the microscope, and obtain high-resolution structures even before your data collection is over.</p> <p>Check out the User Guide to get started!</p>"},{"location":"home/warptools/","title":"WarpTools","text":""},{"location":"reference/reference/","title":"Reference","text":""},{"location":"reference/boxnet/fs_training/","title":"Frame Series Training","text":"<p>BoxNet can be trained on frame series data using WarpTools <code>fs_boxnet_train</code>.</p>"},{"location":"reference/boxnet/fs_training/#training-data-structure","title":"Training Data Structure","text":"<p>The <code>--examples</code> option to <code>WarpTools fs_boxnet_train</code> should be set to a folder containing TIFF files with examples.</p> <p>Each file should have three z-slices</p> <ul> <li>slice 0: the image data</li> <li>slice 1: ternary mask, 0 is bg, 1 is particle, 2 is mask</li> <li>slice 2: importance mask (not supported but need empty layer in file)</li> </ul> <p>All files should be at the same pixel size. Different files can contain images with different dimensions.</p>"},{"location":"reference/m/particle_operations/","title":"Particle Operations","text":"<p>Access the particle operations menu by clicking on a species' particle count.</p> <p></p>"},{"location":"reference/m/particle_operations/#intersect-with-another-particle-set","title":"Intersect with Another Particle Set","text":"<p>This dialog allows you to intersect the current particle set of a species (\"old set\") with another particle set defined in a STAR file (\"new set\").</p> <p>When loading particles from another M species, the source frame/tilt series are matched unambiguously, and the coordinates are always in \u00c5ngstrom. When loading a refinement or classification result from RELION, the data sources must be matched manually in case of name duplications, and the pixel size for the coordinates must be provided.</p> <p>Once loaded, particles matches between the two sets are found by solving the unbalanced assignment problem with the inter-particle distance as the cost function. You can specify a maximum tolerance distance for the matching, beyond which any matches will be dismissed. The inter-particle distance histogram can help you with that.</p> <p>The matching creates 3 sets: \"only old\", \"in both\" (intersection), and \"only new\". The particles in the intersection will keep their old poses. You can select any combination of them and update the species' particle list with the resulting set. For instance, if you want to add completely new particles (e.g., for a data source you didn\u2019t use before), set the tolerance distance to 0, and select \"only old\" and \"only new\". If you want to remove certain particles, set the tolerance distance accordingly and select \"only old\". If you want to keep only particles remaining after another classification run, select \"in both\". To remove particles that shifted too much during M\u2019s refinement, select the STAR file from the first version of the species, set the tolerance distance, and select \"in both\". The possibilities are quite limitless, yes, yes!</p>"},{"location":"reference/m/particle_operations/#export-sub-tomograms","title":"Export Sub-tomograms","text":"<p>M can refine per-particle pose trajectories. To consider them for export, please use this dialog rather than Warp\u2019s particle export. Some field values will be pre-populated based on the species' parameters, but feel free to change them. Particle export from frame series is currently not supported.</p> <p>Output will be scaled to: The target pixel size to which the tilt series data will be scaled prior to reconstruction. It can\u2019t be smaller than the size dictated by the Bin parameter in the Input settings section. The maximum resolution achievable with the data will be twice the pixel size.</p> <p>Box size is: The sub-tomogram box size in pixels. M avoids CTF aliasing by calculating the necessary minimum box size for the particle's defocus value and the expected maximum resolution, as dictated by the pixel size, and then crops the volume back to the value you specified. For high-defocus data and small boxes, this can make the high-resolution Thon rings invisible. Don't worry, this is fine. In fact, it is much finer than previous methods that would have made the data useless beyond the aliasing-free resolution.</p> <p>Particle diameter is: The particle diameter should be roughly the same you will use later in RELION, otherwise it might complain about incorrect normalization.</p> <p>Volumes / Image series: In addition to reconstructing 3D sub-tomograms, M can also generate a series of 2D tilt images for each particle. There is currently no use for this data type in RELION, unless you have giant particles with a lot of signal and would like to refine the particle tilt images completely independently like in EMAN 2.3. This is probably not a good idea.</p> <p>Shift by: You can shift all particle positions by the same amount in 3D. If the input STAR file contains refined particle orientations (rlnAngleRot/Tilt/Psi columns), the shift will be made in the refined map's reference frame. Use this if you have aligned all particles on a common part of the protein, and want to e.g., shift the map center to a ligand to analyze it further. Note that the shift values are in Angstrom.</p> <p>Pre-rotate particles: If refined particle orientations (rlnAngleRot/Tilt/Psi columns) are available, the reconstructions can be pre-rotated to their common reference frame. If you were to average the resulting sub-tomograms without considering any rotations (e.g., simply sum them up in Matlab), you would get the refined map. This can be useful if you\u2019re developing a new method to analyze the particles (e.g., variance, 3D PCA etc.) and don\u2019t want to bother with particle orientations. The 3D CTFs will be pre-rotated to the same reference frame, too.</p> <p>Limit to first N tilts by dose: The reconstructions or particle tilt series will contain only data from the first N tilts, sorted by dose. This can be useful if you think the late tilts don't contain any information that might help your analysis.</p> <p>Invert contrast: Multiply the input data by -1 to invert the contrast. Following standard conventions, black particles from cryo data will become white if this is enabled.</p> <p>Normalize input images: The scaled tilt images will be normalized to mean = 0, standard deviation = 1 prior to reconstruction.</p> <p>Normalize output volumes: Normalizes the reconstructions so that the volume outside the specified particle diameter is mean = 0, standard deviation = 1. This is required for RELION.</p> <p>Make 3D CTF sparse: Don't use this just yet! It requires a patch for RELION that isn\u2019t public yet. If enabled, every voxel of the 3D CTF with a value below 0.01 will be explicitly set to 0. This allows the patched RELION algorithms to completely exclude them from calculations, saving a lot of time.</p> <p>After clicking Export, M will ask you to specify the name and location of the output STAR file that will contain the paths of all volumes and their metadata. Use this file as input for RELION.</p>"},{"location":"reference/mtools/api/mcore/","title":"MCore","text":""},{"location":"reference/mtools/api/mcore/#mcore","title":"MCore","text":"<pre><code>MCore 2.0.0+db859c58158e0ac5179769d57c317a6c3b73b03d\nCopyright (C) 2024 MCore\n\n  --port                        (Default: 14300) Port to use for REST API calls,\n                                set to -1 to disable\n\n  --devicelist                  Space-separated list of GPU IDs to use for\n                                processing. Default: all GPUs in the system\n\n  --perdevice_preprocess        Number of processes per GPU used for map\n                                pre-processing; leave blank = default to\n                                --perdevice_refine value\n\n  --perdevice_refine            (Default: 1) Number of processes per GPU used\n                                for refinement; set to &gt;1 to improve utilization\n                                if your GPUs have enough memory\n\n  --perdevice_postprocess       Number of processes per GPU used for map\n                                pre-processing; leave blank = default to\n                                --perdevice_refine value\n\n  --workers_preprocess          List of remote workers to be used instead of\n                                locally spawned processes for map\n                                pre-processing. Formatted as hostname:port,\n                                separated by spaces\n\n  --workers_refine              List of remote workers to be used instead of\n                                locally spawned processes for refinement.\n                                Formatted as hostname:port, separated by spaces\n\n  --workers_postprocess         List of remote workers to be used instead of\n                                locally spawned processes for map\n                                post-processing. Formatted as hostname:port,\n                                separated by spaces\n\n  --population                  Required. Path to the .population file\n                                containing descriptions of data sources and\n                                species\n\n  --iter                        (Default: 3) Number of refinement sub-iterations\n\n  --first_iteration_fraction    (Default: 1) Use this fraction of available\n                                resolution for alignment in first sub-iteration,\n                                increase linearly to 1.0 towards last\n                                sub-iterations\n\n  --min_particles               (Default: 1) Only use series with at least N\n                                particles in the field of view\n\n  --cpu_memory                  Use CPU memory to store particle images during\n                                refinement (GPU by default)\n\n  --weight_threshold            (Default: 0.05) Refine each tilt/frame up to the\n                                resolution at which the exposure weighting\n                                function (B-factor) reaches this value\n\n  --refine_imagewarp            Refine image warp with a grid of XxY dimensions.\n                                Examples: leave blank = don't refine, '1x1',\n                                '6x4'\n\n  --refine_particles            Refine particle poses\n\n  --refine_mag                  Refine anisotropic magnification\n\n  --refine_doming               Refine doming (frame series only)\n\n  --refine_stageangles          Refine stage angles (tilt series only)\n\n  --refine_volumewarp           Refine volume warp with a grid of XxYxZxT\n                                dimensions (tilt series only). Examples: leave\n                                blank = don't refine, '1x1x1x20', '4x6x1x41'\n\n  --refine_tiltmovies           Refine tilt movie alignments (tilt series only)\n\n  --ctf_batch                   (Default: 32) Batch size for CTF refinements.\n                                Lower = less memory, higher = faster\n\n  --ctf_minresolution           (Default: 8) Use only species with at least this\n                                resolution (in Angstrom) for CTF refinement\n\n  --ctf_defocus                 Refine defocus using a local search\n\n  --ctf_defocusexhaustive       Refine defocus using a more exhaustive grid\n                                search in the first sub-iteration; only works in\n                                combination with ctf_defocus\n\n  --ctf_phase                   Refine phase shift (phase plate data only)\n\n  --ctf_cs                      Refine spherical aberration, which is also a\n                                proxy for pixel size\n\n  --ctf_zernike3                Refine Zernike polynomials of 3rd order (beam\n                                tilt, trefoil \u2013 fast)\n\n  --ctf_zernike5                Refine Zernike polynomials of 5th order (fast)\n\n  --ctf_zernike2                Refine Zernike polynomials of 2nd order (slow)\n\n  --ctf_zernike4                Refine Zernike polynomials of 4th order (slow)\n\n  --help                        Display this help screen.\n\n  --version                     Display version information.\n</code></pre>"},{"location":"reference/mtools/api/mtools/","title":"MTools","text":""},{"location":"reference/mtools/api/mtools/#create_population","title":"create_population","text":"<pre><code>MTools 2.0.0+db859c58158e0ac5179769d57c317a6c3b73b03d\nCopyright (C) 2024 MTools\n\n  -d, --directory    Required. Path to the directory where the new population\n                     will be located. All future species will also go there, so\n                     make sure there is enough space.\n\n  -n, --name         Required. Name of the new population.\n\n  --help             Display this help screen.\n\n  --version          Display version information.\n</code></pre>"},{"location":"reference/mtools/api/mtools/#create_source","title":"create_source","text":"<pre><code>MTools 2.0.0+db859c58158e0ac5179769d57c317a6c3b73b03d\nCopyright (C) 2024 MTools\n\n  -p, --population             Required. Path to the .population file to which\n                               to add the new data source.\n\n  -s, --processing_settings    Required. Path to a .settings file used to\n                               pre-process the frame or tilt series this source\n                               should include; desktop Warp will usually\n                               generate a previous.settings file\n\n  -n, --name                   Required. Name of the new data source.\n\n  --nframes                    Maximum number of tilts or frames to use in\n                               refinements. Leave empty or set to 0 to use the\n                               maximum number available.\n\n  --files                      Optional STAR file with a list of files to\n                               intersect with the full list of frame or tilt\n                               series referenced by the settings.\n\n  --help                       Display this help screen.\n\n  --version                    Display version information.\n</code></pre>"},{"location":"reference/mtools/api/mtools/#create_species","title":"create_species","text":"<pre><code>MTools 2.0.0+db859c58158e0ac5179769d57c317a6c3b73b03d\nCopyright (C) 2024 MTools\n\n  -p, --population          Required. Path to the .population file to which to\n                            add the new data source.\n\n  -n, --name                Required. Name of the new species.\n\n  -d, --diameter            Required. Molecule diameter in Angstrom.\n\n  -s, --sym                 (Default: C1) Point symmetry, e.g. C1, D7, O.\n\n  --helical_units           (Default: 1) Number of helical asymmetric units\n                            (only relevant for helical symmetry).\n\n  --helical_twist           Helical twist in degrees, positive = right-handed\n                            (only relevant for helical symmetry).\n\n  --helical_rise            Helical rise in Angstrom (only relevant for helical\n                            symmetry).\n\n  --helical_height          Height of the helical segment along the Z axis in\n                            Angstrom (only relevant for helical symmetry).\n\n  -t, --temporal_samples    (Default: 1) Number of temporal samples in each\n                            particle pose's trajectory.\n\n  --half1                   Required. Path to first half-map file.\n\n  --half2                   Required. Path to second half-map file.\n\n  -m, --mask                Required. Path to a tight binary mask file. M will\n                            automatically expand and smooth it based on current\n                            resolution\n\n  --angpix                  Override pixel size value found in half-maps.\n\n  --angpix_resample         Resample half-maps and masks to this pixel size.\n\n  --lowpass                 Optional low-pass filter (in Angstrom), applied to\n                            both half-maps.\n\n  --particles_relion        Path to _data.star-like particle metadata from\n                            RELION.\n\n  --particles_m             Path to particle metadata from M.\n\n  --angpix_coords           Override pixel size for RELION particle coordinates.\n\n  --angpix_shifts           Override pixel size for RELION particle shifts.\n\n  --ignore_unmatched        Don't fail if there are particles that don't match\n                            any data sources.\n\n  --help                    Display this help screen.\n\n  --version                 Display version information.\n</code></pre>"},{"location":"reference/mtools/api/mtools/#rotate_species","title":"rotate_species","text":"<pre><code>MTools 2.0.0+db859c58158e0ac5179769d57c317a6c3b73b03d\nCopyright (C) 2024 MTools\n\n  -p, --population    Required. Path to the .population file.\n\n  -s, --species       Required. Path to the .species file, or its GUID.\n\n  --angle_rot         Required. First Euler angle (Rot in RELION) in degrees.\n\n  --angle_tilt        Required. Second Euler angle (Tilt in RELION) in degrees.\n\n  --angle_psi         Required. Third Euler angle (Psi in RELION) in degrees.\n\n  --help              Display this help screen.\n\n  --version           Display version information.\n</code></pre>"},{"location":"reference/mtools/api/mtools/#shift_species","title":"shift_species","text":"<pre><code>MTools 2.0.0+db859c58158e0ac5179769d57c317a6c3b73b03d\nCopyright (C) 2024 MTools\n\n  -p, --population    Required. Path to the .population file.\n\n  -s, --species       Required. Path to the .species file, or its GUID.\n\n  -x                  Required. Shift along the X axis in Angstrom. New map\n                      center will be at current center + this value.\n\n  -y                  Required. Shift along the X axis in Angstrom. New map\n                      center will be at current center + this value.\n\n  -z                  Required. Shift along Z axis in Angstrom. New map center\n                      will be at current center + this value.\n\n  --help              Display this help screen.\n\n  --version           Display version information.\n</code></pre>"},{"location":"reference/mtools/api/mtools/#expand_symmetry","title":"expand_symmetry","text":"<pre><code>MTools 2.0.0+db859c58158e0ac5179769d57c317a6c3b73b03d\nCopyright (C) 2024 MTools\n\n  -p, --population    Required. Path to the .population file.\n\n  -s, --species       Required. Path to the .species file, or its GUID.\n\n  --expand_from       Symmetry to use for the expansion if it is different from\n                      the one specified in the species (e.g. expand only one\n                      sub-symmetry of a higher symmetry).\n\n  --expand_to         Remaining symmetry that will be set as the species'\n                      symmetry, e.g. C1 (when using --expand_from to expand only\n                      part of the symmetry).\n\n  --helical_units     (Default: 1) Number of asymmetric subunits in the helical\n                      symmetry to expand\n\n  --helical_twist     Twist of the helical symmetry to expand, in degrees\n\n  --helical_rise      Rise of the helical symmetry to expand, in Angstrom\n\n  --help              Display this help screen.\n\n  --version           Display version information.\n</code></pre>"},{"location":"reference/mtools/api/mtools/#resample_trajectories","title":"resample_trajectories","text":"<pre><code>MTools 2.0.0+db859c58158e0ac5179769d57c317a6c3b73b03d\nCopyright (C) 2024 MTools\n\n  -p, --population    Required. Path to the .population file.\n\n  -s, --species       Required. Path to the .species file, or its GUID.\n\n  --samples           Required. The new number of samples, usually between 1\n                      (small particles) and 3 (very large particles).\n\n  --help              Display this help screen.\n\n  --version           Display version information.\n</code></pre>"},{"location":"reference/mtools/api/mtools/#update_mask","title":"update_mask","text":"<pre><code>MTools 2.0.0+db859c58158e0ac5179769d57c317a6c3b73b03d\nCopyright (C) 2024 MTools\n\n  -p, --population    Required. Path to the .population file.\n\n  -s, --species       Required. Path to the .species file, or its GUID.\n\n  -m, --map           Required. Path to the MRC map to be used to create the new\n                      mask.\n\n  -t, --threshold     Required. Binarization threshold to convert the input map\n                      to a mask.\n\n  -d, --dilate        (Default: 0) Dilate the binary mask by this many voxels.\n\n  -c, --center        Center the species around the new mask's center of mass.\n\n  --help              Display this help screen.\n\n  --version           Display version information.\n</code></pre>"},{"location":"reference/mtools/api/mtools/#list_species","title":"list_species","text":"<pre><code>MTools 2.0.0+db859c58158e0ac5179769d57c317a6c3b73b03d\nCopyright (C) 2024 MTools\n\n  -p, --population    Required. Path to the .population file.\n\n  --help              Display this help screen.\n\n  --version           Display version information.\n</code></pre>"},{"location":"reference/mtools/api/mtools/#list_sources","title":"list_sources","text":"<pre><code>MTools 2.0.0+db859c58158e0ac5179769d57c317a6c3b73b03d\nCopyright (C) 2024 MTools\n\n  -p, --population    Required. Path to the .population file.\n\n  --help              Display this help screen.\n\n  --version           Display version information.\n</code></pre>"},{"location":"reference/mtools/api/mtools/#add_source","title":"add_source","text":"<pre><code>MTools 2.0.0+db859c58158e0ac5179769d57c317a6c3b73b03d\nCopyright (C) 2024 MTools\n\n  -p, --population    Required. Path to the .population file.\n\n  -s, --source        Required. Path to the .source file.\n\n  --help              Display this help screen.\n\n  --version           Display version information.\n</code></pre>"},{"location":"reference/mtools/api/mtools/#remove_species","title":"remove_species","text":"<pre><code>MTools 2.0.0+db859c58158e0ac5179769d57c317a6c3b73b03d\nCopyright (C) 2024 MTools\n\n  -p, --population    Required. Path to the .population file.\n\n  -s, --species       Required. Path to the .species file, or its GUID.\n\n  --help              Display this help screen.\n\n  --version           Display version information.\n</code></pre>"},{"location":"reference/mtools/api/mtools/#remove_source","title":"remove_source","text":"<pre><code>MTools 2.0.0+db859c58158e0ac5179769d57c317a6c3b73b03d\nCopyright (C) 2024 MTools\n\n  -p, --population    Required. Path to the .population file.\n\n  -s, --source        Required. Path to the .source file, or its GUID.\n\n  --help              Display this help screen.\n\n  --version           Display version information.\n</code></pre>"},{"location":"reference/noise2map/noise2map/","title":"3D Denoising with Noise2Map","text":""},{"location":"reference/noise2map/noise2map/#overview","title":"Overview","text":"<p>Noise2Map is a command-line tool included in Warp's installation directory for training a denoising neural network on volumetric data, based on the noise2noise principle. It requires adding the installation directory to your PATH for easier execution.</p>"},{"location":"reference/noise2map/noise2map/#system-requirements","title":"System Requirements","text":"<ul> <li>At least two GPUs, or one GPU with a minimum of 16 GB memory.</li> </ul>"},{"location":"reference/noise2map/noise2map/#data-types-supported","title":"Data Types Supported","text":"<ul> <li>Half-map reconstructions from single particle data.</li> <li>Tomograms.</li> </ul>"},{"location":"reference/noise2map/noise2map/#usage","title":"Usage","text":""},{"location":"reference/noise2map/noise2map/#denoising-half-maps","title":"Denoising Half-Maps","text":"<ul> <li>Data Setup: Place the first map of each pair in one folder (e.g., \"odd\"), and the   second in another (e.g., \"even\"). Ensure file names are identical across folders.</li> <li>Execution: Use arguments like <code>--observation1</code> and <code>--observation2</code> to specify   folder paths.</li> <li>Additional Parameters:<ul> <li><code>--mask</code>: Path to a binary mask to help balance training samples.</li> <li><code>--dont_flatten_spectrum</code>: Disable amplitude spectrum flattening.</li> <li><code>--overflatten_factor</code>: Adjusts the degree of flattening or sharpening.</li> <li><code>--lowpass</code> and <code>--angpix</code>: Used to set filtering based on resolution and   pixel size.</li> </ul> </li> <li>Training: Typical training involves 600 iterations but can be adjusted based on   GPU memory constraints.</li> </ul>"},{"location":"reference/noise2map/noise2map/#denoising-tomograms","title":"Denoising Tomograms","text":"<ul> <li>Data Preparation: Utilize Warp's UI to separate odd/even tilt images and   potentially pre-deconvolve them.</li> <li>Key Differences in Parameters:<ul> <li>Do not use a mask.</li> <li>Set <code>--dont_flatten_spectrum</code>.</li> <li>Typically requires more than 10,000 iterations.</li> </ul> </li> </ul>"},{"location":"reference/noise2map/noise2map/#output","title":"Output","text":"<ul> <li>Denoised maps are saved in a \"denoised\" folder. Separate denoising of half-maps can be   specified.</li> </ul>"},{"location":"reference/noise2map/noise2map/#note","title":"Note","text":"<ul> <li>If reusing a model (<code>--old_model</code>), ensure that the filtering parameters match those   used during its training to avoid invalidating the model.</li> </ul>"},{"location":"reference/warp/defocus_handedness/","title":"Defocus Handedness","text":""},{"location":"reference/warp/models/","title":"Spatiotemporal Models","text":"<p>From Real-time cryo-electron microscopy data preprocessing with Warp</p> <p>Many methods in Warp are based on a continuous parametrization of 1- to 3-dimensional spaces. This parameterization is achieved by spline interpolation between points on a coarse, uniform grid, which is computationally efficient. A grid extends over the entirety of each dimension that needs to be modeled. The grid resolution is defined by the number of control points in each dimension and is scaled according to physical constraints (for example, the number of frames or pixels) and available signal. The latter provides regularization to prevent overfitting of sparse data with too many parameters. When a parameter described by the grid is retrieved for a point in space (and time), for example for a particle (frame), B-spline interpolation is performed at that point on the grid. To fit a grid\u2019s parameters, in general, a cost function associated with the interpolants at specifc positions on the grid is optimized. In the following, we distinguish between 2\u20133 spatial grid dimensions (X and Y axes in micrographs; X, Y and Z in tomographic volumes), and a temporal dimension as a function of the accumulated electron dose. We note that B-splines are only used to interpolate parameters, not image data. For the latter higher-order schemes are used.</p>"},{"location":"reference/warp/task_dialogs_frame_series/","title":"Frame Series Task Dialogs","text":""},{"location":"reference/warp/task_dialogs_tilt_series/","title":"Tilt Series Task Dialogs","text":""},{"location":"reference/warp/task_dialogs_tilt_series/#reconstruct-full-tomograms","title":"Reconstruct Full Tomograms","text":"<p>This dialog allows you to reconstruct \"full tomograms\", i.e., volumes located at the center of the tilt series with the Unbinned tomogram dimensions set previously in the Input settings section. These tomograms can be used for visual inspection and template matching. Important: Unlike other pipelines, where the reconstruction of a giant, unbinned tomogram is required to extract sub-tomograms at unbinned pixel size from it, Warp's workflow expects you to use the dedicated sub-tomogram reconstruction dialog to obtain sub-tomograms with an unbinned/very small pixel size. Reconstructing a very large tomographic volume in Warp will take very long and has a good chance of crashing.</p> <p>The reconstructed tomograms will be located in the reconstruction subfolder, and the file names will contain the pixel size as a suffix. Tomogram reconstruction will be skipped for items that already have volumes saved at that pixel size. If you would like to replace them, please delete the volumes manually from the reconstruction subfolder.</p> <ul> <li>Pixel size: The target pixel size to which the tilt series data will be scaled   prior to reconstruction. It can't be smaller than the size dictated by the Bin   parameter in the Input settings section. The maximum resolution achievable with   the data will be twice the pixel size.</li> <li>Invert contrast: Multiply the input data by -1 to invert the contrast. Following   standard conventions, black particles from cryo data will become white if this is   enabled.</li> <li>Normalize input images: The scaled tilt images will be normalized to mean = 0,   standard deviation = 1 prior to reconstruction.</li> <li>Also produce deconvolved version: In addition to the normal reconstruction, a   deconvolved version will be made and stored in the reconstruction/deconv subfolder.   The visual effect is depicted here. Please   also refer to that page for parameter description. The defaults are often fine.</li> <li>Separate odd/even tilts for denoising: In addition to the normal reconstruction, a   pair of reconstructions from all odd and even tilts will be made and stored in the   reconstruction/odd and reconstruction/even subfolders. These pairs can be used   to train a 3D denoiser. If Also produce   deconvolved version is checked, both tomograms will have the same deconvolution   filter applied to them.</li> <li>Keep only fully covered voxels: If enabled, voxels in the reconstruction that are   not covered by all of the tilts due to excessive shifts or rotations will be zeroed   out. Do not enable this if you intend to perform template matching on the tomograms \u2013   it will lead to artifacts. The template matching procedure itself will apply a similar   mask to the result.</li> </ul>"},{"location":"reference/warp/task_dialogs_tilt_series/#export-particles","title":"Export Particles","text":""},{"location":"reference/warp/task_dialogs_tilt_series/#export-sub-tomograms","title":"Export Sub-Tomograms","text":"<p>This dialog allows you to reconstruct \"sub-tomograms\", i.e., small, cubic volumes centered around a set of 3D coordinates you provide. The pixel size of these reconstructions is usually much smaller than the one used for full tomogram reconstruction because the volumes are later aligned on a common target and averaged to obtain better signal. Warp also reconstructs a 3D CTF volume for each particle to be used in RELION's refinement procedure.</p> <p>If you're only starting to incorporate Warp into your tomography pipeline, a few things can go wrong at this step. The first sanity check to do after sub-tomogram export is to average all the volumes and hopefully observe a white blob in the middle of the average. This way you know that the particle positions coincide with the actual particles, as opposed to being off if something ist wrong. The easiest way to get the average is to use RELION's <code>relion_reconstruct</code> (or <code>relion_reconstruct_mpi</code> for the parallelized version). The command looks something like this:</p> <pre><code>relion_reconstruct --i particles_from_warp.star --o rec.mrc --3d_rot --ctf\n</code></pre> <p>Before you see the actual dialog, Warp will ask you to provide a file with particle coordinates. Only RELION's STAR format is currently supported. The file must contain at least the <code>rlnCoordinateX/Y/Z</code> columns. If <code>rlnOriginX/Y/Z</code> are specified, Warp will consider them, and the values will be reset to 0 in the STAR file Warp generates. You can use either a single file for all tilt series or, if you have one file per tilt series (e.g., after template matching) with names formatted as <code>[series name]_suffix.star</code>, you can point Warp to one of those files and it will figure out the suffix automatically and find all remaining files in the same folder. In the second case, One input file per tilt series will become checked. If you'd like to use just the file you selected and reconstruct sub-tomograms from only one tilt series, you can uncheck it.</p> <p>Coordinates use...: If the coordinates come from RELION, they are in pixels. Because you might want to switch the pixel size occasionally, Warp handles all coordinates in Angstrom internally. Thus, you need to specify the pixel size used in that particular STAR file. It is assumed to be the same for <code>rlnCoordinateX/Y/Z</code> and <code>rlnOriginX/Y/Z</code>.</p> <p>Coordinates are normalized: If the coordinates come from Warp's template matching, they are normalized to a range of [0; 1]. Warp will automatically scale them back to the physical tomogram dimensions if you check this option.</p> <p>Output will be scaled to...: The target pixel size to which the tilt series data will be scaled prior to reconstruction. It can\u2019t be smaller than the size dictated by the Bin parameter in the Input settings section. The maximum resolution achievable with the data will be twice the pixel size.</p> <p>Box size is...: The sub-tomogram box size in pixels. Warp avoids CTF aliasing by calculating the necessary minimum box size for the particle's defocus value and the expected maximum resolution, as dictated by the pixel size, and then crops the volume back to the value you specified. For high-defocus data and small boxes, this can make the high-resolution Thon rings invisible. Don't worry, this is fine. In fact, it is much finer than previous methods that would have made the data useless beyond the aliasing-free resolution.</p> <p>Particle diameter is...: The particle diameter should be roughly the same you will use later in RELION, otherwise it might complain about incorrect normalization.</p> <p>Volumes / Image series: In addition to reconstructing 3D sub-tomograms, Warp can also generate a series of 2D tilt images for each particle. There is currently no use for this data type in RELION, unless you have giant particles with a lot of signal and would like to refine the particle tilt images completely independently like in EMAN 2.3. This is probably not a good idea.</p> <p>Shift by...: You can shift all particle positions by the same amount in 3D. If the input STAR file contains refined particle orientations (<code>rlnAngleRot/Tilt/Psi</code> columns), the shift will be made in the refined map's reference frame. Use this if you have aligned all particles on a common part of the protein, and want to e.g. shift the map center to a ligand to analyze it further. Note that the shift values are in Angstrom.</p> <p>Pre-rotate particles: If refined particle orientations (<code>rlnAngleRot/Tilt/Psi</code> columns) are available, the reconstructions can be pre-rotated to their common reference frame. If you were to average the resulting sub-tomograms without considering any rotations (e.g. simply sum them up in Matlab), you would get the refined map. This can be useful if you're developing a new method to analyze the particles (e.g. variance, 3D PCA etc.) and don't want to bother with particle orientations. The 3D CTFs will be pre-rotated to the same reference frame, too.</p> <p>Limit to first N tilts by dose: The reconstructions or particle tilt series will contain only data from the first N tilts, sorted by dose. This can be useful if you think the late tilts don't contain any information that might help your analysis.</p> <p>Invert contrast: Multiply the input data by -1 to invert the contrast. Following standard conventions, black particles from cryo data will become white if this is enabled.</p> <p>Normalize input images: The scaled tilt images will be normalized to mean = 0, standard deviation = 1 prior to reconstruction.</p> <p>Normalize output volumes: Normalizes the reconstructions so that the volume outside the specified particle diameter is mean = 0, standard deviation = 1. This is required for RELION.</p> <p>Make 3D CTF sparse: Don't use this just yet! It requires a patch for RELION that isn't public yet. If enabled, every voxel of the 3D CTF with a value below 0.01 will be explicitly set to 0. This allows the patched RELION algorithms to completely exclude them from calculations, saving a lot of time.</p> <p>Make paths relative to STAR: Paths to the reconstructed volumes and 3D CTFs will be made relative to wherever you choose to save the output STAR file. Usually a good idea.</p> <p>After clicking Export, Warp will ask you to specify the name and location of the output STAR file that will contain the paths of all volumes and their metadata. Use this file as input for RELION.</p>"},{"location":"reference/warp/ts_ctf_estimation/","title":"Tilt Series CTF Estimation","text":""},{"location":"reference/warp/ts_ctf_estimation/#contrast-transfer-function-estimation-in-tilt-series","title":"Contrast transfer function estimation in tilt series","text":"<p>From Real-time cryo-electron microscopy data preprocessing with Warp</p> <p>The single micrograph CTF estimation procedure with planar sample geometry described in the previous section can be used for tilted 2D data collection. However, full tilt series pose additional challenges for CTF fitting. Mechanical stage instabilities and imperfect eucentric height setting necessitate additional exposures for tracking and focusing to correct the stage position between individual tilt images. Thus, the defocus cannot be assumed to stay constant, or change smoothly over the course of a tilt series. Each tilt image requires its own defocus value, which can be challenging due to the small amount of signal available. Even at 120 e- per \u00c5\u00b2 for an entire series of 60 images, each tilt only has 2 e- per \u00c5\u00b2 to perform the same estimation as for a 40 e- per \u00c5\u00b2 2D image, while striving to achieve comparable accuracy.</p> <p>CTF estimation in tilt series has traditionally received less attention than its equivalent in 2D data, with the most recent publication predating the introduction of direct electron detectors and phase plates. As the resolution obtainable through sub-tomogram averaging has come close to parity with 2D data since then, simplifying assumptions such as the neglect of astigmatism or the assumed flatness of the sample can limit the resolution. Combined with the lack of integration of dedicated tilt series CTF estimation tools into common sub-tomogram averaging pipelines, this has created a situation in which state-of-the-art studies employ tools designed for 2D data, such as CTFFIND.</p> <p>To improve the fit accuracy, the individual tilt image fits must be subjected to a common set of constraints. As the imaged sample content does not change significantly throughout the tilt series, 1D background and envelope can be derived from the average 1D spectrum of all tilt images. The relative tilt angles and the tilt axis orientation are known to a higher precision than could be derived from fitting a planar geometry de novo, and are kept constant throughout the optimization, as suggested previously. However, the absolute inclination of the sample plane is unknown. This is especially critical in some of the typical applications of tomography, like the imaging of lamellae prepared through focused ion beam (FIB) milling because a lamella can be tilted by over 20\u00b0 relative to the grid. This additional inclination remains constant throughout the tilt series, and is made a single optimizable parameter for all tilt images. Astigmatism and, optionally, phase shift can be kept constant throughout 2D image exposures, but can benefit from a temporally resolved model in a tilt series where the overall exposure is fractionated over a much longer time, for example 20\u201330 min. Warp uses these three control points in the temporal dimension to model these parameters.</p> <p>With these considerations, the full estimation process is as follows. 2D patches are extracted from all aligned tilt movie averages, as described in the micrograph CTF fitting procedure, and treated in parallel in all subsequent calculations. To provide a better initialization for the per-tilt defocus searches, an estimate for the average defocus of the entire series is obtained by prepping 1D spectra from all patches, and comparing them to simulated CTF curves for the defocus values at the respective positions and tilts, taking into account the fixed relative tilt information and the currently tested average defocus (and phase shift, optionally). This search is performed exhaustively over a range of values specified by the user. The result is used as the starting point of a more complex optimization. Defocus values for all individual tilts, three astigmatism magnitude\u2013angle pairs, three optional phase shift values, and the two global inclination angles (that is the plane normal) are optimized using the L-BFGS algorithm with the derivatives obtained numerically as described in the micrograph CTF fitting section. Upon convergence, the 1D spectra of all patches are rescaled to a common defocus value. This is especially useful for validation in tilt series since the individual images will have very noisy spectra. If the useful resolution range does not extend sufficiently beyond the fitting range, the latter is automatically decreased and the optimization repeated.</p> <p>In our experience, the direction of the tilt axis is often miscalibrated. Correct handedness in structures obtained from sub-tomogram averaging does not guarantee the tilt angle sign is not flipped. In Warp, a positive rotation around the positive Y image axis is defined to result in an increased underfocus at positions to the positive X side of the tilt axis, that is those parts of the sample comically closer to the electron beam source. The CTF fitting procedure in Warp can detect such mistakes by optionally repeating the optimization with the tilt angles flipped, and notifying the user if the ' wrong' set of angles provides a better fit. Such a test can be used to re-calibrate the acquisition software for future data collection.</p>"},{"location":"reference/warp/interface/interface_overview/","title":"Warp Interface Overview","text":"<p>Switch between the light and dark UI themes.</p> <p></p> <p>All available GPUs are listed here, together with their free memory capacity. The checkboxes can be unticked to exclude specific GPUs from processing.</p> <p></p> <p>Warp automatically saves the latest set of processing settings used for a folder. These buttons allow saving and loading a permanent copy of the settings. Warp will also offer to load a folder's auto-saved settings when switching to that folder in the input options.</p> <p></p>"},{"location":"reference/warp/interface/interface_overview/#input-folder","title":"Input Folder","text":"<p>The input folder contains all the files that should be processed. Warp will not look for files recursively in sub-folders, so all files must be located on the top level. Several file formats are supported: MRC, EM (from the TOM Toolbox), header-less (anything binary with a fixed header length), and Warp's own TomoSTAR for tilt series definition. If you're working with a header-less format (or any format Warp doesn't recognize yet), select the DAT option, and specify the frame dimensions, data type, and an optional offset at the beginning of the files. Only the *.dat extension is supported for the file names, but you can use any header-less format by renaming them. Warp's interface switches to tomography mode if TomoSTAR is selected as the input format.</p> <p>The pixel size in the X and Y dimensions refers to the raw, unbinned data. If you haven't determined the magnification anisotropy for your microscope, both numbers will be the same. The anisotropy angle specifies the anti-clockwise rotation of this X/Y coordinate system. The anisotropy will be considered for CTF fitting and corrected (i.e., equalized) in the exported particles and full tomogram reconstructions. However, whole-micrograph averages remain uncorrected, so particle positions don't need to be rescaled when you decide to change the anisotropy parameters.</p> <p>The binning factor can assume any positive rational values. The frames will be Fourier-cropped to Size / 2^n.</p> <p>If you enter any non-zero electron dose value, frames will be weighted in all operations that produce averages, e.g., aligned movie or particle averages. The weighting is implemented as a B-factor of -3*Dose \u00c5^2. Please don't forget to convert the dose value to the correct units.</p> <p>The raw data can be multiplied by a gain reference to correct for systematic errors in pixel intensities. Please make sure the gain reference matches the data. Warp will tell you if the dimensions don't match, but it can't detect if the reference is flipped in X or Y. For instance, older Digital Micrograph versions flip the output in Y when converting a DM4 gain reference to MRC.</p>"},{"location":"reference/warp/interface/interface_overview/#ctf-settings","title":"CTF Settings","text":"<p>The Window specifies the size of the power spectrum. If you expect only low defocus values or need highly localized defocus values, leave the window small, e.g., 512 px.</p> <p>The Range specifies the spatial frequencies used for fitting. It is usually best to ignore the lowest frequencies. If you specify a defocus model without spatial resolution (see the next section), you can set the maximum range to 1.0. If you are fitting a highly resolved model, keep the maximum value lower to prevent overfitting.</p> <p>In some cases (e.g., very low dose images), the fitting will work better if the power spectrum is created from the aligned movie average instead of the per-frame power spectra \u2013 check Use Movie Sum to do that.</p> <p>The Voltage and C_S (spherical aberration) values are specific to your microscope model. A Titan Krios is usually operated at 300 kV, and C_S is 2.7 mm in most modes.</p> <p>The C_C (chromatic aberration), Illumination Aperture, and \u0394E (energy spread) values are currently not used but might become relevant in future versions of Warp. Just leave the defaults for now \u2013 we'll figure out what to do with them later!</p> <p>The Amplitude value defines the fraction of amplitude contrast in the CTF. Commonly used values for cryo data are 0.07 and 0.10, while negative stain data are often fitted with 0.20.</p> <p>The Defocus spread defines the range of defocus values for the initial exhaustive search. Set both values to match the range specified in your acquisition software with a bit of a margin.</p> <p>When dealing with data acquired with a phase plate, check Phase Shift to fit that parameter as well.</p> <p>Mode Ice Ring is currently an experimental feature that will attempt to model the CTF around the 3.6 \u00c5 amorphous ice ring separately from the rest of the power spectrum.</p>"},{"location":"reference/warp/interface/interface_overview/#motion-estimation","title":"Motion Estimation","text":"<p>Global and local motion estimation will consider the specified range of spatial frequencies and weight their importance according to the B-factor. The default range of 0.05\u20130.25 is usually ok for data with 1.00\u20131.35 \u00c5/px. For larger pixels, consider increasing the range, and vice versa. The more negative the B-factor, the less the higher spatial frequencies will be considered.</p>"},{"location":"reference/warp/interface/interface_overview/#models","title":"Models","text":"<p>Defocus: The first two values define the spatial resolution, i.e., how locally the defocus will be estimated (the value at each particle's position is later interpolated based on the values in that coarse model). 5\u00d75 is usually a good value for a 4K micrograph at 1.0\u20131.3 \u00c5/px. Higher values could make sense for larger pixels, and lower values for smaller pixels. The third parameter defines the temporal resolution. This allows changes in defocus and phase shift to be modeled over the duration of a single movie. Please note that a temporal resolution higher than 1 leads to a vastly increased memory footprint during processing, while probably not improving the final resolution in most cases.</p> <p>Motion: As with the CTF model, the first two parameters for the motion model describe the spatial resolution, and the third describes the temporal resolution. The spatial resolution will be considered in fitting the local beam-induced motion, while the full specified temporal resolution will be used for fitting the global motion. The temporal resolution can usually match the number of frames in the movies. However, if the movies are acquired at an unusually low dose rate, i.e., far less than 1 e/px/frame, you can set the temporal resolution to approximately match the overall electron dose per pixel.</p>"},{"location":"reference/warp/interface/interface_overview/#picking","title":"Picking","text":"<p>Clicking Select BoxNet model... or the currently selected model's name will open a dialog with a list of all available models, and buttons to either use one of them, or retrain it with your own data. User guide pages about using and retraining BoxNet models will provide you with more details.</p> <p>The Diameter setting controls how close two particles can be together before the particle with lower probability is dismissed from the picks. The Data Type determines whether the sign of the data is flipped before picking (negative stain), or not (cryo). A Minimum Score threshold is applied to BoxNet's predictions. When using a model specifically pre-trained on the current protein species, the score can be typically left at its default value of 0.95. Picking new species with the generic version can sometimes require lower threshold values to pick up everything.</p> <p>If you're using a BoxNet version that can create masks, you can enforce a Minimum Distance between particles borders (as defined by their diameter) and \ud83d\udca9.</p> <p>The picked particles can be extracted immediately after the picking, which is especially useful for real-time processing. For that, the Box Size must be set \u2013 ca. 150 % of the particle diameter is recommended to avoid interpolation artifacts later. The pixel size is fixed to that used for the entire pre-processing pipeline. If you want to extract particles with a different pixel size, you can do so later using one of the Task Dialogs. Cryo data need to be inverted upon extraction. For SPA packages that require particles to be pre-normalized, e.g., RELION, the diameter used for picking will also be used for background normalization.</p>"},{"location":"reference/warp/interface/interface_overview/#output","title":"Output","text":"<p>The first few frames in a movie suffer especially badly from beam-induced motion and can usually be discarded by adjusting the output frame range. This setting will also be respected in all other operations that deal with frames, e.g., particle extraction.</p> <p>In addition to extracted particles, there are 3 output types for 2D movies:</p> <p>Average: You will almost always want to produce an average in order to inspect the micrographs visually. You can also use other tools to extract particles from them if you don't want to use Warp for that.</p> <p>Deconvolved Average: The same deconvolved version of the average you can see live in the Real Space tab, written out as an MRC file. This can be useful for inspecting the micrographs with better contrast in other tools, but is usually not needed if you only want to screen the data in Warp. Please note that despite the seemingly better contrast, operations like particle picking won't work better on the deconvolved images.</p> <p>Aligned Stack: Some workflows \u2013 RELION's particle polishing in particular \u2013 rely on pre-aligned movies as input. Please note that aligned movies are very large and will create significant storage and processing overhead. To save some space, you can collapse groups of consecutive frames into one.</p>"},{"location":"reference/warp/interface/interface_overview/#processing-mode","title":"Processing Mode","text":"<p>Clicking Start Processing puts Warp into processing mode. This mode remains active until Stop Processing is clicked. Editing any processing settings and launching task dialogs is disabled while in processing mode, but viewing and editing processing results (e.g., particle positions) is enabled.</p> <p>Warp will go through all items in need of processing sequentially (sorted alphabetically) and perform the currently selected processing steps. If processing results are already available for some steps (e.g., CTF or motion) and their settings match the current ones, the processing will not be repeated for those specific steps to save time. However, some processing steps depend on the results of other steps. For instance, particle picking depends on frame alignment because it uses the average. If frame alignment is reprocessed, particle picking will be performed again subsequently.</p>"},{"location":"reference/warp/interface/interface_overview/#settings-collapse","title":"Settings Collapse","text":"<p>This button lets you collapse the settings panel to make more room for the results. With the settings collapsed, there is enough space to display Fourier and Real Space results side by side on a large screen, so both tabs will be merged.</p> <p></p> <p>In addition to on-the-fly processing, Warp offers several offline tasks that can be performed once the processing is finished. Most of the tasks are related to importing and exporting data from/to RELION and compatible packages. Each task is explained in a detailed user guide page.</p>"},{"location":"reference/warp/interface/interface_overview/#plot-status","title":"Plot Status","text":"<p>As movies are processed, they change their status. Every movie is initially marked as unprocessed. Once it has passed through the entire pipeline, it is considered processed. If you change any processing settings, previously processed items will be marked as outdated, i.e., in need of reprocessing. If a processed item's quality criteria don't match the current filter thresholds (see section below), it is labeled filtered out. Finally, if you deselect an item manually in the navigation bar, it will be colored as deselected.</p>"},{"location":"reference/warp/interface/interface_overview/#astigmatism-plot","title":"Astigmatism Plot","text":"<p>The astigmatism plot shows each movie's fitted astigmatism in a 2D coordinate system. The coordinates are computed as <code>X = cos(2 * angle) * magnitude, Y = sin(2 * angle) * magnitude</code>. This means the circumference of the depicted circle is only 180\u00b0 (the fitted angles are only unique within 0\u2013180\u00b0). The color reflects an item's coordinate on the time axis, going from old to new.</p> <p>Unlike the other filters, the astigmatism filter considers the distance of a movie's astigmatism to the entire dataset's mean astigmatism, normalized by its standard deviation. Thus, whenever an item's astigmatism value changes, the entire filter is re-evaluated without an explicit change in the threshold.</p> <p></p> <p>As soon as an item is processed, its key parameters are added to or updated in the plots: Defocus, astigmatism, phase shift, estimated resolution, average intra-frame motion, number of particles, and the percentage of masked micrograph area. Some of the parameters are likely correlated with the data quality. Using the sliders above the plots in the Overview tab, you can define Filter Thresholds for all of them.</p> <p>As you change a filter threshold, processed items above and below the threshold will change their status between processed and filtered out. Filtered out items can be excluded from all tasks. During on-the-fly processing with particle picking enabled, items that pass all filters are maintained in a separate goodparticles_BoxNetName.star file.</p>"},{"location":"reference/warp/interface/interface_overview/#particle-count-filter","title":"Particle Count Filter","text":"<p>The particle count filter has a special additional parameter: the particle file suffix. All particle coordinates are stored as per-movie STAR files in <code>[Input Folder]/matching</code>. Multiple files can be associated with the same movie by using different suffixes. When a movie is added to Warp's list, it automatically finds all available suffixes for that item. The suffix menu contains the superset of all available suffixes of all items. If you manually add STAR files to the matching folder, you need to restart Warp so it can find the new files.</p> <p>The filter can only consider one suffix at a time. Please note that the suffix doesn't update automatically if you start re-picking the data with a different BoxNet model. The suffix list will contain the new BoxNet's name once at least one micrograph has been picked.</p>"},{"location":"reference/warptools/advanced_data_flow/","title":"Advanced Data Flow","text":"<p>By default WarpTools directories for raw data and processed data are specified in a <code>.settings</code> text file created with the <code>create_settings</code> tool.</p> <p>This page is for advanced users who want to customise data flow in their WarpTools  processing.</p>"},{"location":"reference/warptools/advanced_data_flow/#concepts","title":"Concepts","text":"<p>Customising data flow using WarpTools requires understanding a few key concepts.</p> <ol> <li>raw data directory</li> <li>processing directory</li> </ol>"},{"location":"reference/warptools/advanced_data_flow/#raw-data-directory","title":"Raw data directory","text":"<p>The raw data directory contains what WarpTools considers the raw data. For frame series, raw data are movie files, usually <code>.mrc</code> or <code>.tif</code>.  For tilt series, raw data are <code>.tomostar</code> files.</p>"},{"location":"reference/warptools/advanced_data_flow/#processing-directory","title":"Processing directory","text":"<p>Outputs from all WarpTools programs will be written into the processing directory.</p> <p>Per movie or per tilt series metadata will be written in <code>.xml</code> files in the root of the processing directory whilst images and other process specific data are written into  subdirectories of the processing directory with names like <code>average</code>, <code>matching</code> or <code>reconstruction</code>.</p>"},{"location":"reference/warptools/advanced_data_flow/#redirecting-the-flow","title":"Redirecting the Flow","text":"<p>Now that we know the basics, we're ready to redirect the processing flow.</p> <p>Here are the relevant options available in all WarpTools commands.</p>"},{"location":"reference/warptools/advanced_data_flow/#options","title":"Options","text":""},{"location":"reference/warptools/advanced_data_flow/#-input_data","title":"<code>--input_data</code>","text":"<p>The <code>--input_data</code> option overrides the list of input files specified in the .settings file.  It accepts a space-separated list of files, wildcard patterns, or .txt files with one file name per line.</p>"},{"location":"reference/warptools/advanced_data_flow/#-input_processing","title":"<code>--input_processing</code>","text":"<p><code>--input_processing</code> specifies an alternative directory containing pre-processed results. This overrides the processing directory specified in the <code>.settings</code> file and affects  both file input and output.</p>"},{"location":"reference/warptools/advanced_data_flow/#-output_processing","title":"<code>--output_processing</code>","text":"<p><code>--output_processing</code> specifies an alternative directory to save processing results.  This also overrides the processing directory in the .settings file, but only for file output.</p>"},{"location":"reference/warptools/advanced_data_flow/#examples","title":"Examples","text":"<p>Let's go through some examples...</p>"},{"location":"reference/warptools/advanced_data_flow/#generating-particle-stacks-for-multiple-species","title":"Generating Particle Stacks for Multiple Species","text":"<p>When WarpTools generates 2D or 3D particles from tilt series data it writes image files into <code>&lt;processing_directory&gt;/particleseries</code> and <code>&lt;processing_directory&gt;/subtomo</code> respectively with file names like <code>TS_1_4.00A_000001.mrcs</code>.</p> <p>If you're working on many different objects in your data and want to extract particles  at the same pixel size you risk overwriting previous particle sets. By specifying <code>--output_processing</code>, we redirect the output to a new directory which we will call <code>relion_15854</code> here.</p> <pre><code>WarpTools ts_export_particles \\\n--settings warp_tiltseries.settings \\\n--input_directory warp_tiltseries/matching \\\n--input_pattern \"*15854_clean.star\" \\\n--output_processing relion_15854 \\\n--output_angpix 4 \\\n--output_star relion_15854/matching_4apx.star \\\n--relative_output_paths \\\n--normalized_coords \\\n--box 96 \\\n--diameter 130 \\\n--2d \n</code></pre> <p>This produces a new directory <code>relion_15854</code> the following structure</p> <pre><code>relion_15854\n\u251c\u2500\u2500 logs\n\u251c\u2500\u2500 particleseries\n\u2502   \u251c\u2500\u2500 TS_1\n\u2502   \u251c\u2500\u2500 TS_11\n\u2502   \u251c\u2500\u2500 TS_17\n\u2502   \u251c\u2500\u2500 TS_23\n\u2502   \u2514\u2500\u2500 TS_32\n\u251c\u2500\u2500 dummy_tiltseries.mrc\n\u251c\u2500\u2500 matching_4apx_optimisation_set.star\n\u251c\u2500\u2500 matching_4apx.star\n\u2514\u2500\u2500 matching_4apx_tomograms.star\n</code></pre>"},{"location":"reference/warptools/advanced_data_flow/#running-different-tilt-series-alignment-programs","title":"Running different tilt-series alignment programs","text":"<p>We can use the <code>--output_processing</code> option as we did in the particle export example to test different tilt series alignment methods.  We will need to add <code>--input_processing</code> to our <code>ts_reconstruct</code> call  if we want to reconstruct using these alignments.</p> <p>Let's run both Etomo's patch tracking and AreTomo on some data</p> <pre><code>WarpTools ts_etomo_patches \\\n--settings warp_tiltseries.settings \\\n--angpix 10 \\\n--patch_size 1000 \\\n--do_axis_search \\\n--output_processing etomo_patches_1000\n</code></pre> <pre><code>WarpTools ts_aretomo \\\n--settings warp_tiltseries.settings \\\n--angpix 10 \\\n--alignz 800 \\\n--axis_iter 5 \\\n--min_fov 0 \\\n--output_processing aretomo_alignz_800\n</code></pre> <p>To reconstruct each of these datasets, we will need to specify the <code>--output_processing</code> directory as the <code>--input_processing</code> directory for <code>ts_reconstruct</code>.</p> <pre><code>WarpTools ts_reconstruct \\\n--settings warp_tiltseries.settings \\\n--input_processing aretomo_alignz_800 \\\n--angpix 10 \n</code></pre> <p>Tip</p> <p>If <code>--output_processing</code> is not specified then output will be written  into the same directory. Output can be further redirected by specifying <code>--output_processing</code>.</p>"},{"location":"reference/warptools/advanced_data_flow/#some-caveats","title":"Some caveats","text":"<p>This mechanism is imperfect, if you try to run a process which depends on earlier results you might run into trouble. We're working on this \ud83d\ude42</p>"},{"location":"reference/warptools/custom_tilt_series_alignments/","title":"Custom Tilt Series Alignment Workflows","text":"<p>WarpTools provides wrappers around some commonly used programs for tilt series alignment IMOD and AreTomo2.</p> <ul> <li><code>ts_aretomo</code></li> <li><code>ts_etomo_fiducials</code></li> <li><code>ts_etomo_patches</code></li> </ul> <p>These wrappers provide fully automated solutions and are well integrated into the WarpTools processing flow.</p> <p>What if you want to do something different?</p>"},{"location":"reference/warptools/custom_tilt_series_alignments/#tilt-series-alignment-in-warptools","title":"Tilt Series Alignment in WarpTools","text":"<p>Tilt series alignment in WarpTools can be broken down into three steps</p> <ol> <li>generating tilt series stacks</li> <li>running a tilt series alignment program</li> <li>importing alignments</li> </ol>"},{"location":"reference/warptools/custom_tilt_series_alignments/#easy-as-1-2-3","title":"Easy as 1, 2, 3...","text":"<p>WarpTools provides everything you need to do each of these steps separately yourself if you want to work outside the wrappers.</p>"},{"location":"reference/warptools/custom_tilt_series_alignments/#generate-tilt-series-stacks","title":"Generate tilt series stacks","text":"<p>WarpTools has a subcommand called <code>ts_stack</code> which can be used to generate tilt series at a specific pixel size. Masked regions from per-tilt mask files in <code>&lt;processing_directory&gt;/mask</code> will be replaced with gaussian noise matching local image statistics which may help subsequent alignments.</p> <pre><code>WarpTools ts_stack \\\n--settings &lt;settings_file&gt; \\\n--angpix 10\n</code></pre> <p>Tilt series in <code>.mrc</code> format and tilt angles in the IMOD format <code>.rawtlt</code> file will be placed in subdirectories of <code>&lt;processing_directory&gt;/tiltstack</code>.</p>"},{"location":"reference/warptools/custom_tilt_series_alignments/#run-a-tilt-series-alignment-program","title":"Run a tilt series alignment program","text":"<p>Any tilt series alignment program can be run inside these tilt series directories.</p>"},{"location":"reference/warptools/custom_tilt_series_alignments/#import-alignments","title":"Import alignments","text":"<p>WarpTools can import alignment metadata from the IMOD format metadata files</p> <ul> <li><code>.xf</code> text files containing 2D image transformations</li> <li><code>.tlt</code> text files containing tilt angles</li> </ul> <p>The IMOD <code>xf</code> format is specified in their documentation.</p> <p>IMOD <code>xf</code> spec</p> <p>Each linear transformation in a transform file is specified by a line with six numbers: A11 A12 A21 A22 DX DY where the coordinate (X, Y) is transformed to (X', Y') by: X' = A11 * X + A12 * Y + DX Y' = A21 * X + A22 * Y + DY</p> <p>This is done with the program <code>ts_import_alignments</code>.</p>"},{"location":"reference/warptools/environment_variables/","title":"Useful environment variables","text":"<p>Some advanced features in WarpTools are hidden behind environment variables. </p>"},{"location":"reference/warptools/environment_variables/#enable-debugging-output","title":"Enable Debugging Output","text":"<pre><code>export WARP_DEBUG=1\n</code></pre>"},{"location":"reference/warptools/environment_variables/#force-writing-32-bit-mrcs","title":"Force writing 32 bit MRCs","text":"<pre><code>export WARP_FORCE_MRC_FLOAT32=1\n</code></pre>"},{"location":"reference/warptools/processing_tilt_series_stacks/","title":"Processing Tilt Series Stacks","text":"<p><code>WarpTools</code> expects multi-frame micrographs (movies) as input when processing tilt series data. Sometimes only tilt series stacks are available. This page will show you how to prepare tilt series stacks for processing in <code>WarpTools</code>.</p> <p>We will use a SARS-CoV-2 tilt series from EMPIAR-10453 to demonstrate. The script may need to be modified for other datasets.</p>"},{"location":"reference/warptools/processing_tilt_series_stacks/#splitting-tilt-series-stacks","title":"Splitting Tilt Series Stacks","text":"<p>We will use a simple script to split our tilt series into individual tilt images.</p>"},{"location":"reference/warptools/processing_tilt_series_stacks/#preparation","title":"Preparation","text":"<p>This Python scripts depends on the Python packages mrcfile, tifffile and mdocfile. These can be installed from PyPI in your warp conda environment.</p> <pre><code>pip install mrcfile tifffile mdocfile\n</code></pre>"},{"location":"reference/warptools/processing_tilt_series_stacks/#running-the-script","title":"Running the script","text":"<p>Below is the starting directory structure and the contents of the Python script.</p> directory structure (single tilt series)<pre><code>.\n\u251c\u2500\u2500 mdoc\n\u2502   \u2514\u2500\u2500 TS_005.mrc.mdoc\n\u251c\u2500\u2500 tiltseries\n\u2502   \u2514\u2500\u2500 TS_005.mrc\n\u2514\u2500\u2500 warp_ts_split_10453.py\n</code></pre> warp_ts_split_10453.py<pre><code>from pathlib import Path\nimport mrcfile\nimport mdocfile\n\n# modify these variables for your own processing\nOUTPUT_DIRECTORY = 'movies'\nTILT_SERIES_DIRECTORY = 'tiltseries'\nMDOC_DIRECTORY = 'mdoc'\n\n\n# define a function for processing a single tilt series\ndef process_tilt_series(mdoc_file: Path, output_directory: Path):\n    # load mdoc into pandas dataframe\n    df = mdocfile.read(mdoc_file)\n\n    # load tilt series into numpy array\n    tilt_series_file = Path(TILT_SERIES_DIRECTORY) / mdoc_file.stem\n    tilt_series = mrcfile.read(tilt_series_file)\n\n    # check for same number of tilts in mdoc and image file\n    if len(df) != len(tilt_series):\n        e = f'more tilts in mdoc than tilt series for {mdoc_file}'\n        raise RuntimeError(e)\n\n    # split tilt series into individual tilts\n    for movie_path, image in zip(df['SubFramePath'], tilt_series):\n        output_movie_file = output_directory / Path(movie_path.name)\n        if output_movie_file.suffix.lower() == '.mrc':\n            mrcfile.write(output_movie_file, image)\n        elif output_movie_file.suffix in ('.tif', '.tiff'):\n            tifffile.imwrite(output_movie_file, image)\n\n# main program which loops over all tilt series...\nif __name__ == '__main__':\n    # create output directory\n    Path(OUTPUT_DIRECTORY).mkdir(exist_ok=True, parents=True)\n\n    # get list of mdoc files to process\n    mdocs = list(Path(MDOC_DIRECTORY).glob('*.mdoc'))\n\n    # process mdoc files one by one\n    for mdoc in mdocs:\n        process_tilt_series(mdoc_file=mdoc, output_directory=Path(OUTPUT_DIRECTORY))\n</code></pre> <pre><code>python warp_ts_split_10453.py\n</code></pre>"},{"location":"reference/warptools/processing_tilt_series_stacks/#output","title":"Output","text":"output directory structure<pre><code>.\n\u251c\u2500\u2500 mdoc\n\u2502   \u2514\u2500\u2500 TS_005.mrc.mdoc\n\u251c\u2500\u2500 movies\n\u2502   \u251c\u2500\u2500 TS_005_001_-0.0.tif\n\u2502   \u251c\u2500\u2500 TS_005_002_3.0.tif\n\u2502   \u251c\u2500\u2500 TS_005_003_6.0.tif\n\u2502   \u251c\u2500\u2500 TS_005_004_-3.0.tif\n\u2502   \u251c\u2500\u2500 TS_005_005_-6.0.tif\n\u2502   \u251c\u2500\u2500 TS_005_006_9.0.tif\n\u2502   \u251c\u2500\u2500 TS_005_007_12.0.tif\n\u2502   \u251c\u2500\u2500 TS_005_008_-9.0.tif\n\u2502   \u251c\u2500\u2500 TS_005_009_-12.0.tif\n\u2502   \u251c\u2500\u2500 TS_005_010_15.0.tif\n\u2502   \u251c\u2500\u2500 TS_005_011_18.0.tif\n\u2502   \u251c\u2500\u2500 TS_005_012_-15.0.tif\n\u2502   \u251c\u2500\u2500 TS_005_013_-18.0.tif\n\u2502   \u251c\u2500\u2500 TS_005_014_21.0.tif\n\u2502   \u251c\u2500\u2500 TS_005_015_24.0.tif\n\u2502   \u251c\u2500\u2500 TS_005_016_-21.0.tif\n\u2502   \u251c\u2500\u2500 TS_005_017_-24.0.tif\n\u2502   \u251c\u2500\u2500 TS_005_018_27.0.tif\n\u2502   \u251c\u2500\u2500 TS_005_019_30.0.tif\n\u2502   \u251c\u2500\u2500 TS_005_020_-27.0.tif\n\u2502   \u251c\u2500\u2500 TS_005_021_-30.0.tif\n\u2502   \u251c\u2500\u2500 TS_005_022_33.0.tif\n\u2502   \u251c\u2500\u2500 TS_005_023_36.0.tif\n\u2502   \u251c\u2500\u2500 TS_005_024_-33.0.tif\n\u2502   \u251c\u2500\u2500 TS_005_025_-36.0.tif\n\u2502   \u251c\u2500\u2500 TS_005_026_39.0.tif\n\u2502   \u251c\u2500\u2500 TS_005_027_42.0.tif\n\u2502   \u251c\u2500\u2500 TS_005_028_-39.0.tif\n\u2502   \u251c\u2500\u2500 TS_005_029_-42.0.tif\n\u2502   \u251c\u2500\u2500 TS_005_030_45.0.tif\n\u2502   \u251c\u2500\u2500 TS_005_031_48.0.tif\n\u2502   \u251c\u2500\u2500 TS_005_032_-45.0.tif\n\u2502   \u251c\u2500\u2500 TS_005_033_-48.0.tif\n\u2502   \u251c\u2500\u2500 TS_005_034_51.0.tif\n\u2502   \u251c\u2500\u2500 TS_005_035_54.0.tif\n\u2502   \u251c\u2500\u2500 TS_005_036_-51.0.tif\n\u2502   \u251c\u2500\u2500 TS_005_037_-54.0.tif\n\u2502   \u251c\u2500\u2500 TS_005_038_57.0.tif\n\u2502   \u251c\u2500\u2500 TS_005_039_60.0.tif\n\u2502   \u251c\u2500\u2500 TS_005_040_-57.0.tif\n\u2502   \u2514\u2500\u2500 TS_005_041_-60.0.tif\n\u251c\u2500\u2500 tiltseries\n\u2502   \u2514\u2500\u2500 TS_005.mrc\n\u2514\u2500\u2500 warp_ts_split_10453.py\n</code></pre> <p>what if I don't have mdoc files?</p> <p>You'll have to make them yourself! The mdocfile Python package might be useful.</p>"},{"location":"reference/warptools/processing_tilt_series_stacks/#subsequent-processing","title":"Subsequent Processing","text":"<p>You should now be able to follow the quick start guide for tilt series processing.</p>"},{"location":"reference/warptools/processing_tilt_series_stacks/#differences","title":"Differences","text":"<ul> <li>use <code>fs_ctf</code> not <code>fs_motion_and_ctf</code> - you don't need to correct motion!</li> <li>copy and paste or symlink motion corrected averages into an <code>averages</code> directory inside your frame series processing directory</li> <li>you won't be able to refine motion correction results in M</li> </ul>"},{"location":"reference/warptools/processing_warp_v1_data/","title":"Moving Tilt Series Processing to v2.X","text":"<p>Some people want to continue projects from Warp 1.X in Warp 2.0 to enable processing their  data in HPC environments using WarpTools. </p> <p>Rasmus Jensen wrote this useful guide to doing just that, thanks Rasmus!</p>"},{"location":"reference/warptools/processing_warp_v1_data/#steps","title":"Steps","text":"<ul> <li>set up WarpTools settings files (c.f. Quick Start: Tilt Series)</li> <li>symlink motion corrected averages into <code>&lt;frame_series_processing_dir&gt;/average</code></li> <li>run frame series CTF estimation (<code>WarpTools fs_ctf</code>)</li> <li>copy masks from Warp1.0.X BoxNet (if relevant)</li> <li>import previous .xf files (<code>WarpTools ts_import_alignments</code>)</li> <li>run tilt series CTF estimation (<code>WarpTools ts_ctf</code>)</li> <li>reconstruct tomograms (<code>WarpTools ts_reconstruct</code>)</li> </ul>"},{"location":"reference/warptools/processing_warp_v1_data/#notes","title":"Notes","text":"<ul> <li>it is important to ensure you have the same handedness and tomogram dimensions after tomogram reconstruction</li> <li>you can export particles using <code>WarpTools ts_export_particles</code> after this and get nearly identical maps without re-refining angles</li> </ul>"},{"location":"reference/warptools/subsets/","title":"Working with subsets of data in WarpTools","text":"<p>This page explains the mechanisms available for working with subsets of data in WarpTools.</p> <p>Each program in WarpTools operates over potentially large sets of frame series or tilt series data. Sometimes, we want to work with subsets.</p>"},{"location":"reference/warptools/subsets/#using-input_data","title":"Using <code>--input_data</code>","text":"<p>Adding <code>--input_data</code> when calling any WarpTool allows you to run it on one or multiple frame series, overriding the list of input files specified in a <code>.settings</code> file.</p> <p>Input data can be provided as</p> <ul> <li>a space-separated list of files</li> <li>a wildcard pattern</li> <li>a <code>.txt</code> file with one file name per line</li> </ul>"},{"location":"reference/warptools/subsets/#examples","title":"Examples","text":""},{"location":"reference/warptools/subsets/#one-frame-series","title":"One Frame Series","text":"<p><code>--input_data frames/file.tif</code></p>"},{"location":"reference/warptools/subsets/#multiple-frame-series","title":"Multiple Frame Series","text":"<p><code>--input_data frames/file1.tif frames/file2.tif</code></p>"},{"location":"reference/warptools/subsets/#one-tilt-series","title":"One Tilt Series","text":"<p><code>--input_data tomostar/TS_1.tomostar</code></p>"},{"location":"reference/warptools/subsets/#multiple-tilt-series","title":"Multiple Tilt Series","text":"<p><code>--input_data tomostar/TS_1.tomostar tomostar/TS_2.tomostar</code></p>"},{"location":"reference/warptools/subsets/#exclusion-from-further-processing-with-warptools-change_selection","title":"Exclusion from Further Processing with <code>WarpTools change_selection</code>","text":"<p>It is possible to exclude frame series or tilt series from further processing using the <code>change_selection</code> WarpTool to deselect them.</p>"},{"location":"reference/warptools/subsets/#deselecting-a-frame-series","title":"Deselecting a frame series","text":"<pre><code>WarpTools change_selection \\\n--settings warp_frameseries.settings \\\n--deselect \\\n--input_data frames/2Dvs3D_53-1_00001_-0.0_Jul31_10.36.03.tif\n</code></pre> <pre><code>Running command change_selection with:\nselect = False\ndeselect = True\nnull = False\ninvert = False\nsettings = warp_frameseries.settings\ninput_data = { frames/2Dvs3D_53-1_00001_-0.0_Jul31_10.36.03.tif }\ninput_data_recursive = False\ninput_processing = null\noutput_processing = null\n\nUsing alternative input specified by --input_data\nFile search will be relative to /projects/site/gred/cryoem/burta2/cryo_tomo_test_data/EMPIAR-10491-5TS\n1 files found\nParsing previous results for each item, if available...\n1/1, previous metadata found for 1                                                                                                                                          \n1/1 processed                                                                                                                                                               \nBefore change: 0 deselected, 0 selected, 1 null\nAfter change: 1 deselected, 0 selected, 0 null\n</code></pre>"},{"location":"reference/warptools/subsets/#deselecting-a-tilt-series","title":"Deselecting a tilt series","text":"<pre><code>WarpTools change_selection \\\n--settings warp_tiltseries.settings \\\n--deselect \\\n--input_data tomostar/TS_1.tomostar\n</code></pre> <pre><code>Running command change_selection with:\nselect = False\ndeselect = True\nnull = False\ninvert = False\nsettings = warp_tiltseries.settings\ninput_data = { tomostar/TS_1.tomostar }\ninput_data_recursive = False\ninput_processing = null\noutput_processing = null\n\nUsing alternative input specified by --input_data\nFile search will be relative to /projects/site/gred/cryoem/burta2/cryo_tomo_test_data/EMPIAR-10491-5TS\n1 files found\nParsing previous results for each item, if available...\n1/1, previous metadata found for 1                                                                                                                                          \n1/1 processed                                                                                                                                                               \nBefore change: 0 deselected, 1 selected, 0 null\nAfter change: 1 deselected, 0 selected, 0 null\n</code></pre>"},{"location":"reference/warptools/subsets/#under-the-hood","title":"Under the hood","text":"<p>Under the hood, this selection mechanism modifies the <code>UnselectManual</code> entry in the <code>.xml</code> file associated with each frame series or tilt series.</p> <p>Below is an example of the first two lines of a deselected tilt series xml file.</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;TiltSeries DataDirectory=\"/projects/EMPIAR-10491-5TS/tomostar\" AreAnglesInverted=\"True\"\n            PlaneNormal=\"-0.13401411, 0.0035971305, 0.9909729\" Bfactor=\"-7.300099\"\n            Weight=\"1\" MagnificationCorrection=\"1, 0, 0, 1\" UnselectFilter=\"False\"\n            UnselectManual=\"True\" CTFResolutionEstimate=\"4.3\"&gt;\n</code></pre>"},{"location":"reference/warptools/tomogram_denoising/","title":"Denoising Tomograms in WarpTools","text":"<p>WarpTools comes with everything you need to denoise tomograms using the  Noise2Noise denoising scheme.</p>"},{"location":"reference/warptools/tomogram_denoising/#outline","title":"Outline","text":"<p>Tomogram denoising is performed in two steps 1. generate tomograms from half sets of data 2. train and apply a denoiser using Noise2Map</p> <p>Noise2Noise denoising requires two independent noisy observations of a target signal. In cryo-EM we can generate independent noisy copies of the same image by averaging the  even and odd frames in a frame series.</p> <p>We perform reconstructions from these even and odd images to  produce independently noisy tomograms for denoising.</p>"},{"location":"reference/warptools/tomogram_denoising/#generating-tomograms-from-half-sets-of-data","title":"Generating tomograms from half sets of data","text":""},{"location":"reference/warptools/tomogram_denoising/#generating-even-and-odd-frame-series-averages","title":"Generating even and odd frame series averages","text":"<p>We can generate even and odd movie averages by adding the <code>--out_average_halves</code> flag  when running <code>WarpTools fs_motion_and_ctf</code>. If you didn't  do this don't worry, you can run  <code>WarpTools fs_export_micrographs</code>  with the <code>--average_halves</code> flag.</p> <p>This will produce <code>even</code> and <code>odd</code> subfolders filled with images in the <code>average</code> folder of your frame series processing directory.</p>"},{"location":"reference/warptools/tomogram_denoising/#generating-even-and-odd-tomograms","title":"Generating even and odd tomograms","text":"<p>Now that we have even and odd images, producing even and odd tomograms is as simple as  running <code>WarpTools ts_reconstruct</code> with the  <code>--halfmap_frames</code> flag.</p> <p>What if I don't have frame series?</p> <p>Don't worry! You can generate tomograms from even and odd tilts instead.  Just add <code>--halfmap_tilts</code> to your <code>ts_reconstruct</code> command.</p> <p>This will generate <code>even</code> and <code>odd</code> subfolders filled with images in the <code>reconstruction</code>  folder of your tilt series processing directory.</p>"},{"location":"reference/warptools/tomogram_denoising/#training-and-applying-the-denoiser","title":"Training and applying the denoiser","text":"<p>Now we can use Noise2Map to train a denoiser and apply it to our tomograms.  We typically need to train for &gt;10,000 iterations to get good results.</p> <p>An example Noise2Map command for tomogram denoising is provided below.</p> <pre><code>Noise2Map\n--observation1 warp_tiltseries/reconstruction/even \\\n--observation2 warp_tiltseries/reconstruction/odd \\\n--observation_combined warp_tiltseries/reconstruction \\\n--dont_flatten_spectrum \\\n--dont_augment\n</code></pre>"},{"location":"reference/warptools/tomogram_particle_files/","title":"Tomogram Particle File Reference","text":"<p>WarpTools uses RELION's particle STAR metadata format. This format has changed over time, making users unsure exactly what needs to be in files  they provide for particle extraction when using external picking tools.</p> <p>This page provides examples of metadata that can be used as input to  <code>WarpTools ts_export_particles</code>.</p> <ul> <li>the list is currently non-exhaustive</li> <li>you can use https://teamtomo.org/starfile/ to read/write these files in Python</li> </ul>"},{"location":"reference/warptools/tomogram_particle_files/#relion-30-single-star-file","title":"RELION 3.0 - single STAR file","text":"<pre><code>data_\n\nloop_\n_rlnCoordinateX #1\n_rlnCoordinateY #2\n_rlnCoordinateZ #3\n_rlnAngleRot #4\n_rlnAngleTilt #5\n_rlnAnglePsi #6\n_rlnMicrographName #7\n443.701994  214.586768  203.739618  54.077932   -29.726951  92.706063   TS_01.tomostar\n216.467133  171.667023  157.704667  -168.434232 40.321521   156.800994  TS_01.tomostar\n348.701000  91.300066   102.117338  118.892984  -1.043545   127.385870  TS_01.tomostar\n465.590176  324.308040  70.420590   105.319824  -37.039451  34.633991   TS_01.tomostar\n258.605650  172.224427  97.064928   -74.303821  -3.118226   150.759924  TS_01.tomostar\n374.679231  423.019164  205.292795  -130.204570 27.222522   29.593324   TS_02.tomostar\n221.453592  425.672254  45.511323   41.711155   48.543276   -82.870213  TS_02.tomostar\n348.248079  60.036645   137.823081  123.710065  -86.671079  -34.849912  TS_02.tomostar\n229.928165  480.004330  113.754747  -100.103965 165.027964  -76.947619  TS_02.tomostar\n385.706010  30.954625   200.434299  26.881529   41.836412   -108.699923 TS_02.tomostar\n</code></pre> <ul> <li>coordinates (required) are interpreted as pixel coordinates in a tomogram, starting from zero at the center of the first voxel</li> <li>rlnMicrographName (optional) should match the tomostar file name for your Warp tilt series processing</li> <li>euler angles (optional) are interpreted as RELION format (ZYZ intrinsic) rotations</li> </ul>"},{"location":"reference/warptools/api/frame_series/","title":"Frame Series","text":""},{"location":"reference/warptools/api/frame_series/#fs_motion_and_ctf","title":"fs_motion_and_ctf","text":"<pre><code>WarpTools - a collection of tools for EM data pre-processing\nVersion 2.0.0\n\nShowing all available options for command fs_motion_and_ctf:\n\n------------------------------Data import settings------------------------------\n\n--settings                REQUIRED Path to Warp's .settings file, typically loca\n                          ted in the processing folder. Default file name is 'pr\n                          evious.settings'.\n\n\n--------------------------------------------------------------------------------\n\n--m_range_min             Default: 500. Minimum resolution in Angstrom to consid\n                          er in fit\n\n--m_range_max             Default: 10. Maximum resolution in Angstrom to conside\n                          r in fit\n\n--m_bfac                  Default: -500. Downweight higher spatial frequencies u\n                          sing a B-factor, in Angstrom^2\n\n--m_grid                  Resolution of the motion model grid in X, Y, and tempo\n                          ral dimensions, separated by 'x': e.g. 5x5x40; empty =\n                           auto\n\n--c_window                Default: 512. Patch size for CTF estimation in binned \n                          pixels\n\n--c_range_min             Default: 30. Minimum resolution in Angstrom to conside\n                          r in fit\n\n--c_range_max             Default: 4. Maximum resolution in Angstrom to consider\n                           in fit\n\n--c_defocus_min           Default: 0.5. Minimum defocus value in um to explore d\n                          uring fitting\n\n--c_defocus_max           Default: 5. Maximum defocus value in um to explore dur\n                          ing fitting\n\n--c_voltage               Default: 300. Acceleration voltage of the microscope i\n                          n kV\n\n--c_cs                    Default: 2.7. Spherical aberration of the microscope i\n                          n mm\n\n--c_amplitude             Default: 0.07. Amplitude contrast of the sample, usual\n                          ly 0.07-0.10 for cryo\n\n--c_fit_phase             Fit the phase shift of a phase plate\n\n--c_use_sum               Use the movie average spectrum instead of the average \n                          of individual frames' spectra. Can help in the absence\n                           of an energy filter, or when signal is low.\n\n--c_grid                  Resolution of the defocus model grid in X, Y, and temp\n                          oral dimensions, separated by 'x': e.g. 5x5x40; empty \n                          = auto; Z &gt; 1 is purely experimental\n\n--out_averages            Export aligned averages\n\n--out_average_halves      Export aligned averages of odd and even frames separat\n                          ely, e.g. for denoiser training\n\n--out_skip_first          Default: 0. Skip first N frames when exporting average\n                          s\n\n--out_skip_last           Default: 0. Skip last N frames when exporting averages\n\n\n-------------------------------Work distribution--------------------------------\n\n--device_list             Space-separated list of GPU IDs to use for processing.\n                           Default: all GPUs in the system\n\n--perdevice               Default: 1. Number of processes per GPU\n\n\n----------------------Advanced data import &amp; flow options-----------------------\n\n--input_data              Overrides the list of input files specified in the .se\n                          ttings file. Accepts a space-separated list of files, \n                          wildcard patterns, or .txt files with one file name pe\n                          r line.\n\n--input_data_recursive    Enables recursive search for files matching the wildca\n                          rd pattern specified in --input_data. Only applicable \n                          when processing and directories are separate. All file\n                           names must be unique.\n\n--input_processing        Specifies an alternative directory containing pre-proc\n                          essed results. Overrides the processing directory in t\n                          he .settings file.\n\n--output_processing       Specifies an alternative directory to save processing \n                          results. Overrides the processing directory in the .se\n                          ttings file.\n\n--input_norawdata         Ignore the existence of raw data and look for XML meta\n                          data in the processing directory instead.\n\n\n-----------------------Advanced remote work distribution------------------------\n\n--workers                 List of remote workers to be used instead of locally s\n                          pawned processes. Formatted as hostname:port, separate\n                          d by spaces\n</code></pre>"},{"location":"reference/warptools/api/frame_series/#fs_motion","title":"fs_motion","text":"<pre><code>WarpTools - a collection of tools for EM data pre-processing\nVersion 2.0.0\n\nShowing all available options for command fs_motion:\n\n------------------------------Data import settings------------------------------\n\n--settings                REQUIRED Path to Warp's .settings file, typically loca\n                          ted in the processing folder. Default file name is 'pr\n                          evious.settings'.\n\n\n--------------------------------------------------------------------------------\n\n--range_min               Default: 500. Minimum resolution in Angstrom to consid\n                          er in fit\n\n--range_max               Default: 10. Maximum resolution in Angstrom to conside\n                          r in fit\n\n--bfac                    Default: -500. Downweight higher spatial frequencies u\n                          sing a B-factor, in Angstrom^2\n\n--grid                    Resolution of the motion model grid in X, Y, and tempo\n                          ral dimensions, separated by 'x': e.g. 5x5x40; empty =\n                           auto\n\n--averages                Export aligned averages\n\n--average_halves          Export aligned averages of odd and even frames separat\n                          ely, e.g. for denoiser training\n\n--skip_first              Default: 0. Skip first N frames when exporting average\n                          s\n\n--skip_last               Default: 0. Skip last N frames when exporting averages\n\n\n-------------------------------Work distribution--------------------------------\n\n--device_list             Space-separated list of GPU IDs to use for processing.\n                           Default: all GPUs in the system\n\n--perdevice               Default: 1. Number of processes per GPU\n\n\n----------------------Advanced data import &amp; flow options-----------------------\n\n--input_data              Overrides the list of input files specified in the .se\n                          ttings file. Accepts a space-separated list of files, \n                          wildcard patterns, or .txt files with one file name pe\n                          r line.\n\n--input_data_recursive    Enables recursive search for files matching the wildca\n                          rd pattern specified in --input_data. Only applicable \n                          when processing and directories are separate. All file\n                           names must be unique.\n\n--input_processing        Specifies an alternative directory containing pre-proc\n                          essed results. Overrides the processing directory in t\n                          he .settings file.\n\n--output_processing       Specifies an alternative directory to save processing \n                          results. Overrides the processing directory in the .se\n                          ttings file.\n\n--input_norawdata         Ignore the existence of raw data and look for XML meta\n                          data in the processing directory instead.\n\n\n-----------------------Advanced remote work distribution------------------------\n\n--workers                 List of remote workers to be used instead of locally s\n                          pawned processes. Formatted as hostname:port, separate\n                          d by spaces\n</code></pre>"},{"location":"reference/warptools/api/frame_series/#fs_ctf","title":"fs_ctf","text":"<pre><code>WarpTools - a collection of tools for EM data pre-processing\nVersion 2.0.0\n\nShowing all available options for command fs_ctf:\n\n------------------------------Data import settings------------------------------\n\n--settings                REQUIRED Path to Warp's .settings file, typically loca\n                          ted in the processing folder. Default file name is 'pr\n                          evious.settings'.\n\n\n--------------------------------------------------------------------------------\n\n--window                  Default: 512. Patch size for CTF estimation in binned \n                          pixels\n\n--range_min               Default: 30. Minimum resolution in Angstrom to conside\n                          r in fit\n\n--range_max               Default: 4. Maximum resolution in Angstrom to consider\n                           in fit\n\n--defocus_min             Default: 0.5. Minimum defocus value in um to explore d\n                          uring fitting\n\n--defocus_max             Default: 5. Maximum defocus value in um to explore dur\n                          ing fitting\n\n--voltage                 Default: 300. Acceleration voltage of the microscope i\n                          n kV\n\n--cs                      Default: 2.7. Spherical aberration of the microscope i\n                          n mm\n\n--amplitude               Default: 0.07. Amplitude contrast of the sample, usual\n                          ly 0.07-0.10 for cryo\n\n--fit_phase               Fit the phase shift of a phase plate\n\n--use_sum                 Use the movie average spectrum instead of the average \n                          of individual frames' spectra. Can help in the absence\n                           of an energy filter, or when signal is low.\n\n--grid                    Resolution of the defocus model grid in X, Y, and temp\n                          oral dimensions, separated by 'x': e.g. 5x5x40; empty \n                          = auto; Z &gt; 1 is purely experimental\n\n\n-------------------------------Work distribution--------------------------------\n\n--device_list             Space-separated list of GPU IDs to use for processing.\n                           Default: all GPUs in the system\n\n--perdevice               Default: 1. Number of processes per GPU\n\n\n----------------------Advanced data import &amp; flow options-----------------------\n\n--input_data              Overrides the list of input files specified in the .se\n                          ttings file. Accepts a space-separated list of files, \n                          wildcard patterns, or .txt files with one file name pe\n                          r line.\n\n--input_data_recursive    Enables recursive search for files matching the wildca\n                          rd pattern specified in --input_data. Only applicable \n                          when processing and directories are separate. All file\n                           names must be unique.\n\n--input_processing        Specifies an alternative directory containing pre-proc\n                          essed results. Overrides the processing directory in t\n                          he .settings file.\n\n--output_processing       Specifies an alternative directory to save processing \n                          results. Overrides the processing directory in the .se\n                          ttings file.\n\n--input_norawdata         Ignore the existence of raw data and look for XML meta\n                          data in the processing directory instead.\n\n\n-----------------------Advanced remote work distribution------------------------\n\n--workers                 List of remote workers to be used instead of locally s\n                          pawned processes. Formatted as hostname:port, separate\n                          d by spaces\n</code></pre>"},{"location":"reference/warptools/api/frame_series/#fs_boxnet_infer","title":"fs_boxnet_infer","text":"<pre><code>WarpTools - a collection of tools for EM data pre-processing\nVersion 2.0.0\n\nShowing all available options for command fs_boxnet_infer:\n\n------------------------------Data import settings------------------------------\n\n--settings                REQUIRED Path to Warp's .settings file, typically loca\n                          ted in the processing folder. Default file name is 'pr\n                          evious.settings'.\n\n\n--------------------------------------------------------------------------------\n\n--model                   REQUIRED Path to the .pt file containing the model wei\n                          ghts\n\n--perprocess              Default: 4. Number of threads per process; the model i\n                          s loaded only once per process and oversubscription ca\n                          n save memory\n\n--diameter                Default: 100. Approximate particle diameter in Angstro\n                          m\n\n--threshold               Default: 0.5. Picking score threshold, between 0.0 and\n                           1.0\n\n--distance                Default: 0. Minimum distance in Angstrom to maintain b\n                          etween picked positions and masked pixels\n\n--negative                Expect negative stain-like contrast (mass = bright)\n\n--suffix_star             Override the suffix added to the particle STAR file; l\n                          eave empty to use model name\n\n--patchsize               Default: 512. Size of the BoxNet input window that the\n                           model was trained with, a multiple of 256; the defaul\n                          t for models shipped with Warp is 512\n\n\n-------------------------------Work distribution--------------------------------\n\n--device_list             Space-separated list of GPU IDs to use for processing.\n                           Default: all GPUs in the system\n\n--perdevice               Default: 1. Number of processes per GPU\n\n\n----------------------Advanced data import &amp; flow options-----------------------\n\n--input_data              Overrides the list of input files specified in the .se\n                          ttings file. Accepts a space-separated list of files, \n                          wildcard patterns, or .txt files with one file name pe\n                          r line.\n\n--input_data_recursive    Enables recursive search for files matching the wildca\n                          rd pattern specified in --input_data. Only applicable \n                          when processing and directories are separate. All file\n                           names must be unique.\n\n--input_processing        Specifies an alternative directory containing pre-proc\n                          essed results. Overrides the processing directory in t\n                          he .settings file.\n\n--output_processing       Specifies an alternative directory to save processing \n                          results. Overrides the processing directory in the .se\n                          ttings file.\n\n--input_norawdata         Ignore the existence of raw data and look for XML meta\n                          data in the processing directory instead.\n\n\n-----------------------Advanced remote work distribution------------------------\n\n--workers                 List of remote workers to be used instead of locally s\n                          pawned processes. Formatted as hostname:port, separate\n                          d by spaces\n</code></pre>"},{"location":"reference/warptools/api/frame_series/#fs_boxnet_train","title":"fs_boxnet_train","text":"<pre><code>WarpTools - a collection of tools for EM data pre-processing\nVersion 2.0.0\n\nShowing all available options for command fs_boxnet_train:\n\n--------------------------------------------------------------------------------\n\n--model_in            Path to the .pt file containing the old model weights; mod\n                      el will be initialized from scratch if this is left empty\n\n--model_out           REQUIRED Path to the .pt file where the new model weights \n                      will be saved\n\n--examples            REQUIRED Path to a folder containing TIFF files with examp\n                      les prepared with boxnet_examples_frameseries\n\n--examples_general    Path to a folder containing TIFF files with examples used \n                      to train a more general model, which will be mixed 1:1 wit\n                      h new examples to reduce overfitting\n\n--no_mask             Don't consider mask labels in training; they will be conve\n                      rted to background labels\n\n--patchsize           Default: 512. Size of the BoxNet input window, a multiple \n                      of 256; remember to use the same window with boxnet_infer_\n                      frameseries\n\n--batchsize           Default: 8. Size of the minibatches used in training; larg\n                      er batches require more GPU memory; must be divisible by n\n                      umber of devices\n\n--lr_start            Default: 5E-05. Learning rate at training start\n\n--lr_end              Default: 1E-05. Learning rate at training end, with linear\n                       interpolation in-between\n\n--epochs              Default: 100. Number of training epochs\n\n--checkpoints         Default: 0. Save checkpoints every N minutes; set to 0 to \n                      disable\n\n--devices             Space-separated list of GPU IDs to be used for training\n</code></pre>"},{"location":"reference/warptools/api/frame_series/#fs_export_micrographs","title":"fs_export_micrographs","text":"<pre><code>WarpTools - a collection of tools for EM data pre-processing\nVersion 2.0.0\n\nShowing all available options for command fs_export_micrographs:\n\n------------------------------Data import settings------------------------------\n\n--settings                REQUIRED Path to Warp's .settings file, typically loca\n                          ted in the processing folder. Default file name is 'pr\n                          evious.settings'.\n\n\n--------------------------------------------------------------------------------\n\n--averages                Export aligned averages\n\n--average_halves          Export aligned averages of odd and even frames separat\n                          ely, e.g. for denoiser training\n\n--skip_first              Default: 0. Skip first N frames when exporting average\n                          s\n\n--skip_last               Default: 0. Skip last N frames when exporting averages\n\n\n-------------------------------Work distribution--------------------------------\n\n--device_list             Space-separated list of GPU IDs to use for processing.\n                           Default: all GPUs in the system\n\n--perdevice               Default: 1. Number of processes per GPU\n\n\n----------------------Advanced data import &amp; flow options-----------------------\n\n--input_data              Overrides the list of input files specified in the .se\n                          ttings file. Accepts a space-separated list of files, \n                          wildcard patterns, or .txt files with one file name pe\n                          r line.\n\n--input_data_recursive    Enables recursive search for files matching the wildca\n                          rd pattern specified in --input_data. Only applicable \n                          when processing and directories are separate. All file\n                           names must be unique.\n\n--input_processing        Specifies an alternative directory containing pre-proc\n                          essed results. Overrides the processing directory in t\n                          he .settings file.\n\n--output_processing       Specifies an alternative directory to save processing \n                          results. Overrides the processing directory in the .se\n                          ttings file.\n\n--input_norawdata         Ignore the existence of raw data and look for XML meta\n                          data in the processing directory instead.\n\n\n-----------------------Advanced remote work distribution------------------------\n\n--workers                 List of remote workers to be used instead of locally s\n                          pawned processes. Formatted as hostname:port, separate\n                          d by spaces\n</code></pre>"},{"location":"reference/warptools/api/frame_series/#fs_export_particles","title":"fs_export_particles","text":"<pre><code>WarpTools - a collection of tools for EM data pre-processing\nVersion 2.0.0\n\nShowing all available options for command fs_export_particles:\n\n------------------------------Data import settings------------------------------\n\n--settings                 REQUIRED Path to Warp's .settings file, typically loc\n                           ated in the processing folder. Default file name is '\n                           previous.settings'.\n\n\n----------------------STAR files with particle coordinates----------------------\n\n-i, --input                REQUIRED Path to folder containing the STAR files; or\n                            path to a single STAR file\n\n--patterns                 Space-separated list of file name search patterns or \n                           STAR file names when --star is a folder\n\n\n-------------------------------------Output-------------------------------------\n\n-o, --output               REQUIRED Where to write the STAR file containing info\n                           rmation about the exported particles\n\n--suffix_out               Default: . Suffix to add at the end of each stack's n\n                           ame; the full name will be [movie name][--suffix_out]\n                           .mrcs\n\n--angpix_out               Pixel size the extracted particles will be scaled to;\n                            leave out to use binned pixel size from input settin\n                           gs\n\n--box                      REQUIRED Particle box size in pixels\n\n--diameter                 REQUIRED Particle diameter in Angstrom\n\n--relative_output_paths    Make paths in output STAR file relative to the locati\n                           on of the STAR file. They will be relative to the wor\n                           king directory otherwise.\n\n\n-------------------Export type (REQUIRED, mutually exclusive)-------------------\n\n--averages                 Export particle averages; mutually exclusive with oth\n                           er export types\n\n--halves                   Export particle half-averages e.g. for denoising; mut\n                           ually exclusive with other export types\n\n--only_star                Don't export, only write out STAR table; mutually exc\n                           lusive with other export types\n\n\n-------------------------------Coordinate scaling-------------------------------\n\n--angpix_coords            REQUIRED Pixel size for the input coordinates\n\n--angpix_shifts            Pixel size for refined shifts if not given in Angstro\n                           m (when using rlnOriginX instead of rlnOriginXAngst)\n\n\n---------------------------------Expert options---------------------------------\n\n--dont_invert              Don't invert contrast, e.g. for negative stain data\n\n--dont_normalize           Don't normalize background (RELION will complain!)\n\n--dont_center              Don't re-center particles based on refined shifts\n\n--flip_phases              Pre-flip phases in bigger box to avoid signal loss du\n                           e to delocalization\n\n--keep_ctf                 Keep CTF information from STAR inputs\n\n--skip_first_frames        Default: 0. Skip first N frames\n\n--skip_last_frames         Default: 0. Skip last N frames\n\n\n-------------------------------Work distribution--------------------------------\n\n--device_list              Space-separated list of GPU IDs to use for processing\n                           . Default: all GPUs in the system\n\n--perdevice                Default: 1. Number of processes per GPU\n\n\n----------------------Advanced data import &amp; flow options-----------------------\n\n--input_data               Overrides the list of input files specified in the .s\n                           ettings file. Accepts a space-separated list of files\n                           , wildcard patterns, or .txt files with one file name\n                            per line.\n\n--input_data_recursive     Enables recursive search for files matching the wildc\n                           ard pattern specified in --input_data. Only applicabl\n                           e when processing and directories are separate. All f\n                           ile names must be unique.\n\n--input_processing         Specifies an alternative directory containing pre-pro\n                           cessed results. Overrides the processing directory in\n                            the .settings file.\n\n--output_processing        Specifies an alternative directory to save processing\n                            results. Overrides the processing directory in the .\n                           settings file.\n\n--input_norawdata          Ignore the existence of raw data and look for XML met\n                           adata in the processing directory instead.\n\n\n-----------------------Advanced remote work distribution------------------------\n\n--workers                  List of remote workers to be used instead of locally \n                           spawned processes. Formatted as hostname:port, separa\n                           ted by spaces\n</code></pre>"},{"location":"reference/warptools/api/general/","title":"General","text":""},{"location":"reference/warptools/api/general/#create_settings","title":"create_settings","text":"<pre><code>WarpTools - a collection of tools for EM data pre-processing\nVersion 2.0.0\n\nShowing all available options for command create_settings:\n\n--------------------------------------------------------------------------------\n\n-o, --output           REQUIRED Path to the new settings file\n\n--folder_processing    Processing folder location\n\n--folder_data          REQUIRED Raw data folder location\n\n--recursive            Recursively search for files in sub-folders (only when pr\n                       ocessing and raw data locations are different)\n\n--extension            Import file search term: Use e.g. *.mrc to process all MR\n                       C files, or something more specific like FoilHole1_*.mrc\n\n--angpix               REQUIRED Unbinned pixel size in Angstrom. Alternatively s\n                       pecify the path to an image or MDOC file to read the valu\n                       e from. If a wildcard pattern is specified, the first fil\n                       e will be used\n\n--bin                  2^x pre-binning factor, applied in Fourier space when loa\n                       ding raw data. 0 = no binning, 1 = 2x2 binning, 2 = 4x4 b\n                       inning, supports non-integer values\n\n--bin_angpix           Choose the binning exponent automatically to match this t\n                       arget pixel size in Angstrom\n\n--gain_path            Path to gain file, relative to import folder\n\n--defects_path         Path to defects file, relative to import folder\n\n--gain_flip_x          Flip X axis of the gain image\n\n--gain_flip_y          Flip Y axis of the gain image\n\n--gain_transpose       Transpose gain image (i.e. swap X and Y axes)\n\n--exposure             Default: 1. Overall exposure per Angstrom^2; use negative\n                        value to specify exposure/frame instead\n\n--eer_ngroups          Default: 40. Number of groups to combine raw EER frames i\n                       nto, i.e. number of 'virtual' frames in resulting stack; \n                       use negative value to specify the number of frames per vi\n                       rtual frame instead\n\n--eer_groupexposure    As an alternative to --eer_ngroups, fractionate the frame\n                       s so that a group will have this exposure in e-/A^2; this\n                        overrides --eer_ngroups\n\n--tomo_dimensions      X, Y, and Z dimensions of the full tomogram in unbinned p\n                       ixels, separated by 'x', e.g. 4096x4096x1000\n</code></pre>"},{"location":"reference/warptools/api/general/#move_data","title":"move_data","text":"<pre><code>WarpTools - a collection of tools for EM data pre-processing\nVersion 2.0.0\n\nShowing all available options for command move_data:\n\n------------------------------Data import settings------------------------------\n\n--settings                REQUIRED Path to Warp's .settings file, typically loca\n                          ted in the processing folder. Default file name is 'pr\n                          evious.settings'.\n\n\n--------------------------------------------------------------------------------\n\n--to                      REQUIRED New directory containing raw data; if raw dat\n                          a are located in sub-folders and require recursive sea\n                          rch, specify the top directory here\n\n--new_settings            REQUIRED Where to save an updated .settings file conta\n                          ining the new raw data location\n\n\n----------------------Advanced data import &amp; flow options-----------------------\n\n--input_data              Overrides the list of input files specified in the .se\n                          ttings file. Accepts a space-separated list of files, \n                          wildcard patterns, or .txt files with one file name pe\n                          r line.\n\n--input_data_recursive    Enables recursive search for files matching the wildca\n                          rd pattern specified in --input_data. Only applicable \n                          when processing and directories are separate. All file\n                           names must be unique.\n\n--input_processing        Specifies an alternative directory containing pre-proc\n                          essed results. Overrides the processing directory in t\n                          he .settings file.\n\n--output_processing       Specifies an alternative directory to save processing \n                          results. Overrides the processing directory in the .se\n                          ttings file.\n\n--input_norawdata         Ignore the existence of raw data and look for XML meta\n                          data in the processing directory instead.\n</code></pre>"},{"location":"reference/warptools/api/general/#filter_quality","title":"filter_quality","text":"<pre><code>WarpTools - a collection of tools for EM data pre-processing\nVersion 2.0.0\n\nShowing all available options for command filter_quality:\n\n------------------------------Data import settings------------------------------\n\n--settings                REQUIRED Path to Warp's .settings file, typically loca\n                          ted in the processing folder. Default file name is 'pr\n                          evious.settings'.\n\n\n------------------------Output mode (mutually exclusive)------------------------\n\n--histograms              Print a histogram for each quality metric and exit\n\n-o, --output              Path to a .txt file that will contain a list of series\n                           that pass the filter criteria\n\n\n----------------------------------CTF metrics-----------------------------------\n\n--defocus                 Defocus in \u00b5m: 1 value = min; 2 values = min &amp; max\n\n--astigmatism             Astigmatism deviation from the dataset's mean, express\n                          ed in standard deviations: 1 value = min; 2 values = m\n                          in &amp; max\n\n--phase                   Phase shift as a fraction of \u03c0: 1 value = min; 2 value\n                          s = min &amp; max\n\n--resolution              Resolution estimate based on CTF fit: 1 value = min; 2\n                           values = min &amp; max\n\n\n---------------------------------Motion metrics---------------------------------\n\n--motion                  Average motion in first 1/3 of a frame series in \u00c5: 1 \n                          value = min; 2 values = min &amp; max\n\n\n-----------------------------Image content metrics------------------------------\n\n--crap                    Percentage of masked area in an image (frame series on\n                          ly): 1 value = min; 2 values = min &amp; max\n\n--particles               Number of particles: 1 value = min; 2 values = min &amp; m\n                          ax; requires --particles_star to be set\n\n--particles_star          Path to STAR file(s) with particle information; may co\n                          ntain a wildcard that matches multiple files\n\n\n------------------------------Tilt series metrics-------------------------------\n\n--ntilts                  Number of tilts in a tilt series: 1 value = min; 2 val\n                          ues = min &amp; max\n\n\n----------------------Advanced data import &amp; flow options-----------------------\n\n--input_data              Overrides the list of input files specified in the .se\n                          ttings file. Accepts a space-separated list of files, \n                          wildcard patterns, or .txt files with one file name pe\n                          r line.\n\n--input_data_recursive    Enables recursive search for files matching the wildca\n                          rd pattern specified in --input_data. Only applicable \n                          when processing and directories are separate. All file\n                           names must be unique.\n\n--input_processing        Specifies an alternative directory containing pre-proc\n                          essed results. Overrides the processing directory in t\n                          he .settings file.\n\n--output_processing       Specifies an alternative directory to save processing \n                          results. Overrides the processing directory in the .se\n                          ttings file.\n\n--input_norawdata         Ignore the existence of raw data and look for XML meta\n                          data in the processing directory instead.\n</code></pre>"},{"location":"reference/warptools/api/general/#change_selection","title":"change_selection","text":"<pre><code>WarpTools - a collection of tools for EM data pre-processing\nVersion 2.0.0\n\nShowing all available options for command change_selection:\n\n------------------------------Data import settings------------------------------\n\n--settings                REQUIRED Path to Warp's .settings file, typically loca\n                          ted in the processing folder. Default file name is 'pr\n                          evious.settings'.\n\n\n--------------------------------------------------------------------------------\n\n--select                  Change status to selected\n\n--deselect                Change status to deselected\n\n--null                    Change status to null, which is the default status\n\n--invert                  Invert status if it isn't null\n\n\n----------------------Advanced data import &amp; flow options-----------------------\n\n--input_data              Overrides the list of input files specified in the .se\n                          ttings file. Accepts a space-separated list of files, \n                          wildcard patterns, or .txt files with one file name pe\n                          r line.\n\n--input_data_recursive    Enables recursive search for files matching the wildca\n                          rd pattern specified in --input_data. Only applicable \n                          when processing and directories are separate. All file\n                           names must be unique.\n\n--input_processing        Specifies an alternative directory containing pre-proc\n                          essed results. Overrides the processing directory in t\n                          he .settings file.\n\n--output_processing       Specifies an alternative directory to save processing \n                          results. Overrides the processing directory in the .se\n                          ttings file.\n\n--input_norawdata         Ignore the existence of raw data and look for XML meta\n                          data in the processing directory instead.\n</code></pre>"},{"location":"reference/warptools/api/general/#threshold_picks","title":"threshold_picks","text":"<pre><code>WarpTools - a collection of tools for EM data pre-processing\nVersion 2.0.0\n\nShowing all available options for command threshold_picks:\n\n------------------------------Data import settings------------------------------\n\n--settings                REQUIRED Path to Warp's .settings file, typically loca\n                          ted in the processing folder. Default file name is 'pr\n                          evious.settings'.\n\n\n--------------------------------------------------------------------------------\n\n--in_suffix               REQUIRED Suffix for the names of the input STAR files \n                          (file names will be assumed to match {item name}_{--in\n                          _suffix}.star pattern)\n\n--out_suffix              REQUIRED Suffix for the names of the output STAR files\n                           (file names will be {item name}_{--in_suffix}_{--outs\n                          uffix}.star)\n\n--out_combined            Path to a single STAR file into which all results will\n                           be combined; internal paths will be made relative to \n                          this location\n\n--minimum                 Remove all particles below this threshold\n\n--maximum                 Remove all particles above this threshold\n\n--top_series              Keep this many top-scoring series\n\n--top_picks               Keep this many top-scoring particles for each series\n\n\n----------------------Advanced data import &amp; flow options-----------------------\n\n--input_data              Overrides the list of input files specified in the .se\n                          ttings file. Accepts a space-separated list of files, \n                          wildcard patterns, or .txt files with one file name pe\n                          r line.\n\n--input_data_recursive    Enables recursive search for files matching the wildca\n                          rd pattern specified in --input_data. Only applicable \n                          when processing and directories are separate. All file\n                           names must be unique.\n\n--input_processing        Specifies an alternative directory containing pre-proc\n                          essed results. Overrides the processing directory in t\n                          he .settings file.\n\n--output_processing       Specifies an alternative directory to save processing \n                          results. Overrides the processing directory in the .se\n                          ttings file.\n\n--input_norawdata         Ignore the existence of raw data and look for XML meta\n                          data in the processing directory instead.\n</code></pre>"},{"location":"reference/warptools/api/general/#helpgpt","title":"helpgpt","text":"<pre><code>WarpTools - a collection of tools for EM data pre-processing\nVersion 2.0.0\n\nShowing all available options for command helpgpt:\n\n--------------------------------------------------------------------------------\n\n--key    OpenAI key to be saved to ~/openai.key\n</code></pre>"},{"location":"reference/warptools/api/tilt_series/","title":"Tilt Series","text":""},{"location":"reference/warptools/api/tilt_series/#ts_import","title":"ts_import","text":"<pre><code>WarpTools - a collection of tools for EM data pre-processing\nVersion 2.0.0\n\nShowing all available options for command ts_import:\n\n--------------------------------------------------------------------------------\n\n--mdocs            REQUIRED Path to the folder containing MDOC files\n\n--pattern          Default: *.mdoc. File name pattern to search for in the MDOC \n                   folder\n\n--frameseries      REQUIRED Path to a folder containing frame series processing \n                   results and their aligned averages\n\n--tilt_exposure    REQUIRED Per-tilt exposure in e-/A^2\n\n--dont_invert      Don't invert tilt angles compared to IMOD's convention (inver\n                   sion is usually needed to match IMOD's geometric handedness).\n                    This will flip the geometric handedness\n\n--override_axis    Override the tilt axis angle with this value\n\n--auto_zero        Adjust tilt angles so that the tilt with the highest average \n                   intensity becomes the 0-tilt\n\n--tilt_offset      Subtract this value from all tilt angle values to compensate \n                   pre-tilt\n\n--max_tilt         Default: 90. Exclude all tilts above this (absolute) tilt ang\n                   le\n\n--min_intensity    Default: 0. Exclude tilts if their average intensity is below\n                    MinIntensity * cos(angle) * 0-tilt intensity; set to 0 to no\n                   t exclude anything\n\n--max_mask         Default: 1. Exclude tilts if more than this fraction of their\n                    pixels is masked; needs frame series with BoxNet masking res\n                   ults\n\n--min_ntilts       Default: 1. Only import tilt series that have at least this m\n                   any tilts after all the other filters have been applied\n\n-o, --output       REQUIRED Path to a folder where the created .tomostar files w\n                   ill be saved\n</code></pre>"},{"location":"reference/warptools/api/tilt_series/#ts_stack","title":"ts_stack","text":"<pre><code>WarpTools - a collection of tools for EM data pre-processing\nVersion 2.0.0\n\nShowing all available options for command ts_stack:\n\n------------------------------Data import settings------------------------------\n\n--settings                REQUIRED Path to Warp's .settings file, typically loca\n                          ted in the processing folder. Default file name is 'pr\n                          evious.settings'.\n\n\n--------------------------------------------------------------------------------\n\n--angpix                  Rescale tilt images to this pixel size; leave out to k\n                          eep the original pixel size\n\n--mask                    Apply mask to each image if available; masked areas wi\n                          ll be filled with Gaussian noise\n\n\n-------------------------------Work distribution--------------------------------\n\n--device_list             Space-separated list of GPU IDs to use for processing.\n                           Default: all GPUs in the system\n\n--perdevice               Default: 1. Number of processes per GPU\n\n\n----------------------Advanced data import &amp; flow options-----------------------\n\n--input_data              Overrides the list of input files specified in the .se\n                          ttings file. Accepts a space-separated list of files, \n                          wildcard patterns, or .txt files with one file name pe\n                          r line.\n\n--input_data_recursive    Enables recursive search for files matching the wildca\n                          rd pattern specified in --input_data. Only applicable \n                          when processing and directories are separate. All file\n                           names must be unique.\n\n--input_processing        Specifies an alternative directory containing pre-proc\n                          essed results. Overrides the processing directory in t\n                          he .settings file.\n\n--output_processing       Specifies an alternative directory to save processing \n                          results. Overrides the processing directory in the .se\n                          ttings file.\n\n--input_norawdata         Ignore the existence of raw data and look for XML meta\n                          data in the processing directory instead.\n\n\n-----------------------Advanced remote work distribution------------------------\n\n--workers                 List of remote workers to be used instead of locally s\n                          pawned processes. Formatted as hostname:port, separate\n                          d by spaces\n</code></pre>"},{"location":"reference/warptools/api/tilt_series/#ts_aretomo","title":"ts_aretomo","text":"<pre><code>WarpTools - a collection of tools for EM data pre-processing\nVersion 2.0.0\n\nShowing all available options for command ts_aretomo:\n\n------------------------------Data import settings------------------------------\n\n--settings                REQUIRED Path to Warp's .settings file, typically loca\n                          ted in the processing folder. Default file name is 'pr\n                          evious.settings'.\n\n\n--------------------------------------------------------------------------------\n\n--angpix                  Rescale tilt images to this pixel size; normally 10\u201315\n                           for cryo data; leave out to keep the original pixel s\n                          ize\n\n--mask                    Apply mask to each image if available; masked areas wi\n                          ll be filled with Gaussian noise\n\n--alignz                  REQUIRED Value for AreTomo's AlignZ parameter in Angst\n                          rom (will be auto-converted to binned pixels), i.e. th\n                          e thickness of the reconstructed tomogram used for ali\n                          gnments\n\n--axis_iter               Default: 0. Number of tilt axis angle refinement itera\n                          tions; each iteration will be started with median valu\n                          e from previous iteration, final iteration will use fi\n                          xed angle\n\n--axis_batch              Default: 0. Use only this many tilt series for the til\n                          t axis angle search; only relevant if --axis_iter isn'\n                          t 0\n\n--min_fov                 Default: 0. Disable tilts that contain less than this \n                          fraction of the tomogram's field of view due to excess\n                          ive shifts\n\n--axis                    Override tilt axis angle with this value\n\n--patches                 Number of patches for local alignments in X, Y, separa\n                          ted by 'x': e.g. 6x4. Increases processing time.\n\n--delete_intermediate     Delete tilt series stacks generated for AreTomo\n\n--exe                     Default: AreTomo2. Name of the AreTomo2 executable; mu\n                          st be in $PATH\n\n\n-------------------------------Work distribution--------------------------------\n\n--device_list             Space-separated list of GPU IDs to use for processing.\n                           Default: all GPUs in the system\n\n--perdevice               Default: 1. Number of processes per GPU\n\n\n----------------------Advanced data import &amp; flow options-----------------------\n\n--input_data              Overrides the list of input files specified in the .se\n                          ttings file. Accepts a space-separated list of files, \n                          wildcard patterns, or .txt files with one file name pe\n                          r line.\n\n--input_data_recursive    Enables recursive search for files matching the wildca\n                          rd pattern specified in --input_data. Only applicable \n                          when processing and directories are separate. All file\n                           names must be unique.\n\n--input_processing        Specifies an alternative directory containing pre-proc\n                          essed results. Overrides the processing directory in t\n                          he .settings file.\n\n--output_processing       Specifies an alternative directory to save processing \n                          results. Overrides the processing directory in the .se\n                          ttings file.\n\n--input_norawdata         Ignore the existence of raw data and look for XML meta\n                          data in the processing directory instead.\n\n\n-----------------------Advanced remote work distribution------------------------\n\n--workers                 List of remote workers to be used instead of locally s\n                          pawned processes. Formatted as hostname:port, separate\n                          d by spaces\n</code></pre>"},{"location":"reference/warptools/api/tilt_series/#ts_etomo_fiducials","title":"ts_etomo_fiducials","text":"<pre><code>WarpTools - a collection of tools for EM data pre-processing\nVersion 2.0.0\n\nShowing all available options for command ts_etomo_fiducials:\n\n------------------------------Data import settings------------------------------\n\n--settings                REQUIRED Path to Warp's .settings file, typically loca\n                          ted in the processing folder. Default file name is 'pr\n                          evious.settings'.\n\n\n--------------------------------------------------------------------------------\n\n--angpix                  Rescale tilt images to this pixel size; normally 10\u201315\n                           for cryo data; leave out to keep the original pixel s\n                          ize\n\n--mask                    Apply mask to each image if available; masked areas wi\n                          ll be filled with Gaussian noise\n\n--min_fov                 Default: 0. Disable tilts that contain less than this \n                          fraction of the tomogram's field of view due to excess\n                          ive shifts\n\n--initial_axis            Override initial tilt axis angle with this value\n\n--do_axis_search          Fit a new tilt axis angle for the whole dataset\n\n--fiducial_size           size of gold fiducials in nanometers\n\n--n_beads_target          Default: 50. target number of beads to find in IMOD\n\n--delete_intermediate     Delete tilt series stacks generated for ETomo\n\n\n-------------------------------Work distribution--------------------------------\n\n--device_list             Space-separated list of GPU IDs to use for processing.\n                           Default: all GPUs in the system\n\n--perdevice               Default: 1. Number of processes per GPU\n\n\n----------------------Advanced data import &amp; flow options-----------------------\n\n--input_data              Overrides the list of input files specified in the .se\n                          ttings file. Accepts a space-separated list of files, \n                          wildcard patterns, or .txt files with one file name pe\n                          r line.\n\n--input_data_recursive    Enables recursive search for files matching the wildca\n                          rd pattern specified in --input_data. Only applicable \n                          when processing and directories are separate. All file\n                           names must be unique.\n\n--input_processing        Specifies an alternative directory containing pre-proc\n                          essed results. Overrides the processing directory in t\n                          he .settings file.\n\n--output_processing       Specifies an alternative directory to save processing \n                          results. Overrides the processing directory in the .se\n                          ttings file.\n\n--input_norawdata         Ignore the existence of raw data and look for XML meta\n                          data in the processing directory instead.\n\n\n-----------------------Advanced remote work distribution------------------------\n\n--workers                 List of remote workers to be used instead of locally s\n                          pawned processes. Formatted as hostname:port, separate\n                          d by spaces\n</code></pre>"},{"location":"reference/warptools/api/tilt_series/#ts_etomo_patches","title":"ts_etomo_patches","text":"<pre><code>WarpTools - a collection of tools for EM data pre-processing\nVersion 2.0.0\n\nShowing all available options for command ts_etomo_patches:\n\n------------------------------Data import settings------------------------------\n\n--settings                REQUIRED Path to Warp's .settings file, typically loca\n                          ted in the processing folder. Default file name is 'pr\n                          evious.settings'.\n\n\n--------------------------------------------------------------------------------\n\n--angpix                  Rescale tilt images to this pixel size; normally 10\u201315\n                           for cryo data; leave out to keep the original pixel s\n                          ize\n\n--mask                    Apply mask to each image if available; masked areas wi\n                          ll be filled with Gaussian noise\n\n--min_fov                 Default: 0. Disable tilts that contain less than this \n                          fraction of the tomogram's field of view due to excess\n                          ive shifts\n\n--initial_axis            Override initial tilt axis angle with this value\n\n--do_axis_search          Fit a new tilt axis angle for the whole dataset\n\n--patch_size              Default: 500. patch size for patch tracking in Angstro\n                          ms\n\n--delete_intermediate     Delete tilt series stacks generated for Etomo\n\n\n-------------------------------Work distribution--------------------------------\n\n--device_list             Space-separated list of GPU IDs to use for processing.\n                           Default: all GPUs in the system\n\n--perdevice               Default: 1. Number of processes per GPU\n\n\n----------------------Advanced data import &amp; flow options-----------------------\n\n--input_data              Overrides the list of input files specified in the .se\n                          ttings file. Accepts a space-separated list of files, \n                          wildcard patterns, or .txt files with one file name pe\n                          r line.\n\n--input_data_recursive    Enables recursive search for files matching the wildca\n                          rd pattern specified in --input_data. Only applicable \n                          when processing and directories are separate. All file\n                           names must be unique.\n\n--input_processing        Specifies an alternative directory containing pre-proc\n                          essed results. Overrides the processing directory in t\n                          he .settings file.\n\n--output_processing       Specifies an alternative directory to save processing \n                          results. Overrides the processing directory in the .se\n                          ttings file.\n\n--input_norawdata         Ignore the existence of raw data and look for XML meta\n                          data in the processing directory instead.\n\n\n-----------------------Advanced remote work distribution------------------------\n\n--workers                 List of remote workers to be used instead of locally s\n                          pawned processes. Formatted as hostname:port, separate\n                          d by spaces\n</code></pre>"},{"location":"reference/warptools/api/tilt_series/#ts_import_alignments","title":"ts_import_alignments","text":"<pre><code>WarpTools - a collection of tools for EM data pre-processing\nVersion 2.0.0\n\nShowing all available options for command ts_import_alignments:\n\n------------------------------Data import settings------------------------------\n\n--settings                REQUIRED Path to Warp's .settings file, typically loca\n                          ted in the processing folder. Default file name is 'pr\n                          evious.settings'.\n\n\n--------------------------------------------------------------------------------\n\n--alignments              REQUIRED Path to a folder containing one sub-folder pe\n                          r tilt series with alignment results from IMOD or AreT\n                          omo\n\n--alignment_angpix        REQUIRED Pixel size (in Angstrom) of the images used t\n                          o create the alignments (used to convert the alignment\n                           shifts from pixels to Angstrom)\n\n--min_fov                 Default: 0. Disable tilts that contain less than this \n                          fraction of the tomogram's field of view due to excess\n                          ive shifts\n\n\n----------------------Advanced data import &amp; flow options-----------------------\n\n--input_data              Overrides the list of input files specified in the .se\n                          ttings file. Accepts a space-separated list of files, \n                          wildcard patterns, or .txt files with one file name pe\n                          r line.\n\n--input_data_recursive    Enables recursive search for files matching the wildca\n                          rd pattern specified in --input_data. Only applicable \n                          when processing and directories are separate. All file\n                           names must be unique.\n\n--input_processing        Specifies an alternative directory containing pre-proc\n                          essed results. Overrides the processing directory in t\n                          he .settings file.\n\n--output_processing       Specifies an alternative directory to save processing \n                          results. Overrides the processing directory in the .se\n                          ttings file.\n\n--input_norawdata         Ignore the existence of raw data and look for XML meta\n                          data in the processing directory instead.\n</code></pre>"},{"location":"reference/warptools/api/tilt_series/#ts_defocus_hand","title":"ts_defocus_hand","text":"<pre><code>WarpTools - a collection of tools for EM data pre-processing\nVersion 2.0.0\n\nShowing all available options for command ts_defocus_hand:\n\n------------------------------Data import settings------------------------------\n\n--settings                REQUIRED Path to Warp's .settings file, typically loca\n                          ted in the processing folder. Default file name is 'pr\n                          evious.settings'.\n\n\n--------------------------------------------------------------------------------\n\n--check                   Only check the defocus handedness, but don't set anyth\n                          ing\n\n--set_auto                Check the defocus handedness and set the determined va\n                          lue for all tilt series\n\n--set_flip                Set handedness to 'flip' for all tilt series\n\n--set_noflip              Set handedness to 'no flip' for all tilt series\n\n--set_switch              Switch whatever handedness value each tilt series has \n                          to the opposite value\n\n\n----------------------Advanced data import &amp; flow options-----------------------\n\n--input_data              Overrides the list of input files specified in the .se\n                          ttings file. Accepts a space-separated list of files, \n                          wildcard patterns, or .txt files with one file name pe\n                          r line.\n\n--input_data_recursive    Enables recursive search for files matching the wildca\n                          rd pattern specified in --input_data. Only applicable \n                          when processing and directories are separate. All file\n                           names must be unique.\n\n--input_processing        Specifies an alternative directory containing pre-proc\n                          essed results. Overrides the processing directory in t\n                          he .settings file.\n\n--output_processing       Specifies an alternative directory to save processing \n                          results. Overrides the processing directory in the .se\n                          ttings file.\n\n--input_norawdata         Ignore the existence of raw data and look for XML meta\n                          data in the processing directory instead.\n</code></pre>"},{"location":"reference/warptools/api/tilt_series/#ts_ctf","title":"ts_ctf","text":"<pre><code>WarpTools - a collection of tools for EM data pre-processing\nVersion 2.0.0\n\nShowing all available options for command ts_ctf:\n\n------------------------------Data import settings------------------------------\n\n--settings                REQUIRED Path to Warp's .settings file, typically loca\n                          ted in the processing folder. Default file name is 'pr\n                          evious.settings'.\n\n\n--------------------------------------------------------------------------------\n\n--window                  Default: 512. Patch size for CTF estimation in binned \n                          pixels\n\n--range_low               Default: 30. Lowest (worst) resolution in Angstrom to \n                          consider in fit\n\n--range_high              Default: 4. Highest (best) resolution in Angstrom to c\n                          onsider in fit\n\n--defocus_min             Default: 0.5. Minimum defocus value in um to explore d\n                          uring fitting (positive = underfocus)\n\n--defocus_max             Default: 5. Maximum defocus value in um to explore dur\n                          ing fitting (positive = underfocus)\n\n--voltage                 Default: 300. Acceleration voltage of the microscope i\n                          n kV\n\n--cs                      Default: 2.7. Spherical aberration of the microscope i\n                          n mm\n\n--amplitude               Default: 0.07. Amplitude contrast of the sample, usual\n                          ly 0.07-0.10 for cryo\n\n--fit_phase               Fit the phase shift of a phase plate\n\n--auto_hand               Run defocus handedness estimation based on this many t\n                          ilt series (e.g. 10), then estimate CTF with the corre\n                          ct handedness\n\n\n-------------------------------Work distribution--------------------------------\n\n--device_list             Space-separated list of GPU IDs to use for processing.\n                           Default: all GPUs in the system\n\n--perdevice               Default: 1. Number of processes per GPU\n\n\n----------------------Advanced data import &amp; flow options-----------------------\n\n--input_data              Overrides the list of input files specified in the .se\n                          ttings file. Accepts a space-separated list of files, \n                          wildcard patterns, or .txt files with one file name pe\n                          r line.\n\n--input_data_recursive    Enables recursive search for files matching the wildca\n                          rd pattern specified in --input_data. Only applicable \n                          when processing and directories are separate. All file\n                           names must be unique.\n\n--input_processing        Specifies an alternative directory containing pre-proc\n                          essed results. Overrides the processing directory in t\n                          he .settings file.\n\n--output_processing       Specifies an alternative directory to save processing \n                          results. Overrides the processing directory in the .se\n                          ttings file.\n\n--input_norawdata         Ignore the existence of raw data and look for XML meta\n                          data in the processing directory instead.\n\n\n-----------------------Advanced remote work distribution------------------------\n\n--workers                 List of remote workers to be used instead of locally s\n                          pawned processes. Formatted as hostname:port, separate\n                          d by spaces\n</code></pre>"},{"location":"reference/warptools/api/tilt_series/#ts_reconstruct","title":"ts_reconstruct","text":"<pre><code>WarpTools - a collection of tools for EM data pre-processing\nVersion 2.0.0\n\nShowing all available options for command ts_reconstruct:\n\n------------------------------Data import settings------------------------------\n\n--settings                REQUIRED Path to Warp's .settings file, typically loca\n                          ted in the processing folder. Default file name is 'pr\n                          evious.settings'.\n\n\n--------------------------------------------------------------------------------\n\n--angpix                  REQUIRED Pixel size of the reconstructed tomograms in \n                          Angstrom\n\n--halfmap_frames          Also produce two half-tomograms, each reconstructed fr\n                          om half of the frames (requires running align_frameser\n                          ies with --average_halves previously)\n\n--halfmap_tilts           Also produce two half-tomograms, each reconstructed fr\n                          om half of the tilts (doesn't work quite as well as --\n                          halfmap_frames)\n\n--deconv                  Also produce a deconvolved version; all half-tomograms\n                          , if requested, will also be deconvolved\n\n--deconv_strength         Default: 1. Strength of the deconvolution filter, if r\n                          equested\n\n--deconv_falloff          Default: 1. Fall-off of the deconvolution filter, if r\n                          equested\n\n--deconv_highpass         Default: 300. High-pass value (in Angstrom) of the dec\n                          onvolution filter, if requested\n\n--keep_full_voxels        Mask out voxels that aren't contained in some of the t\n                          ilt images (due to excessive sample shifts); don't use\n                           if you intend to run template matching\n\n--dont_invert             Don't invert the contrast; contrast inversion is neede\n                          d for template matching on cryo data, i.e. when the de\n                          nsity is dark in original images\n\n--dont_normalize          Don't normalize the tilt images\n\n--dont_mask               Don't apply a mask to each tilt image if available; ot\n                          herwise, masked areas will be filled with Gaussian noi\n                          se\n\n--dont_overwrite          Don't overwrite existing tomograms in output directory\n\n--subvolume_size          Default: 64. Reconstruction is performed locally using\n                           sub-volumes of this size in pixel\n\n--subvolume_padding       Default: 3. Padding factor for the reconstruction sub-\n                          volumes (helps with aliasing effects at sub-volume bor\n                          ders)\n\n\n-------------------------------Work distribution--------------------------------\n\n--device_list             Space-separated list of GPU IDs to use for processing.\n                           Default: all GPUs in the system\n\n--perdevice               Default: 1. Number of processes per GPU\n\n\n----------------------Advanced data import &amp; flow options-----------------------\n\n--input_data              Overrides the list of input files specified in the .se\n                          ttings file. Accepts a space-separated list of files, \n                          wildcard patterns, or .txt files with one file name pe\n                          r line.\n\n--input_data_recursive    Enables recursive search for files matching the wildca\n                          rd pattern specified in --input_data. Only applicable \n                          when processing and directories are separate. All file\n                           names must be unique.\n\n--input_processing        Specifies an alternative directory containing pre-proc\n                          essed results. Overrides the processing directory in t\n                          he .settings file.\n\n--output_processing       Specifies an alternative directory to save processing \n                          results. Overrides the processing directory in the .se\n                          ttings file.\n\n--input_norawdata         Ignore the existence of raw data and look for XML meta\n                          data in the processing directory instead.\n\n\n-----------------------Advanced remote work distribution------------------------\n\n--workers                 List of remote workers to be used instead of locally s\n                          pawned processes. Formatted as hostname:port, separate\n                          d by spaces\n</code></pre>"},{"location":"reference/warptools/api/tilt_series/#ts_template_match","title":"ts_template_match","text":"<pre><code>WarpTools - a collection of tools for EM data pre-processing\nVersion 2.0.0\n\nShowing all available options for command ts_template_match:\n\n------------------------------Data import settings------------------------------\n\n--settings                REQUIRED Path to Warp's .settings file, typically loca\n                          ted in the processing folder. Default file name is 'pr\n                          evious.settings'.\n\n\n--------------------------------------------------------------------------------\n\n--tomo_angpix             REQUIRED Pixel size of the reconstructed tomograms in \n                          Angstrom\n\n--template_path           Path to the template file\n\n--template_emdb           Instead of providing a local map, download the EMDB en\n                          try with this ID and use its main map\n\n--template_angpix         Pixel size of the template; leave empty to use value f\n                          rom map header\n\n--template_diameter       REQUIRED Template diameter in Angstrom\n\n--template_flip           Mirror the template along the X axis to flip the hande\n                          dness; '_flipx' will be added to the template's name\n\n--symmetry                Default: C1. Symmetry of the template, e.g. C1, D7, O\n\n--subdivisions            Default: 3. Number of subdivisions defining the angula\n                          r search step: 2 = 15\u00b0 step, 3 = 7.5\u00b0, 4 = 3.75\u00b0 and s\n                          o on\n\n--tilt_range              Limit the range of angles between the reference's Z ax\n                          is and the tomogram's XY plane to plus/minus this valu\n                          e, in \u00b0; useful for matching filaments lying flat in t\n                          he XY plane\n\n--batch_angles            Default: 32. How many orientations to evaluate at once\n                          ; memory consumption scales linearly with this; higher\n                           than 32 probably won't lead to speed-ups\n\n--peak_distance           Minimum distance (in Angstrom) between peaks; leave em\n                          pty to use template diameter\n\n--npeaks                  Default: 2000. Maximum number of peak positions to sav\n                          e\n\n--dont_normalize          Don't set score distribution to median = 0, stddev = 1\n\n--whiten                  Perform spectral whitening to give higher-resolution i\n                          nformation more weight; this can help when the alignme\n                          nts are already good and you need more selective match\n                          ing\n\n--lowpass                 Default: 1. Gaussian low-pass filter to be applied to \n                          template and tomogram, in fractions of Nyquist; 1.0 = \n                          no low-pass, &lt;1.0 = low-pass\n\n--lowpass_sigma           Default: 0.1. Sigma (i.e. fall-off) of the Gaussian lo\n                          w-pass filter, in fractions of Nyquist; larger value =\n                           slower fall-off\n\n--reuse_results           Reuse correlation volumes from a previous run if avail\n                          able, only extract peak positions\n\n--check_hand              Default: 0. Also try a flipped version of the template\n                           on this many tomograms to see what geometric hand the\n                          y have\n\n--subvolume_size          Default: 192. Matching is performed locally using sub-\n                          volumes of this size in pixel\n\n\n-------------------------------Work distribution--------------------------------\n\n--device_list             Space-separated list of GPU IDs to use for processing.\n                           Default: all GPUs in the system\n\n--perdevice               Default: 1. Number of processes per GPU\n\n\n----------------------Advanced data import &amp; flow options-----------------------\n\n--input_data              Overrides the list of input files specified in the .se\n                          ttings file. Accepts a space-separated list of files, \n                          wildcard patterns, or .txt files with one file name pe\n                          r line.\n\n--input_data_recursive    Enables recursive search for files matching the wildca\n                          rd pattern specified in --input_data. Only applicable \n                          when processing and directories are separate. All file\n                           names must be unique.\n\n--input_processing        Specifies an alternative directory containing pre-proc\n                          essed results. Overrides the processing directory in t\n                          he .settings file.\n\n--output_processing       Specifies an alternative directory to save processing \n                          results. Overrides the processing directory in the .se\n                          ttings file.\n\n--input_norawdata         Ignore the existence of raw data and look for XML meta\n                          data in the processing directory instead.\n\n\n-----------------------Advanced remote work distribution------------------------\n\n--workers                 List of remote workers to be used instead of locally s\n                          pawned processes. Formatted as hostname:port, separate\n                          d by spaces\n</code></pre>"},{"location":"reference/warptools/api/tilt_series/#ts_export_particles","title":"ts_export_particles","text":"<pre><code>WarpTools - a collection of tools for EM data pre-processing\nVersion 2.0.0\n\nShowing all available options for command ts_export_particles:\n\n------------------------------Data import settings------------------------------\n\n--settings                 REQUIRED Path to Warp's .settings file, typically loc\n                           ated in the processing folder. Default file name is '\n                           previous.settings'.\n\n\n----------------------STAR files with particle coordinates----------------------\n\n--input_star               Single STAR file containing particle poses to be expo\n                           rted\n\n--input_directory          Directory containing multiple STAR files each with pa\n                           rticle poses to be exported\n\n--input_pattern            Default: *.star. Wildcard pattern to search for from \n                           the input directory\n\n\n-------------------------------Coordinate scaling-------------------------------\n\n--coords_angpix            Pixel size for particles coordinates in input star fi\n                           le(s)\n\n--normalized_coords        Are coordinates normalised to the range [0, 1] (e.g. \n                           from Warp's template matching)\n\n\n-------------------------------------Output-------------------------------------\n\n--output_star              REQUIRED STAR file for exported particles\n\n--output_angpix            REQUIRED Pixel size at which to export particles\n\n--box                      REQUIRED Output has this many pixels/voxels on each s\n                           ide\n\n--diameter                 REQUIRED Particle diameter in angstroms\n\n--relative_output_paths    Make paths in output STAR file relative to the locati\n                           on of the STAR file. They will be relative to the wor\n                           king directory otherwise.\n\n\n-------------------Export type (REQUIRED, mutually exclusive)-------------------\n\n--2d                       Output particles as 2d image series centered on the p\n                           article (particle series)\n\n--3d                       Output particles as 3d images (subtomograms)\n\n\n---------------------------------Expert options---------------------------------\n\n--dont_normalize_input     Don't normalize the entire field of view in input 2D \n                           images after high-pass filtering\n\n--dont_normalize_3d        Don't normalize output particle volumes (only works w\n                           ith --3d)\n\n--n_tilts                  Number of tilt images to include in the output, image\n                           s with the lowest overall exposure will be included f\n                           irst\n\n\n-------------------------------Work distribution--------------------------------\n\n--device_list              Space-separated list of GPU IDs to use for processing\n                           . Default: all GPUs in the system\n\n--perdevice                Default: 1. Number of processes per GPU\n\n\n----------------------Advanced data import &amp; flow options-----------------------\n\n--input_data               Overrides the list of input files specified in the .s\n                           ettings file. Accepts a space-separated list of files\n                           , wildcard patterns, or .txt files with one file name\n                            per line.\n\n--input_data_recursive     Enables recursive search for files matching the wildc\n                           ard pattern specified in --input_data. Only applicabl\n                           e when processing and directories are separate. All f\n                           ile names must be unique.\n\n--input_processing         Specifies an alternative directory containing pre-pro\n                           cessed results. Overrides the processing directory in\n                            the .settings file.\n\n--output_processing        Specifies an alternative directory to save processing\n                            results. Overrides the processing directory in the .\n                           settings file.\n\n--input_norawdata          Ignore the existence of raw data and look for XML met\n                           adata in the processing directory instead.\n\n\n-----------------------Advanced remote work distribution------------------------\n\n--workers                  List of remote workers to be used instead of locally \n                           spawned processes. Formatted as hostname:port, separa\n                           ted by spaces\n</code></pre>"},{"location":"reference/warptools/api/tilt_series/#ts_eval_model","title":"ts_eval_model","text":"<pre><code>WarpTools - a collection of tools for EM data pre-processing\nVersion 2.0.0\n\nShowing all available options for command ts_eval_model:\n\n------------------------------Data import settings------------------------------\n\n--settings                REQUIRED Path to Warp's .settings file, typically loca\n                          ted in the processing folder. Default file name is 'pr\n                          evious.settings'.\n\n\n--------------------------------------------------------------------------------\n\n--input_star              Path to a STAR file containing custom positions specif\n                          ied using tomoCenteredCoordinate(X/Y/Z)Angst labels. L\n                          eave empty to use a regular grid of positions instead.\n\n--grid_extent             Instead of custom positions in --input_star, calculate\n                           an evenly spaced grid with this extent in Angstrom, s\n                          pecified as 'XxYxZ', e.g. 6000x4000x1000.\n\n--grid_dims               When calculating an evenly spaced grid, it will have t\n                          his many points in each dimension, specified as 'XxYxZ\n                          ', e.g. 30x20x5. The grid spacing will be grid_extent \n                          / (grid_dims - 1).\n\n--output                  Output location for the per-tilt series STAR files\n\n\n----------------------Advanced data import &amp; flow options-----------------------\n\n--input_data              Overrides the list of input files specified in the .se\n                          ttings file. Accepts a space-separated list of files, \n                          wildcard patterns, or .txt files with one file name pe\n                          r line.\n\n--input_data_recursive    Enables recursive search for files matching the wildca\n                          rd pattern specified in --input_data. Only applicable \n                          when processing and directories are separate. All file\n                           names must be unique.\n\n--input_processing        Specifies an alternative directory containing pre-proc\n                          essed results. Overrides the processing directory in t\n                          he .settings file.\n\n--output_processing       Specifies an alternative directory to save processing \n                          results. Overrides the processing directory in the .se\n                          ttings file.\n\n--input_norawdata         Ignore the existence of raw data and look for XML meta\n                          data in the processing directory instead.\n</code></pre>"},{"location":"user_guide/installation/","title":"Installation","text":""},{"location":"user_guide/overview/","title":"Overview","text":"Process your cryo-EM data. Fast.  <p>This section of the site provides examples of processing your data with  Warp, M, and WarpTools.</p>"},{"location":"user_guide/m/quick_start_m/","title":"Quick Start: M","text":"<p>M is a stand-alone program shipped with Warp. While Warp handles the first stages of the data processing pipeline, M lives on its opposite end. It allows you to take refinement results from RELION and perform a multi-particle refinement. For frame series data, the procedure is similar to RELION's \"particle polishing\" and probably won't deliver significantly better results \u2013 unless you have a very heterogeneous dataset that can benefit from M's ability to consider as many classes as you want (memory limitations apply!), or maps with heterogeneous resolution that can benefit from M's map denoising. For tilt series data, M will likely deliver a noticeable resolution boost compared to patch tracking- or fiducials-based tilt alignments. Refinement of in situ data will also benefit significantly from the unlimited number of classes and transparent mechanisms for combining data from different sources.</p>"},{"location":"user_guide/m/quick_start_m/#the-pipeline","title":"The pipeline","text":"<p>Pre-processing of frame series or tilt series in Warp \u2193 Particle image or sub-tomogram export from Warp \u2193 Classification and refinement in RELION \u2193 Import and refinement in M \u2193 Final maps</p> <p>(optionally: \u2192 re-export improved particles from Warp \u2192 re-classify and refine in RELION \u2192 import and improve alignments in M \u2192 repeat as needed)</p>"},{"location":"user_guide/m/quick_start_m/#project-structure","title":"Project structure","text":"<p>M strives to be a great tool for in situ data, which have been compared to \"molecular sociology\". Thus, its terminology takes a somewhat sociological angle. A project in M is referred to as a Population. A population contains at least one data source and at least one species. A Data source contains a set of frame series or tilt series and their metadata. A * Species* is a map that is refined, as well as particle metadata for the available data sources.</p>"},{"location":"user_guide/m/quick_start_m/#creating-a-population","title":"Creating a population","text":"<p>When M starts, you can choose between creating a new population and opening an existing one. To create a new population, give it a name and specify its root folder. There are no particular requirements for this location. It won't experience much IO during refinement, and the species folders contained there might grow to a few tens of gigabytes depending on map size. For populations with a single data source, we usually just go one level above the old Warp project folder.</p>"},{"location":"user_guide/m/quick_start_m/#adding-data-sources","title":"Adding data sources","text":"<p>Once a population is open, you can click on the data source summary saying \"0 data sources\" to open the management dialog. Remote data sources are not supported at the moment. Click Add local and select a .settings file in a Warp project folder. Once M converts that file into a data source, its parameters and list of items become read-only. So if you want to change something (e.g. quality filter settings or binning value), load the folder in Warp and modify the settings. M will read in the metadata for all items and present you with the number of items that pass all quality criteria, as well as those filtered out or deselected manually. Give the data source a name, choose whether to include the sub-optimal items, and set the maximum number of frames or tilts (sorted by dose). The latter can be useful if the data have a very high overall dose that was used for picking or visual interpretation, but isn't required for high-resolution alignment \u2013 this will save computational resources during M's refinement. You can't change this setting later. Finally, click Create. The list of data sources should now contain the new source with its input settings.</p>"},{"location":"user_guide/m/quick_start_m/#adding-species","title":"Adding species","text":"<p>Make sure you've added all data sources you'd like to use, and click the big + to initiate the creation of a new species. Remote species aren't supported yet, but you can create a local one from scratch. Select From scratch and click add.</p> <p>Give the species a Name and specify its Diameter along the longest axis. This value will determine the box size (2x diameter) and the spherical mask diameter for some operations. The Molecular weight currently isn't used anywhere, but you can specify a value anyway in case some smart heuristics become available in a future M version to take advantage of it. The Symmetry follows RELION's conventions. Select the correct group and a multiplier if applicable. The number of Temporal samples for poses determines how finely per-particle translation and rotation trajectories will be resolved as a function of dose. The optimal value depends on the particle mass (bigger = more signal = can fit more parameters) and the overall dose. Frame series data with a relatively low dose can benefit from 2\u20133 sampling points (2 still works for a 150 kDa protein), while 100+ e/\u00c52 tilt series can use 3\u20134 (especially when dealing with particles as large as ribosomes). If you intend to classify the particles further after an initial M refinement, you may want to set the number of temporal samples to 1 to definitely avoid biasing the classification through overfitting on a single reference.</p> <p>For the Half-maps, it is best to select the final, unfiltered half-maps from RELION's 3D refinement. If you performed the refinement with binned data, please rescale the maps first to the pixel size you'd like to use in M, e.g. using the relion_image_handler utility. Once the first half-map is selected, M should figure out the Pixel size based on its header. If not, specify the value manually. The interactive isosurface renderings are there to help you make sure the selected half-maps are what you think they are.</p> <p>The Mask can be loaded from a volume you made using the relion_mask_create utility, or prepared in M by low-pass filtering the average of the half-maps and selecting a binarization threshold. For refinements, M will expand and smooth the mask based on the current refinement resolution. Thus, the mask you provide should be binary (no smoothing) and as tight as what you would get in RELION before the expansion and smoothing steps. The pixel size and dimensions should be the same as those of the half-maps.</p> <p>To use refined Particle positions and orientations from RELION, select a *_data.star file from the Refine3D job. M should be able to figure out the correct pixel sizes for both coordinates and shifts. Please correct the values manually if you think they are wrong. Deselect any data sources you don't want the particles to be linked to (e.g. in case of identical file names in multiple sources). If you have repeating file names across several data sources, please add the particles for one of them and use the particle set operations to add more later. M will report the number of particles that have been successfully linked to the data. If that number is 0 or lower than it should be, mismatching file names are the most likely culprit. Make sure the names in the rlnMicrographName column of the data.star file don't have any extra parts compared to the file names in the data source. For tilt series, rlnMicrographName should reference the .tomostar files.</p> <p>Once everything is specified correctly, click Finish. M will calculate some map statistics and train an initial denoising model, which might take 10\u201315 minutes depending on your hardware.</p>"},{"location":"user_guide/m/quick_start_m/#setting-up-refinement","title":"Setting up refinement","text":"<p>With all data sources and species set up, click the big Refine button to bring up the refinement dialog. Here you can select different groups of parameters to be optimized.</p> <p></p> <p>Refine for N sub-iterations: During each refinement iterations, M alternates between refining various sets of parameters. To accelerate convergence, this can be done for several sub-iterations, which will all use the same reference maps for the optimization. If you're refining only one set of parameters (e.g. particle orientations), you can set the value to 1. Otherwise, 2\u20133 makes sense.</p> <p>Use N % of available resolution in first sub-iteration: M performs a gradient descent optimization, which can easily get stuck in local optima. To avoid this, the resolution can be decreased in the beginning and gradually increased until the final sub-iteration. This can be especially useful for the first refinement iteration on a new data source. Also, when changing the image or volume warp grid resolution, you should start with lower refinement resolution (see section below). If only 1 sub-iteration is to be performed, it starts with 100 % of the available resolution.</p>"},{"location":"user_guide/m/quick_start_m/#geometry","title":"Geometry","text":"<p>Image warp: This models the non-linear 2D deformation in each frame or tilt image due to beam-induced motion and charging. The model is set in the image reference frame, so if you have rectangular 6000x4000 px K3 images, a 6x4 grid might be more favorable than 4x4. The temporal dimension of the model equals the number of frames or tilts. For frame series, a pyramid of models will be created where each subsequent model has 2x the spatial dimension of the previous one, and 0.25x the temporal dimension. So even if you start with a 1x1 model, the resulting pyramid will still model some slow spatial deformation. Tilt series don't get pyramids (although including volume warp or tilt movie refinement has a similar effect, see below). For both frame and tilt series, the optimal spatial resolution will depend on the number of particles per micrograph, as well as the signal available per particle.</p> <p>Anisotropic magnification: Some microscopes can exhibit significant linear distortion. This option enables its refinement based only on geometry (i.e. not taking its effect on the CTF into account). At the end of the iteration, the CTF is also adjusted accordingly. Because anisotropic magnification can be partially fitted with astigmatism in the CTF, defocus refinement (which includes astigmatism) is recommended in the same iteration.</p> <p>Doming (frame series only):</p> <p>Stage angles (tilt series only): Due to mechanical imprecisions in the stage's movement and lack of rigidity in lamella-like samples, the sample orientation can deviate significantly from their assumed values. While the biggest effect is in the projected particle positions, which are implicitly taken care of by the image warp model (at least 2x2 spatial resolution is required there), large particles can benefit from additional refinement of the sample/stage orientations. The temporal resolution of this model is per-tilt.</p> <p>Volume warp (tilt series only): Tilt series are often used for thick samples where multiple particles can overlap along the projection axis. If the sample experiences shearing perpendicular to the projection axis, layers of particles can be displaced in a way that can't be modeled by mere 2D deformation of the images. Instead, a warping model in the reference frame of the tomographic volume is needed to influence particle positions in 3D. The resulting model has 4 dimensions: 3 spatial and 1 temporal (as a function of dose). The motion can usually be modeled with sparser temporal resolution since all the fast per-tilt movement is already taken care by the image warp model. Having a spatial Z dimension of at least 2 is necessary to model shearing. As with image warp, the optimal resolution depends on the available overall signal. However, it doesn't need to be as fine as image warp. Something like 2x2x2x10 might suffice. If your images are rectangular and you want the model to reflect that, remember that this is the tomogram reference frame where the tilt axis is aligned with the Y axis. It means that 6000x4000 px images with a tilt axis angle close to 90\u00b0 or 270\u00b0 will need e.g. a 2x3 model.</p> <p>Tilt movies (tilt series only): If you used Warp in all of the pre-processing steps, M can go back all the way to the original tilt movies and optimize their frame alignment using the same high-resolution references. This procedure usually takes a significant amount of time. Once the refinement of a tilt movie is finished, an average tilt image will be saved in the average subfolder of the old Warp project directory, overwriting Warp's previous result. Please note that M currently doesn't back up the previous version. If something goes wrong and you'd like to go back, please either back up the old images and movie metadata manually, or re-process the tilt movies with Warp.</p> <p>Particle positions/angles: This is the conventional particle pose optimization, except you're also fitting rotation and translation tracks if you set the species' temporal resolution to be higher than 1.</p>"},{"location":"user_guide/m/quick_start_m/#ctf","title":"CTF","text":"<p>Batch size: M pre-multiplies the particles by their CTF before cropping them to a smaller box for refinement. This has no speed disadvantages for geometry refinement. However, since the CTF must change during CTF refinement, the particles must be constantly re-extracted, pre-multiplied and cropped \u2013 which is computationally expensive. This is done in mini-batches to keep the memory footprint small. Decrease the batch size if you run out of GPU memory. Increase it if you have plenty of GPU memory to gain a bit of speed, but probably not more than half of the average per-series particle count.</p> <p>Use species with at least N \u00c5 resolution: Reference-based CTF refinement requires relatively high resolution to be successful. If you have multiple species with different resolution, this parameter determines which of them will be considered during CTF refinement. For tilt series, the minimum resolution can be a bit lower, e.g. 7 A, whereas frame series with small particles require higher resolution, e.g. 4 A.</p> <p>Defocus: For frame series, defocus refinement establishes per-particle defocus values, and per-series astigmatism with a spatial resolution of 3x3. For tilt series, defocus refinement finds per-tilt defocus and astigmatism values.</p> <p>Grid search in 1st iteration: Gradient descent optimization will fail when the defocus is too far off because of the oscillating nature of the CTF. Instead, a broader, exhaustive search can be performed in the first sub-iteration.</p> <p>Phase shift: If you acquired the data with a Volta phase plate, the phase shift of the CTF will likely be different in each micrograph. Enable this to optimize a single phase shift value for each frame series, or a per-tilt phase shift model for each tilt series.</p> <p>Pixel size: The effect of the pixel size on the CTF is correlated with that of Cs and acceleration voltage. Thus, given that we don't have very accurate absolute values for either of those, we can't arrive at the correct absolute pixel size by refining the CTF model against the data. However, to make the CTF fit better, it is enough to adjust either of the variables relatively to its assumed value. M can refine per-series Cs as a substitute for the pixel size. Because the CTF model changes during this refinement, it is quite slow.</p> <p>Odd Zernike orders: Zernike polynomials of odd orders describe anti-symmetric aberrations. They don't affect the CTF and can thus be refined quickly together with the geometry. 3rd-order polynomials model beam tilt and trefoil. Probably doesn't make sense at resolutions worse than 4 A, unless the microscope is very poorly aligned.</p> <p>Even Zernike orders: Zernike polynomials of even orders affect the CTF and are thus quite slow to refine in M. The refinement is done per-series, so you need a high particle density to get enough signal. This will be handled in a smarter way in the future.</p> <p>CTF refinement: Once your species reach a high enough resolution, you can refine parameters of the contrast transfer function. A resolution of at least 6\u20137 A is recommended for this. Since not all species may reach the same high resolution, you can specify a threshold to Use species with at least x A resolution.</p> <p>Defocus and astigmatism: For frame series, this will refine the defocus values per-particle, as well as one common set of astigmatism parameters. In tilt series, the relative Z offsets between particles are known with a higher precision than could be obtained through defocus refinement. However, defocus and astigmatism can change in each tilt. M optimizes a global defocus offset and astigmatism per-tilt in that case.</p>"},{"location":"user_guide/m/quick_start_m/#changing-model-resolution-between-refinement-iterations","title":"Changing model resolution between refinement iterations","text":"<p>M performs a gradient descent-like optimization to cope with the multitude of parameters in a multi-particle refinement. This means that it is much more likely to get stuck in a local optimum if the global optimum is too far away. Starting refinement using RELION's globally refined poses and at relatively low resolution helps with that. However, if you decide to change the resolution of the image or volume warp models, resampling the model can put some parameters too far away from their optima for the latter to be reached. You should at least set the refinement resolution to be lower in the first sub-iteration, e.g. 70 %. It can also be helpful to ignore the results obtained with the previous models and just restart refinement from the very first iteration. To do so, overwrite the frame or tilt series metadata (located in the same folder as the raw data) as well as the species files with their first versions. The latter can be found in the versions subfolder of the respective data source and species directories. You can also do this with any other previous version if you want. Sorry for the inconvenience \u2013 M's UI will offer a better mechanism in the future.</p>"},{"location":"user_guide/m/quick_start_m/#memory-considerations","title":"Memory considerations","text":"<p>Because M needs to hold all particle images in memory at the same time when refining a frame or tilt series, the memory footprint can become quite large if you have a lot of particles per item and/or high resolution. To address this, M stores these images in \" pinned\" CPU memory, which the GPU can directly access. Unfortunately, the actual available amount of pinned memory is usually far lower than the overall memory capacity, and the exact amount is still a bit of a mystery to us. For instance, on a system with 128 GB RAM, ca. 20 GB can be used as pinned memory by M in our experience. On multi-GPU systems, M will schedule the processing of individual items such that the simultaneous pressure on pinned memory does not exceed an empirically determined limit. This can lead to some GPUs staying idle temporarily while there is not enough memory. If a single item requires more memory than the limit, M will try to process it anyway and may crash. If there are only a few of such densely populated items and they are not critical to the overall project, you can try removing them from the data source's .source file.</p> <p>Meanwhile, GPU memory is used to store reference volumes for all species, the raw frame or tilt data, as well as buffers and FFT plans for fast pre-processing of small batches of particle images. Reconstruction volumes are loaded into GPU memory one species at a time at the end of an item's refinement, and transferred back to (unpinned) CPU memory once back-projection is finished. Unless you have lots of high-resolution species, cards with 12 GB of memory should be fine.</p> <p>We are working on making use of free GPU memory as a substitute for some of the pinned CPU memory. However, multi-particle refinements will likely remain resource-intensive in the near future.</p>"},{"location":"user_guide/m/quick_start_m/#making-sense-of-the-results","title":"Making sense of the results","text":"<p>All refined species maps are contained in the species/[species ID] subfolders inside the population directory. The species IDs are very cryptic to make them unique regardless of the names, but the maps include the species name you provided. The most useful maps are likely the two half1 and half2 half-maps, the filtered and sharpened filtsharp map (equivalent to the output from RELION's post-processing), the denoised map, as well as the local resolution values contained in the localres volume. The current global resolution and B-factor used for sharpening are contained in the .species XML file.</p> <p>If the resolution of your map has far surpassed that of the map you used to prepare the initial mask and you think the latter looks too blobby, you can use e.g. M's denoised map to prepare a new mask using relion_mask_create, and sneak that updated mask into the next refinement iteration by replacing the [species name]_mask.mrc file with it. Please make sure it has the same pixel size as the rest of that species' maps.</p>"},{"location":"user_guide/warp/eer/","title":"EER handling","text":"<p>Rudimentary support for Thermo Fisher Scientific's Electron Event Registration (EER) format is implemented in Warp &amp; M <code>&gt;=1.0.9</code>.  EER supports very fine exposure fractionation, which can be subjected to in silico exposure grouping later when the data are processed.  EER's compression efficiency is similar to TIFF.</p> <p>EER is available as input format in Warp.  When selected, a new setting will appear in the UI: EER frame group.  This determines how many consecutive frames will be summed up without taking into account any alignment when an EER frame series is read.  Set a smaller value if you expect fast motion at the beginning of an exposure, e.g. because you're collecting on a tilted sample.  If the overall number of frames isn't divisible by the group size, the last incomplete group will be dropped.</p> <p>The Exposure setting in Warp refers to the cumulative exposure of 1 group of frames, i.e. you will likely need to adjust it if you change the group size.  Please note that the group size currently can't be changed for M's processing later.  M also doesn't implement any optimizations for finely fractionated data yet, so if you set the group size too small, you might run out of memory.</p> <p>EER files are currently presumed to originate from a Falcon 4 detector, which has a physical size of <code>4096</code>x<code>4096</code> px.  The acquisition software calculates non-integer centroid coordinates for every electron event, which the format preserves in up to 4x super-resolution.  In Warp, the size of the gain reference determines whether the super-resolution information is used. If you provide a 8192x8192 px gain reference, the EER data will be rendered in 2x super-resolution; 16384x16384 px will result in 4x super-resolution; a 4096x4096 px gain reference turns off super-resolution rendering.</p>"},{"location":"user_guide/warp/quick_start_warp_frame_series/","title":"Quick Start: Frame Series","text":"<p>This quick introduction can help you start processing frame series data (2D movies) with Warp right away, without diving into details.</p>"},{"location":"user_guide/warp/quick_start_warp_frame_series/#to-the-microscopes-ready-go","title":"To the microscopes, ready, go!","text":"<p>Load your favorite sample into the microscope and start collecting data. For counting data from K2/3 and Falcon III detectors, we highly recommend saving the movies as gain-uncorrected, compressed TIFF files. This will make sure a typical SPA movie with 40 frames doesn't take up more than 200 MB and you don't need to purchase a new file server every now and then. If you're using SerialEM or other software with native TIFF support, this can be done with a few clicks. If you're using EPU, our Stacker v2 tool will help you.</p> <p>If you don't have access to a microscope right now, grab a data set from EMPIAR, e.g. 10153. This tutorial will use EMPIAR-10153 for all of its screenshots.</p>"},{"location":"user_guide/warp/quick_start_warp_frame_series/#launch-warp-and-get-comfortable","title":"Launch Warp and get comfortable","text":"<p>Once a steady influx of movies is ensured, you can launch Warp. Just go to the installation directory and execute Warp.exe. The first launch can take a bit longer \u2013 please be patient.</p> <p>If you don't see the settings panel on the left side, click the small triangle to expand it. Collapsing the settings panel will merge the Fourier and Real Space tabs \u2013 you may find this mode more convenient for manually screening the processing results.</p> <p></p> <p>If you're a vampire, click the \ud83d\udd04 button in the window bar to change to a dark UI theme. We won't judge \ud83e\udddb</p> <p></p>"},{"location":"user_guide/warp/quick_start_warp_frame_series/#setup","title":"Setup","text":""},{"location":"user_guide/warp/quick_start_warp_frame_series/#input-parameters","title":"Input parameters","text":"<p>First, you need to tell Warp where to look for data, and what basic input parameters to expect. These settings are located in the left part of the window under Input.</p> <p>Click Select folder\u2026 and select the location of your movies. Warp will not look for files recursively in sub-folders, so all files must be located on the top level. Next, click .mrc (the extension may be different if you've already used Warp) to specify the file format. If you're working with a header-less format (or any format Warp doesn't recognize yet), select the DAT option, and specify the frame dimensions, data type and an optional offset at the beginning of the files. Only the .dat extension is supported for the file names, but you can use any header-less format by renaming them.</p> <p>Set the pixel size in the X and Y dimensions to match your raw, unbinned data. If you haven't determined the magnification anisotropy for your microscope, both numbers will be the same. The anisotropy angle specifies the anti-clockwise rotation of this X/Y coordinate system.</p> <p>Especially if you're acquiring in super-resolution mode on a K2, you might want to bin the data before they are processed. We don't think the processing overhead for super-resolution data is worth the small gain in signal, but you are free to experiment \ud83d\ude09 Warp can use any positive rational binning factor. The frames will then be Fourier-cropped to Size / 2^n.</p> <p>If you enter any non-zero electron dose value, frames will be weighted in all operations that produce averages, e.g. aligned movie or particle averages. The weighting is implemented as a B-factor of \u20134\u22c5Dose \u00c5\u00b2. Please don't forget to convert the dose value to the correct units.</p> <p></p> <p>Following the best practice of storing counting data as gain-uncorrected integer values, you need to tell Warp how to perform gain correction on-the-fly. Click Select reference\u2026 and choose an MRC file. Please make sure the gain reference matches the data. In case of EER data, the size of the gain reference also determines the super-resolution \u2013 check the EER page for details. Warp will tell you if the dimensions don't match (e.g. if it needs to be transposed), but it can't detect if the reference is flipped in X or Y. If you're not sure, try processing a movie without motion correction and check whether the average contains a visible gain pattern. Repeat the procedure with different combinations of Flip X/Y axis until the pattern disappears.</p> <p>Some camera sensors have small defective regions that can't be corrected using a gain reference. They won't affect alignments if they're small, but can be annoying, especially in tomography. Warp can use a defect map to fill those regions with the average value of their surroundings. The defect map must have the same dimensions as the gain reference, and contain pixel values = 1 in the defect regions and = 0 everywhere else. The same flip X/Y and transpose operations will apply to the gain reference and defect map. Alternatively, you can have Warp create the defect map image based on a text description of rectangular regions. To do this, click Select defect map, change the file filter to * .txt, and select the text file. In this file, every line should describe a rectangle in the following format: <code>[bottom left corner X] [bottom left corner Y] [width] [height]</code></p> <p>The X and Y coordinates start with 0, not 1. The columns are separated by spaces or tabs. For instance,</p> <p><code>0 3709 3838 1</code> will mask the top-most row of a 3838\u00d73710 px sensor. Once the file is loaded, Warp will generate the defect map image and save it under <code>project directory/defectmap/defects.tif</code> and automatically change the file path. Please check this image to make sure the mask is correct. For future projects using data from the same sensor, you can just reuse this TIFF file.</p>"},{"location":"user_guide/warp/quick_start_warp_frame_series/#ctf-fitting-options","title":"CTF fitting options","text":"<p>The number of parameters for CTF fitting can be scary at first. Good news: You need to set many of them only once for your microscope!</p> <p></p> <ul> <li> <p>Window: Specifies the size of the power spectrum. If you expect only low defocus   values or need highly localized defocus values, leave the window small, e.g., 512 px.</p> </li> <li> <p>Range: Specifies the spatial frequencies used for fitting. It is usually best to   ignore the lowest frequencies. If you specify a defocus model without spatial   resolution (see next section), you can set the maximum range to 1.0. If you are   fitting a highly resolved model, keep the maximum value lower to prevent overfitting.</p> </li> <li> <p>Use Movie Sum: In some cases (e.g., very low dose images) the fitting will work   better if the power spectrum is created from the aligned movie average instead of the   per-frame power spectra \u2013 check this option to do that.</p> </li> <li> <p>Voltage and C<sub>S</sub>: Values specific to your microscope model. A Titan Krios   is usually operated at 300 kV, and C<sub>S</sub> is 2.7 mm in most modes.</p> </li> <li> <p>C<sub>C</sub>, Illumination Aperture, and \u0394E: Currently not used, but might become   relevant in future versions of Warp. Just leave the defaults for now.</p> </li> <li> <p>Amplitude: Defines the fraction of amplitude contrast in the CTF. Commonly used   values for cryo data are 0.07 and 0.10, while negative stain data are often fitted   with 0.20.</p> </li> <li> <p>Defocus spread: Defines the range of defocus values for the initial exhaustive   search. Set both values to match the range specified in your acquisition software with   a bit of a margin.</p> </li> <li> <p>Phase Shift: When dealing with data acquired with a phase plate, check this to fit   that parameter as well.</p> </li> <li> <p>Mode Ice Ring: An experimental feature that will attempt to model the CTF around   the 3.6 \u00c5 amorphous ice ring separately from the rest of the power spectrum.</p> </li> </ul> <p>Range parameters optimization: The easiest way to optimize them for a new data set is to switch to the Fourier Space tab and click Process Only This Item's CTF. This will skip all the other processing steps and just fit the CTF for the currently selected movie. The fitting range is visualized as a grey rectangle in the 1D power spectrum plot.</p> <p></p> <p></p> <p>CTF Model Resolution: Defined further below in the Models panel. The first two values define the spatial resolution, i.e., how locally the defocus will be estimated. 5x5 is usually a good value for a 4K micrograph at 1.0\u20131.3 \u00c5/px. The third parameter defines the temporal resolution. Please note that a temporal resolution higher than 1 leads to a vastly increased memory footprint during processing, while probably not improving the final resolution in most cases.</p>"},{"location":"user_guide/warp/quick_start_warp_frame_series/#motion-fitting-options","title":"Motion fitting options","text":"<ul> <li> <p>Global and local motion estimation: Considers the specified range of spatial   frequencies and weights their importance according to the B-factor. The default range   of 0.05\u20130.25 is usually ok for data with 1.00\u20131.35 \u00c5/px. The more negative the   B-factor, the less the higher spatial frequencies will be considered.</p> </li> <li> <p>Motion model parameters: The first two parameters describe the spatial resolution,   and the third describes the temporal resolution. The spatial resolution will be   considered in fitting the local beam-induced motion, while the full specified temporal   resolution will be used for fitting the global motion.</p> </li> </ul>"},{"location":"user_guide/warp/quick_start_warp_frame_series/#particle-picking-options","title":"Particle picking options","text":"<p>Warp employs BoxNet, a deep convolutional neural network, for particle picking and maintains a central database of training data that any user can contribute to. As new examples are added, the BoxNet model is constantly re-trained using all available data. In addition to this, BoxNet can be re-trained locally on any data you would like to pick more specifically. Thus, while the concept of sample-specific templates does not exist with BoxNet, you can maintain multiple pre-trained models for different samples. More information on how to re-train BoxNet can be found here.</p> <p></p> <p>Click Select BoxNet model... to open a list of available models. All models contained in [WarpInstallationDirectory]/boxnet2models/ are enumerated here. If you just installed Warp recently, the list of official BoxNet models pre-trained only on the public dataset should be up-to-date. If your installation is a bit older, click Browse Public Repository to download the latest versions. After downloading new models, please re-open the model selection window to see the changes. Once a model is selected, click Use ( or follow the re-training guide).</p> <p>There are 2 types of official BoxNet models: One follows the BoxNet2_ naming scheme and can only distinguish between background and particles. Another is called BoxNet2Mask_ and can distinguish between background, particles, and high-contrast artifacts, e.g., ethane drops. Knowing the exact location of such artifacts allows dismissing particles located too close to them.</p> <p></p> <p>The Diameter setting controls how close two particles can be together before the particle with lower probability is dismissed from the picks. The Data Type determines whether the sign of the data is flipped before picking (negative stain), or not (cryo). A Minimum Score threshold is applied to BoxNet's predictions. When using a model specifically pre-trained on the current protein species, the score can be typically left at its default value of 0.95. Picking new species with the generic version can sometimes require lower threshold values to pick up everything.</p> <p>If you're using a BoxNet version that can create masks, you can enforce a Minimum Distance between particles borders (as defined by their diameter) and \ud83d\udce9.</p> <p>The picked particles can be extracted immediately after the picking, which is especially useful for real-time processing. For that, the Box Size must be set \u2013 ca. 150 % of the particle diameter is recommended to avoid interpolation artifacts later. The pixel size is fixed to that used for the entire pre-processing pipeline. If you want to extract particles with a different pixel size, you can do so later using one of the Task Dialogs. Cryo data need to be inverted upon extraction. For SPA packages that require particles to be pre-normalized, e.g., RELION, the diameter used for picking will also be used for * background normalization*.</p>"},{"location":"user_guide/warp/quick_start_warp_frame_series/#output-options","title":"Output options","text":"<p>The first few frames in a movie suffer especially badly from beam-induced motion and can usually be discarded by adjusting the output frame range. This setting will also be respected in all other operations that deal with frames, e.g., particle extraction.</p> <p>In addition to extracted particles, there are 2 output types for 2D movies:</p> <ul> <li>Average: You will almost always want to produce an average to inspect the   micrographs visually. You can also use other tools to extract particles from them if   you don't want to use Warp for that.</li> <li>Aligned Stack: Some workflows \u2013 RELION pre-3.0 particle polishing in particular \u2013   rely on pre-aligned movies as input. Please note that aligned movies are very large   and will create significant storage and processing overhead. To save some space, you   can collapse groups of consecutive frames into one.</li> </ul>"},{"location":"user_guide/warp/quick_start_warp_frame_series/#processing","title":"Processing","text":""},{"location":"user_guide/warp/quick_start_warp_frame_series/#start-processing","title":"Start processing","text":"<p>You're almost ready to hit that big button! We just need to make sure that all of the GPUs in your system are as ready as you are. Warp will try to use all CUDA-capable Nvidia GPUs available, which might not be a good idea if you have several models with different memory capacity. They are all listed in the window bar together with checkboxes to deselect them. Deselected GPUs will not be used for on-the-fly processing. version's memory requirements.</p> <p>Now hit it! Warp won't stop processing until you manually press Stop Processing. All processing settings and task dialogs are frozen while Warp is in processing mode, but you can still inspect the results, edit the particle positions, and change any filter thresholds.</p> <p></p>"},{"location":"user_guide/warp/quick_start_warp_frame_series/#processing-status","title":"Processing status","text":"<p>As movies are processed, they change their status. Every movie is initially marked as * unprocessed. Once it has passed through the entire pipeline, it is considered * processed. If you change any processing settings, previously processed items will be marked as outdated, i.e., in need of re-processing. If a processed item's quality criteria don't match the current filter thresholds (see section below), it is labeled * *filtered out. Finally, if you deselect an item manually in the navigation bar, it will be colored as deselected. This color scheme is used throughout the navigation bar and the overview tab, except in the astigmatism plot. There, color reflects an item's coordinate on the time axis, going from old to new. Whenever unprocessed or outdated items are present in the current input folder and processing is activated, Warp will send them through the pipeline in alphabetical order.</p>"},{"location":"user_guide/warp/quick_start_warp_frame_series/#inspecting-results","title":"Inspecting results","text":"<p>Once the processing has started, it is best to collapse the settings panel as shown in the beginning of this guide. This will make more room for the overview plots, and merge the Fourier and Real Space tabs so you don't have to constantly switch between them.</p> <p></p> <p>The Overview tab features plots for all estimated parameters. If the dot spacing becomes too dense, use the mouse wheel to zoom into the plots. Each plot features a small histogram on its left side. Click any of the dots to switch to the Fourier &amp; Real Space tab and inspect the corresponding item in more detail.</p> <p></p> <p>There, you will find the Power Spectrum and its CTF Fit, an Average of the aligned movie and the corresponding Local Motion Tracks, the picked Particles and the automatically painted Mask, and the local Defocus Gradient. Some of these elements are hidden by default so they don't clutter up your view.</p> <p>If your GPU has 8+ GB of memory, you can enable Denoising to see more details in the noisy images. Warp comes with a default pre-trained denoising model, but it will likely not be as good as one trained on your specific data set. To retrain the model on your data using the noise2noise method, wait until at least 20\u201330 movies have been processed (up to 128 can be used). Then stop the processing to free up GPU resources. Now click Retrain on this data set next to the Denoise checkbox and proceed through the dialogs. Once training is finished, you can activate the denoising if it isn't active yet, and proceed with the processing. In very rare cases it may be necessary to restart Warp after retraining to avoid crashes. The retrained denoising model will be saved in the project directory and used automatically for this project in the future.</p> <p>Alternatively, you can enable the Deconvolution Filter and adjust it on-the-fly to give your micrographs more contrast. If the latter is too much, you may need to adjust the Intensity Range slider.</p> <p>While in the Fourier &amp; Real Space tab, you can quickly go through your micrographs using the \u2b05\ufe0f and \u27a1\ufe0f keys on the keyboard.</p>"},{"location":"user_guide/warp/quick_start_warp_frame_series/#dealing-with","title":"Dealing with \ud83d\udca9","text":"<p>Even a perfect grid will produce a bad micrograph every now and then. Wouldn't it be great to get rid of them in an objective and automated way?</p> <p></p> <p></p> <p>Some of the parameters established during processing are likely correlated with the data quality: Defocus, astigmatism, phase shift, estimated resolution, average intra-frame motion, number of particles, and the percentage of masked micrograph area. Using the sliders above the plots in the Overview tab, you can define Filter Thresholds for all of them. Whenever you change a threshold, Warp instantly re-applies it to all items. The Astigmatism filter is special because it considers the distance of a movie's astigmatism to the entire data set's mean astigmatism, normalized by its standard deviation. Thus, whenever an item's astigmatism value changes, the entire filter is re-evaluated without an explicit change in the threshold.</p> <p></p> <p>In some rare cases, you may want to overrule the automatic filtering. Each item has a * Manual Selection flag in addition to the filtering. To edit it, switch to the Fourier or Real Space tab. You will find the Navigation Bar at the bottom of the window. There, the currently selected item has a check box next to its name. This check box has 3 different states, which are cycled through by repeatedly clicking it: [\u2013] ( default) leaves the inclusion/exclusion to the automatic filters; [\u2713] forces inclusion regardless of filters; [   ] forces exclusion regardless of filters. Alternatively, you can press F* on the keyboard to change the current item's selection.</p>"},{"location":"user_guide/warp/quick_start_warp_frame_series/#plugging-warp-into-other-tools","title":"\ud83d\udd0c Plugging Warp into other tools","text":"<p>Now that Warp is running and providing you with lots of insights into your ongoing data collection, what's next?</p> <p>If you set up Warp to pick particles on-the-fly using BoxNet, it will create and continuously update two files in the input folder: allparticles_BoxNetName.star and goodparticles_BoxNetName.star. The former contains absolutely all particles picking with the respective BoxNet model so far, while the latter only contains particles from micrographs that match the current filter thresholds. Whenever you change the filter parameters, the goodparticles file will be updated the next time Warp is done processing a movie.</p> <p>cryoSPARC is our favorite tool for processing Warp's on-the-fly results because of its speed and transparent handling of constantly changing data sources.</p> <p></p> <p>Create a new data source for your project and select <code>goodparticles_BoxNetName.star</code> in Warp's input folder as cryoSPARC's Meta Data File. Set the other data set parameters as usual. That's it! Now, whenever you create a new job with the full data source as input (i.e., not using the output of a previous job as input), cryoSPARC will read the most current version of the STAR file, load all new particles into its local cache, and use them for processing.</p> <p></p> <p>At the beginning of a data collection session, we like to start 2D Classification jobs every 30 minutes. If the data are good, well-defined classes should appear soon. After a few hours, we employ Ab Initio jobs to bootstrap the 3D classification and, once we have good classes, 3D Refinement. This way, it usually becomes clear after only a few hours of data collection if it's worth continuing, or if a different sample should be loaded into the microscope instead.</p> <p>Warp's STAR files are also fully compatible with RELION. While its current processing speed makes for a less responsive on-the-fly workflow, we usually employ it once data collection is over to classify and refine the data further.</p>"},{"location":"user_guide/warp/quick_start_warp_tilt_series/","title":"Quick Start: Tilt Series","text":"<p>Tilt series pre-processing in Warp will allow you to reach higher resolution for your sub-tomogram averages. However, unlike the pipeline for 2D data, the tilt series pipeline still has a few gaps. You will have to switch to IMOD to perform the initial tilt series alignment (using patch tracking or gold fiducials). There is also no BoxNet-enabled on-the-fly particle picking yet, and you will have to use a rather slow template matching routine in offline mode. Metadata import is supported only for SerialEM currently. We intend to address these shortcomings in the near future.</p> <p>We will use data from EMPIAR-10164 in the screenshots below \u2013 in particular, the 5 tomograms used in Turonova et al. 2017.</p>"},{"location":"user_guide/warp/quick_start_warp_tilt_series/#tilt-movie-pre-processing","title":"Tilt movie pre-processing","text":"<p>The first step towards tilt series pre-processing in Warp is pre-processing the individual tilt movies in 2D mode. If you\u2019re not familiar with that procedure or Warp\u2019s basic interface features yet, please follow the 2D quick start guide. Here are some important differences to traditional 2D movie processing for this step:</p> <ul> <li>The motion model shouldn\u2019t have spatial resolution, as there is usually not enough   signal in a single tilt movie average for such fine alignment. Thus, the grid   resolution will be 1x1xN. A good value for N is the number of frames in the shortest   movie in case you\u2019re using a collection scheme that increases the dose (and thus the   movie duration) at higher tilts. If you\u2019re fractionating the dose in very fine steps   and collecting with a small pixel size, N can be lower than the frame count to avoid   overfitting.</li> <li>If you already processed the data with a different pipeline and don\u2019t want to repeat   the tilt series alignments because the raw 2D movie alignments would change (e.g.,   compared to MotionCor2), you can also reuse those pre-aligned averages. Just   pre-process them instead of the movies. Obviously, the movement processing can be   turned off. Warp will estimate the CTF and generate averages, which are an exact copy   of the input images. This will feel very redundant, but the pipeline was written with   movies in mind and doesn\u2019t have a special case for single-frame images.</li> <li>The CTF can usually be estimated well with a 2x2x1 defocus grid. You can use these   estimates to monitor data collection. However, the values will be re-estimated later   during tilt series pre-processing using a more robust model. Because of the low amount   of signal per tilt movie, it might help to check Use Movie Sum.</li> <li>Particle positions obtained with BoxNet won\u2019t be considered later. However, the masks   will be. In tilt series mode, those are assumed to cover gold beads and other   high-contrast artifacts, and will be used to fill image areas with uncorrelated noise.   You can quickly retrain BoxNet to mask out   gold beads and not pick any particles. We would like to offer a pre-trained model for   this purpose, but currently lack the training data. If you think such a model would be   useful, please   consider contributing training data!</li> </ul> <p></p>"},{"location":"user_guide/warp/quick_start_warp_tilt_series/#export-tilt-series-stacks-for-imod","title":"Export tilt series stacks for IMOD","text":"<p>IMOD\u2019s etomo requires each tilt series to be assembled in a single MRC stack. You can use Warp to combine the previously generated tilt movie averages into such stacks.</p> <p>Switch Warp to tilt series mode by selecting TomoSTAR as the Input format. We haven\u2019t created any TomoSTAR files yet, but this mode will allow us to generate the data necessary for tilt series alignment in etomo, which will eventually allow us to create TomoSTAR files.</p> <p></p> <p>Once in tilt series mode, the Overview tab will contain the Import tilt series from IMOD button. Click it to bring up the task dialog. Specify the folders containing the mdoc files generated by SerialEM, and the original tilt movies. If there are multiple mdoc files per tilt series (e.g. \"plus\" and \"minus\" after bi-directional collection), you can specify several suffixes. Once these settings are set, all tilt series should appear with the correct number of tilts in the list on the right. Individual series can be deselected using the checkboxes next to their names. Click the Create stacks for IMOD button to generate the stacks. This will create an imod folder in the current project directory, and place each stack in a sub-folder named after the respective tilt series. You can now execute etomo in each of these folders to perform alignments. Please note that it isn't necessary to generate an aligned stack or reconstruct tomograms in etomo, other than for diagnostic purposes. You can use manual deselection in Warp's 2D pre-processing mode to remove individual tilt images from the stack. Please remember to reflect these changes when setting up the project in etomo.</p> <p>You can also generate TomoSTAR files without any alignments at this point by clicking the Import button. Please refer to the next section for information on how to specify the electron dose.</p> <p></p>"},{"location":"user_guide/warp/quick_start_warp_tilt_series/#create-tomostar-files-from-imods-results","title":"Create TomoSTAR files from IMOD's results","text":"<p>If you closed the Import tilt series from IMOD dialog from the previous section, open it again. Specify the mdoc and original tilt movie folders, and the * suffixes (if applicable) as before. For the Root folder with IMOD processing results, select the imod subfolder created previously. If you didn't use Warp to set up the folder structure as suggested in the previous section, make sure the alignment results are located in [project folder]/imod/[tilt series name]/. Warp will try to find the xf and taSolution.log files there. Please note that IMOD's pre-tilt correction (\"Tomogram positioning\" tab in etomo) is currently not supported and shouldn't be used if you want the results to match between IMOD and Warp. If everything has been parsed correctly, the Aligned* checkboxes should become checked.</p> <p>SUPER IMPORTANT HANDEDNESS NOTE: Warp has a different convention for tilt angles and handedness compared to IMOD. By default, the tilt angles will be multiplied by -1 upon import to match IMOD's 3D reconstruction handedness. You can turn off this behavior by checking Don't invert tilt angles. Now that the map handedness is correct, there is still the defocus handedness to take care of. Although SerialEM is usually calibrated to produce the correct map handedness in IMOD's 3D reconstructions, the defocus convention has about a 50:50 chance of being wrong across labs in our experience. Processing data with the wrong handedness calibration will limit the resolution achievable for your sub-tomogram averages. That would be a real pity! Luckily, Warp includes an easy way to check if the calibration is wrong: Estimate the CTF for the raw tilt movies with a 2\u00d72 spatial resolution, then initialize and import the tilt series as described in this guide, estimate the CTF for the entire tilt series, and click Check tilt handedness in the Fourier Space tab. A dialog will appear to tell you the result and its certainty. -1 means certainly wrong, +1 means certainly correct. Values closer to 0 may arise because the raw tilt movie CTF estimates were off due to weak signal. If the value is too close to 0, you may want to try several tilt series and average the result to be sure. If it turns out your defocus handedness is wrong, Warp will offer you to flip the angles used for defocus calculation. This will change the AreAnglesInverted field in the tilt series XML metadata. It is best to do this check and possible flipping before you process the data any further.</p> <p></p> <p>Specify the same Pixel size you used in IMOD. Warp will use it to convert the shifts to \u00c5ngstr\u00f6m. For the electron dose, there are two options: SerialEM, when calibrated accordingly, can store the dose values in the original mdoc files. If the calibration is off or hasn't been done at all, you can specify a non-zero value in the Default dose per tilt field. There is currently no option to conveniently specify varying dose values. In case of dose-symmetric collection, it is usually OK to just use the per-tilt dose of the very first tilt images for all tilts, since the higher tilts won't contribute much information to high-resolution 3D averages anyway. If you absolutely need to specify varying dose values, you will have to edit the wrpDose column in the TomoSTAR files later.</p> <p>That's it! Click Import to create the files and start processing them in Warp.</p> <p></p>"},{"location":"user_guide/warp/quick_start_warp_tilt_series/#tilt-series-pre-processing","title":"Tilt series pre-processing","text":"<p>You will notice the Input section gained a new parameter: Unbinned tomogram dimensions. The X and Y dimensions are usually similar to the input image size. Note that for non-square sensors like the K3 the dimensions should reflect the sensor shape if you don't want to lose data. However, the tomographic volume and raw image coordinate systems are related to each other through the tilt axis angle. Often, the tilt axis is close to the X axis in the raw images, while in the tomogram it is always assumed to be aligned with the Y axis. Thus, if the raw image dimensions are 6000x4000 and the tilt axis angle is around 90\u00b0 or 270\u00b0, the tomogram dimensions should be 4000x6000. The Z dimension depends on the sample thickness. You might have to do a few test reconstructions (in Warp or IMOD) to figure out the right value. Ideally, the tomogram should be thicker than the sample to allow for artifact-free template matching at its borders. Choose these dimensions wisely: Once things like particle positions have been established, changing the dimensions will invalidate those positions and will need to either adjust the values by hand or start from scratch.</p> <p>The Bin parameter has a somewhat different use in Warp compared to IMOD. First, it is defined as an exponent, i.e. downsampling factor = 2^binning (the UI will tell you the result), while in IMOD it is directly the downsampling factor. Second, there are multiple places where binning can be set. The value defined in the Input section will be used when loading the data, i.e. this is the maximum resolution any subsequent operations on the data will be able to use. However, task dialogs like Tomogram reconstruction or Sub-tomogram export allow to set their own target pixel size, which will bin the data additionally if it is larger (and it can't be smaller) than the initial binned pixel size. Thus, you should only set the initial **Bin ** parameter if you know that you will never need to go to a lower pixel size \u2013 for example, if you start with super-resolution data that need to be binned once to get to the physical pixel size. Changing this value later will invalidate every already pre-processed item.</p> <p>The only pre-processing operation implemented for tilt series at the moment is CTF estimation. Warp will estimate the defocus and astigmatism for the entire tilt series while taking the tilt angles as constraints into account. The settings are the same as in the 2D case, except for a lack of model resolution. Since all the information about the Z position of objects in the tomogram will come from the tomogram itself, only a global defocus offset is needed for each tilt. Additionally, because the sample rarely lies flat in the focal plane, a global pre-tilt orientation is fitted for the entire tilt series.</p> <p>Once all items have been pre-processed, the quality filters work the same way they do in 2D mode. There is currently no real space view implemented for tilt series data \u2013 the Fourier space tab is the only place where you will find useful per-item information.</p>"},{"location":"user_guide/warp/boxnet/retraining/","title":"Re-Training","text":"<p>BoxNet hasn't seen every sample (yet). While its out-of-the-box performance is better than other unbiased and template-based methods in most cases, it probably isn't as good as manual picking. Good news: You can teach it to be better! Here is how:</p> <p>First, pick some micrographs with one of the generic BoxNets. Depending on particle density and pixel size, anywhere between 3 and 20 micrographs is a good start.</p> <p>Go through the results manually in the Real Space View tab and remove False Positives or add New Particles using the mouse. When you remove a particle, it is automatically saved in a separate [Micrograph name]_[suffix]_falsepositives.star file. You can use these positions to up-weight certain areas later. If you hold Shift ** while removing particles, they won\u2019t be added to the falsepositives file. When adding new particles, please make sure they are centered well**. If some of the automatically picked particles are off-center, it is best to improve their positions by dragging them with the mouse instead of removing and recreating them.</p> <p>Wrong labels can be tolerated to a certain degree, but the accuracy of your model will absolutely depend on the quality of the training data you provide. Try to make sure each micrograph is picked completely, since everything not labeled as a particle is labeled as background during training.</p> <p>If you intend to train a BoxNet that also creates masks, it is best to already use it for the initial picking. In addition to cleaning up the particle positions, you will also have to manually paint the masks where needed.</p> <p>If you clean up only a fraction of the picked items, you need to copy the corresponding STAR files to a separate folder \u2013 otherwise, all picked items will be used for training. All picking results are saved in [Input folder]/matching. It doesn\u2019t matter where you put the separate folder, but it is convenient to make it [Input folder] /matching/training.</p> <p></p> <p>Now go to the BoxNet selection menu, select the model used for the initial picking, and click Retrain.</p> <p>Give the new model a unique name. If you\u2019re using a masking BoxNet, it\u2019s best to keep a \u201cMask\u201d in the name. Following the machine learning community\u2019s tradition, we like to name the new models [Something]Net. Just don\u2019t keep the name identical to the previous model, and don\u2019t use special characters.</p> <p>For the Positive Examples, select one of the cleaned up STAR files. Warp will automatically determine its suffix and match all the other files. The same goes for * Extra Important and Uncertain* locations. There won\u2019t be much value in up- or down-weighting locations the first time you re-train a generic BoxNet since you don\u2019t know yet which areas might be causing trouble. Consider using Extra Important if the first re-training doesn\u2019t provide good results.</p> <p>The Particle Diameter will determine the area around each particle\u2019s center that is labeled as particle for training. If your sample is highly heterogeneous in size, don\u2019t worry \u2013 this value doesn\u2019t need to be exact.</p> <p>Using the Public Data Set for re-training will dilute your new examples in a 1:1 ratio with examples contained in [Warp directory]/boxnet2training. This will prevent overfitting BoxNet on very few examples and is recommended. You may want to visit the training data repository to download the latest version.</p> <p>To Train Masking, it is highly recommended to re-train a BoxNet with masking ability (i.e., one containing \u201cMask\u201d in its name). Vice versa, re-training a masking BoxNet without providing masks for all training micrographs will lead to bad results. The masks will be automatically taken from [Input folder]/mask.</p> <p></p> <p>Once everything is set up, click Start Training. Warp will first prepare the new examples, load the old examples from disk (if it crashes at this point due to memory shortage, try removing some of the old examples from [Warp directory] /boxnet2training), and finally commence training.</p> <p>During training, two curves (one if you don\u2019t use the public data set) are displayed. The Loss \u2013 New Examples shows the current model\u2019s performance on the new examples, and Loss \u2013 Old Examples shows the same model\u2019s performance on the public data set. Over time, the loss metric for the new examples should decrease and approach that for the old examples. Meanwhile, the loss for the old examples should oscillate around the same level. It is very well possible that the loss for the new examples never reaches the old examples benchmark. This depends highly on the difficulty of your data and the quality of the labels you create (you may find the new model labels the mislabeled positions correctly, but this counts toward the loss during training). The difference between the start and end points of the new examples curve is more indicative of how much better the re-trained BoxNet model will perform on the new data.</p> <p>Once the training is finished, click Close. The new model should now be listed next to the old ones, and you can select it. Test the performance on some micrographs that haven\u2019t been used in training. If you still think it could do better, add more micrographs to the training data set and re-train again. You may also want to look into which particles the model doesn\u2019t remember, and up-weight them during training if you think they are indeed true positives.</p>"},{"location":"user_guide/warp/boxnet/retraining/#submitting-data-to-the-public-repository","title":"Submitting data to the public repository","text":"<p>Please consider contributing your training data to the public repository! Doing so will benefit all BoxNet users in the long term, hopefully bringing the out-of-the-box performance to human-like levels. You can either directly submit the data used for training your own model \u2013 it is saved as a TIFF file under [Input folder] /boxnet2training \u2013 or use the Export BoxNet Examples task dialog in the Overview tab, which has a very similar interface to the re-training dialog. Read the guidelines on the Data Upload Page and submit your training data!</p>"},{"location":"user_guide/warp/boxnet/using/","title":"Using Warp with BoxNet","text":"<p>Warp employs BoxNet, a deep convolutional neural network, for particle picking and maintains a central database of training data that any user can contribute to. As new examples are added, the BoxNet model is constantly re-trained using all available data. In addition to this, BoxNet can be re-trained locally on any data you would like to pick more specifically. Thus, while the concept of sample-specific templates does not exist with BoxNet, you can maintain multiple pre-trained models for different samples. More information on how to re-train BoxNet can be found here.</p> <p></p> <p>Click Select BoxNet model... to open a list of available models. All models contained in <code>WarpInstallationDirectory/boxnet2models/*</code> are enumerated here. If you just installed Warp recently, the list of official BoxNet models pre-trained only on the public dataset should be up-to-date. If your installation is a bit older, click Browse Public Repository to download the latest versions. After downloading new models, please re-open the model selection window to see the changes. Once a model is selected, click Use ( or follow the re-training guide.</p> <p>There are 2 types of official BoxNet models: One follows the BoxNet2_* naming scheme and can only distinguish between background and particles. Another is called * BoxNet2Mask_** and can distinguish between background, particles, and high-contrast artifacts, e.g., ethane drops. Knowing the exact location of such artifacts allows to dismiss particles located too close to them.</p> <p></p> <p>The Diameter setting controls how close two particles can be together before the particle with lower probability is dismissed from the picks. The Data Type determines whether the sign of the data is flipped before picking (negative stain), or not (cryo). A Minimum Score threshold is applied to BoxNet\u2019s predictions. When using a model specifically pre-trained on the current protein species, the score can be typically left at its default value of 0.95. Picking new species with the generic version can sometimes require lower threshold values to pick up everything.</p> <p>If you\u2019re using a BoxNet version that can create masks, you can enforce a Minimum Distance between particles borders (as defined by their diameter) and \ud83d\udca9.</p> <p>The picked particles can be extracted immediately after the picking, which is especially useful for real-time processing. For that, the Box Size must be set \u2013 ca. 150% of the particle diameter is recommended to avoid interpolation artifacts later. The pixel size is fixed to that used for the entire pre-processing pipeline. If you want to extract particles with a different pixel size, you can do so later using one of the Task Dialogs. Cryo data need to be inverted upon extraction. For SPA packages that require particles to be pre-normalized, e.g., RELION, the diameter used for picking will also be used for * background normalization*.</p>"},{"location":"user_guide/warptools/installation/","title":"Installation","text":""},{"location":"user_guide/warptools/installation/#linux","title":"Linux","text":"<p>We distribute WarpTools as part of a conda package for Warp.</p>"},{"location":"user_guide/warptools/installation/#installing-conda","title":"Installing Conda","text":"<p>If you're new to the conda package manager we recommend installing <code>mambaforge</code>. </p>"},{"location":"user_guide/warptools/installation/#creating-a-conda-environment-and-installing-warp-into-it","title":"Creating a conda environment and installing Warp into it","text":"<p>The following command will create a new environment called <code>warp</code> and install <code>warp</code>and all  dependencies into it.</p> <pre><code>conda create -n warp warp=2.0.0 -c warpem -c nvidia/label/cuda-11.8.0 -c pytorch -c conda-forge\n</code></pre> <p>The environment can then be activated whenever you want to use WarpTools</p> <pre><code>conda activate warp \n</code></pre>"},{"location":"user_guide/warptools/installation/#updating","title":"Updating","text":"<p>To update your installation, run the following command</p> <pre><code>conda update warp -c warpem -c nvidia/label/cuda-11.8.0 -c pytorch -c conda-forge\n</code></pre>"},{"location":"user_guide/warptools/installation/#checking-what-version-you-are-running","title":"Checking what version you are running","text":"<p>To check which version you are running use</p> <pre><code>conda list warp\n</code></pre>"},{"location":"user_guide/warptools/installation/#windows","title":"Windows","text":"<p>We don't currently provide pre-built binaries for WarpTools on Windows.</p>"},{"location":"user_guide/warptools/quick_start_warptools_frame_series/","title":"Quick Start: Frame Series","text":""},{"location":"user_guide/warptools/quick_start_warptools_tilt_series/","title":"Quick Start: Tilt Series","text":"<p>In this guide, you will learn how to process your tilt series data all the way from frames and associated metadata to a nice high resolution map from the command line using WarpTools! \ud83c\udf1f</p> <p>We will be processing 5 tilt series of apoferritin from EMPIAR-10491 as an example in this guide.</p> <p>You should obtain a ~3\u00c5 map from these 5 tilt series following this guide.</p> Goal: A ~3\u00c5 map of apoferritin"},{"location":"user_guide/warptools/quick_start_warptools_tilt_series/#overview","title":"Overview","text":"<ul> <li>frame series preprocessing with WarpTools</li> <li>tilt series preprocessing with WarpTools</li> <li>initial 3D refinement in RELION</li> <li>multi-particle refinement with MTools and MCore</li> </ul>"},{"location":"user_guide/warptools/quick_start_warptools_tilt_series/#pre-calculated-results","title":"Pre-Calculated Results","text":"<p>Pre-calculated results (38GB) are available to download at 10.5281/zenodo.11398168.</p>"},{"location":"user_guide/warptools/quick_start_warptools_tilt_series/#preparation","title":"Preparation","text":""},{"location":"user_guide/warptools/quick_start_warptools_tilt_series/#download-the-data","title":"Download the data","text":"<p>First, let's download the frame series data, mdoc metadata files and the gain reference into an empty directory.</p> <p>only have tilt series stacks?</p> <p>Check our guide on  processing tilt series stacks  to get started!</p> shell script<code>&lt;root_dir&gt;</code><code>frames</code><code>mdoc</code> <pre><code># download the gain reference\nwget \\\n--timestamping \\\n--no-directories \\\n--directory-prefix ./ \\\nftp://ftp.ebi.ac.uk/empiar/world_availability/10491/data/gain_ref.mrc;\n\nfor i in 1 11 17 23 32;\ndo\n    echo \"======================================================\"\n    echo \"================= Downloading TS_${i} ================\"\n    # download the mdoc file\n    wget \\\n    --timestamping \\\n    --no-directories \\\n    --directory-prefix ./mdoc \\\n    ftp://ftp.ebi.ac.uk/empiar/world_availability/10491/data/tiltseries/mdoc/TS_${i}.mrc.mdoc;\n\n    # download the frames\n    wget \\\n    --timestamping \\\n    --no-directories \\\n    --directory-prefix ./frames \\\n    ftp://ftp.ebi.ac.uk/empiar/world_availability/10491/data/tiltseries/data/*-${i}_*.tif;\ndone\n</code></pre> <pre><code>.\n\u251c\u2500\u2500 gain_ref.mrc\n\u251c\u2500\u2500 frames\n\u2514\u2500\u2500 mdoc\n\n2 directories, 1 file    \n</code></pre> <pre><code>./frames\n\u251c\u2500\u2500 2Dvs3D_53-1_00001_-0.0_Jul31_10.36.03.tif\n\u251c\u2500\u2500 2Dvs3D_53-1_00002_2.0_Jul31_10.36.43.tif\n\u251c\u2500\u2500 2Dvs3D_53-1_00003_4.0_Jul31_10.37.23.tif\n\u251c\u2500\u2500 2Dvs3D_53-1_00004_-2.0_Jul31_10.38.06.tif\n\u251c\u2500\u2500 2Dvs3D_53-1_00005_-4.0_Jul31_10.38.47.tif\n\u251c\u2500\u2500 2Dvs3D_53-1_00006_6.0_Jul31_10.39.28.tif\n\u251c\u2500\u2500 2Dvs3D_53-1_00007_8.0_Jul31_10.40.08.tif\n\u251c\u2500\u2500 2Dvs3D_53-1_00008_-6.0_Jul31_10.40.51.tif\n\u251c\u2500\u2500 2Dvs3D_53-1_00009_-8.0_Jul31_10.41.34.tif\n\u251c\u2500\u2500 2Dvs3D_53-1_00010_10.0_Jul31_10.42.16.tif\n\u251c\u2500\u2500 2Dvs3D_53-1_00011_12.0_Jul31_10.42.56.tif\n\u251c\u2500\u2500 2Dvs3D_53-1_00012_-10.0_Jul31_10.43.39.tif\n\u251c\u2500\u2500 2Dvs3D_53-1_00013_-12.0_Jul31_10.44.21.tif\n\u251c\u2500\u2500 2Dvs3D_53-1_00014_14.0_Jul31_10.45.03.tif\n\u251c\u2500\u2500 2Dvs3D_53-1_00015_16.0_Jul31_10.45.51.tif\n\u251c\u2500\u2500 2Dvs3D_53-1_00016_-14.0_Jul31_10.46.47.tif\n\u251c\u2500\u2500 2Dvs3D_53-1_00017_-16.0_Jul31_10.47.29.tif\n\u251c\u2500\u2500 2Dvs3D_53-1_00018_18.0_Jul31_10.48.13.tif\n\u251c\u2500\u2500 2Dvs3D_53-1_00019_20.0_Jul31_10.48.53.tif\n\u251c\u2500\u2500 2Dvs3D_53-1_00020_-18.0_Jul31_10.49.38.tif\n\u251c\u2500\u2500 2Dvs3D_53-1_00021_-20.0_Jul31_10.50.20.tif\n\u251c\u2500\u2500 2Dvs3D_53-1_00022_22.0_Jul31_10.51.04.tif\n\u251c\u2500\u2500 2Dvs3D_53-1_00023_24.0_Jul31_10.51.44.tif\n\u251c\u2500\u2500 2Dvs3D_53-1_00024_-22.0_Jul31_10.52.29.tif\n\u251c\u2500\u2500 2Dvs3D_53-1_00025_-24.0_Jul31_10.53.10.tif\n\u251c\u2500\u2500 2Dvs3D_53-1_00026_26.0_Jul31_10.53.54.tif\n\u251c\u2500\u2500 2Dvs3D_53-1_00027_28.0_Jul31_10.54.34.tif\n\u251c\u2500\u2500 2Dvs3D_53-1_00028_-26.0_Jul31_10.55.20.tif\n\u251c\u2500\u2500 2Dvs3D_53-1_00029_-28.0_Jul31_10.56.01.tif\n\u251c\u2500\u2500 2Dvs3D_53-1_00030_30.0_Jul31_10.56.46.tif\n\u251c\u2500\u2500 2Dvs3D_53-1_00031_32.0_Jul31_10.57.26.tif\n\u251c\u2500\u2500 2Dvs3D_53-1_00032_-30.0_Jul31_10.58.12.tif\n\u251c\u2500\u2500 2Dvs3D_53-1_00033_-32.0_Jul31_10.59.02.tif\n\u251c\u2500\u2500 2Dvs3D_53-1_00034_34.0_Jul31_10.59.47.tif\n\u251c\u2500\u2500 2Dvs3D_53-1_00035_36.0_Jul31_11.00.36.tif\n\u251c\u2500\u2500 2Dvs3D_53-1_00036_-34.0_Jul31_11.01.23.tif\n\u251c\u2500\u2500 2Dvs3D_53-1_00037_-36.0_Jul31_11.02.04.tif\n\u251c\u2500\u2500 2Dvs3D_53-1_00038_38.0_Jul31_11.03.02.tif\n\u251c\u2500\u2500 2Dvs3D_53-1_00039_40.0_Jul31_11.03.42.tif\n\u251c\u2500\u2500 2Dvs3D_53-1_00040_-38.0_Jul31_11.04.30.tif\n\u251c\u2500\u2500 2Dvs3D_53-1_00041_-40.0_Jul31_11.05.12.tif\n\u251c\u2500\u2500 2Dvs3D_53-11_00001_-0.0_Jul31_16.50.54.tif\n\u251c\u2500\u2500 2Dvs3D_53-11_00002_2.0_Jul31_16.51.34.tif\n\u251c\u2500\u2500 2Dvs3D_53-11_00003_4.0_Jul31_16.52.14.tif\n\u251c\u2500\u2500 2Dvs3D_53-11_00004_-2.0_Jul31_16.52.57.tif\n\u251c\u2500\u2500 2Dvs3D_53-11_00005_-4.0_Jul31_16.53.38.tif\n\u251c\u2500\u2500 2Dvs3D_53-11_00006_6.0_Jul31_16.54.20.tif\n\u251c\u2500\u2500 2Dvs3D_53-11_00007_8.0_Jul31_16.54.59.tif\n\u251c\u2500\u2500 2Dvs3D_53-11_00008_-6.0_Jul31_16.55.43.tif\n\u251c\u2500\u2500 2Dvs3D_53-11_00009_-8.0_Jul31_16.56.25.tif\n\u251c\u2500\u2500 2Dvs3D_53-11_00010_10.0_Jul31_16.57.07.tif\n\u251c\u2500\u2500 2Dvs3D_53-11_00011_12.0_Jul31_16.57.47.tif\n\u251c\u2500\u2500 2Dvs3D_53-11_00012_-10.0_Jul31_16.58.31.tif\n\u251c\u2500\u2500 2Dvs3D_53-11_00013_-12.0_Jul31_16.59.13.tif\n\u251c\u2500\u2500 2Dvs3D_53-11_00014_14.0_Jul31_16.59.55.tif\n\u251c\u2500\u2500 2Dvs3D_53-11_00015_16.0_Jul31_17.00.35.tif\n\u251c\u2500\u2500 2Dvs3D_53-11_00016_-14.0_Jul31_17.01.19.tif\n\u251c\u2500\u2500 2Dvs3D_53-11_00017_-16.0_Jul31_17.02.01.tif\n\u251c\u2500\u2500 2Dvs3D_53-11_00018_18.0_Jul31_17.02.52.tif\n\u251c\u2500\u2500 2Dvs3D_53-11_00019_20.0_Jul31_17.03.33.tif\n\u251c\u2500\u2500 2Dvs3D_53-11_00020_-18.0_Jul31_17.04.18.tif\n\u251c\u2500\u2500 2Dvs3D_53-11_00021_-20.0_Jul31_17.05.08.tif\n\u251c\u2500\u2500 2Dvs3D_53-11_00022_22.0_Jul31_17.05.52.tif\n\u251c\u2500\u2500 2Dvs3D_53-11_00023_24.0_Jul31_17.06.32.tif\n\u251c\u2500\u2500 2Dvs3D_53-11_00024_-22.0_Jul31_17.07.18.tif\n\u251c\u2500\u2500 2Dvs3D_53-11_00025_-24.0_Jul31_17.07.59.tif\n\u251c\u2500\u2500 2Dvs3D_53-11_00026_26.0_Jul31_17.08.44.tif\n\u251c\u2500\u2500 2Dvs3D_53-11_00027_28.0_Jul31_17.09.24.tif\n\u251c\u2500\u2500 2Dvs3D_53-11_00028_-26.0_Jul31_17.10.09.tif\n\u251c\u2500\u2500 2Dvs3D_53-11_00029_-28.0_Jul31_17.10.51.tif\n\u251c\u2500\u2500 2Dvs3D_53-11_00030_30.0_Jul31_17.11.37.tif\n\u251c\u2500\u2500 2Dvs3D_53-11_00031_32.0_Jul31_17.12.17.tif\n\u251c\u2500\u2500 2Dvs3D_53-11_00032_-30.0_Jul31_17.13.23.tif\n\u251c\u2500\u2500 2Dvs3D_53-11_00033_-32.0_Jul31_17.14.05.tif\n\u251c\u2500\u2500 2Dvs3D_53-11_00034_34.0_Jul31_17.14.51.tif\n\u251c\u2500\u2500 2Dvs3D_53-11_00035_36.0_Jul31_17.15.31.tif\n\u251c\u2500\u2500 2Dvs3D_53-11_00036_-34.0_Jul31_17.16.18.tif\n\u251c\u2500\u2500 2Dvs3D_53-11_00037_-36.0_Jul31_17.17.00.tif\n\u251c\u2500\u2500 2Dvs3D_53-11_00038_38.0_Jul31_17.17.46.tif\n\u251c\u2500\u2500 2Dvs3D_53-11_00039_40.0_Jul31_17.18.26.tif\n\u251c\u2500\u2500 2Dvs3D_53-11_00040_-38.0_Jul31_17.19.13.tif\n\u251c\u2500\u2500 2Dvs3D_53-11_00041_-40.0_Jul31_17.19.55.tif\n\u251c\u2500\u2500 2Dvs3D_53-17_00001_-0.0_Jul31_21.21.04.tif\n\u251c\u2500\u2500 2Dvs3D_53-17_00002_2.0_Jul31_21.21.44.tif\n\u251c\u2500\u2500 2Dvs3D_53-17_00003_4.0_Jul31_21.22.24.tif\n\u251c\u2500\u2500 2Dvs3D_53-17_00004_-2.0_Jul31_21.23.07.tif\n\u251c\u2500\u2500 2Dvs3D_53-17_00005_-4.0_Jul31_21.23.48.tif\n\u251c\u2500\u2500 2Dvs3D_53-17_00006_6.0_Jul31_21.24.29.tif\n\u251c\u2500\u2500 2Dvs3D_53-17_00007_8.0_Jul31_21.25.09.tif\n\u251c\u2500\u2500 2Dvs3D_53-17_00008_-6.0_Jul31_21.25.53.tif\n\u251c\u2500\u2500 2Dvs3D_53-17_00009_-8.0_Jul31_21.26.34.tif\n\u251c\u2500\u2500 2Dvs3D_53-17_00010_10.0_Jul31_21.27.17.tif\n\u251c\u2500\u2500 2Dvs3D_53-17_00011_12.0_Jul31_21.27.56.tif\n\u251c\u2500\u2500 2Dvs3D_53-17_00012_-10.0_Jul31_21.28.41.tif\n\u251c\u2500\u2500 2Dvs3D_53-17_00013_-12.0_Jul31_21.29.23.tif\n\u251c\u2500\u2500 2Dvs3D_53-17_00014_14.0_Jul31_21.30.07.tif\n\u251c\u2500\u2500 2Dvs3D_53-17_00015_16.0_Jul31_21.30.47.tif\n\u251c\u2500\u2500 2Dvs3D_53-17_00016_-14.0_Jul31_21.31.43.tif\n\u251c\u2500\u2500 2Dvs3D_53-17_00017_-16.0_Jul31_21.32.25.tif\n\u251c\u2500\u2500 2Dvs3D_53-17_00018_18.0_Jul31_21.33.08.tif\n\u251c\u2500\u2500 2Dvs3D_53-17_00019_20.0_Jul31_21.33.47.tif\n\u251c\u2500\u2500 2Dvs3D_53-17_00020_-18.0_Jul31_21.34.32.tif\n\u251c\u2500\u2500 2Dvs3D_53-17_00021_-20.0_Jul31_21.35.14.tif\n\u251c\u2500\u2500 2Dvs3D_53-17_00022_22.0_Jul31_21.35.58.tif\n\u251c\u2500\u2500 2Dvs3D_53-17_00023_24.0_Jul31_21.36.38.tif\n\u251c\u2500\u2500 2Dvs3D_53-17_00024_-22.0_Jul31_21.37.24.tif\n\u251c\u2500\u2500 2Dvs3D_53-17_00025_-24.0_Jul31_21.38.07.tif\n\u251c\u2500\u2500 2Dvs3D_53-17_00026_26.0_Jul31_21.38.51.tif\n\u251c\u2500\u2500 2Dvs3D_53-17_00027_28.0_Jul31_21.39.31.tif\n\u251c\u2500\u2500 2Dvs3D_53-17_00028_-26.0_Jul31_21.40.17.tif\n\u251c\u2500\u2500 2Dvs3D_53-17_00029_-28.0_Jul31_21.41.07.tif\n\u251c\u2500\u2500 2Dvs3D_53-17_00030_30.0_Jul31_21.41.51.tif\n\u251c\u2500\u2500 2Dvs3D_53-17_00031_32.0_Jul31_21.42.31.tif\n\u251c\u2500\u2500 2Dvs3D_53-17_00032_-30.0_Jul31_21.43.18.tif\n\u251c\u2500\u2500 2Dvs3D_53-17_00033_-32.0_Jul31_21.44.01.tif\n\u251c\u2500\u2500 2Dvs3D_53-17_00034_34.0_Jul31_21.44.45.tif\n\u251c\u2500\u2500 2Dvs3D_53-17_00035_36.0_Jul31_21.45.26.tif\n\u251c\u2500\u2500 2Dvs3D_53-17_00036_-34.0_Jul31_21.46.12.tif\n\u251c\u2500\u2500 2Dvs3D_53-17_00037_-36.0_Jul31_21.46.55.tif\n\u251c\u2500\u2500 2Dvs3D_53-17_00038_38.0_Jul31_21.47.40.tif\n\u251c\u2500\u2500 2Dvs3D_53-17_00039_40.0_Jul31_21.48.20.tif\n\u251c\u2500\u2500 2Dvs3D_53-17_00040_-38.0_Jul31_21.49.08.tif\n\u251c\u2500\u2500 2Dvs3D_53-17_00041_-40.0_Jul31_21.49.50.tif\n\u251c\u2500\u2500 2Dvs3D_53-23_00001_-0.0_Aug01_10.29.18.tif\n\u251c\u2500\u2500 2Dvs3D_53-23_00002_2.0_Aug01_10.29.58.tif\n\u251c\u2500\u2500 2Dvs3D_53-23_00003_4.0_Aug01_10.30.39.tif\n\u251c\u2500\u2500 2Dvs3D_53-23_00004_-2.0_Aug01_10.31.21.tif\n\u251c\u2500\u2500 2Dvs3D_53-23_00005_-4.0_Aug01_10.32.02.tif\n\u251c\u2500\u2500 2Dvs3D_53-23_00006_6.0_Aug01_10.32.43.tif\n\u251c\u2500\u2500 2Dvs3D_53-23_00007_8.0_Aug01_10.33.23.tif\n\u251c\u2500\u2500 2Dvs3D_53-23_00008_-6.0_Aug01_10.34.06.tif\n\u251c\u2500\u2500 2Dvs3D_53-23_00009_-8.0_Aug01_10.34.48.tif\n\u251c\u2500\u2500 2Dvs3D_53-23_00010_10.0_Aug01_10.35.30.tif\n\u251c\u2500\u2500 2Dvs3D_53-23_00011_12.0_Aug01_10.36.10.tif\n\u251c\u2500\u2500 2Dvs3D_53-23_00012_-10.0_Aug01_10.36.53.tif\n\u251c\u2500\u2500 2Dvs3D_53-23_00013_-12.0_Aug01_10.37.34.tif\n\u251c\u2500\u2500 2Dvs3D_53-23_00014_14.0_Aug01_10.38.17.tif\n\u251c\u2500\u2500 2Dvs3D_53-23_00015_16.0_Aug01_10.38.58.tif\n\u251c\u2500\u2500 2Dvs3D_53-23_00016_-14.0_Aug01_10.39.42.tif\n\u251c\u2500\u2500 2Dvs3D_53-23_00017_-16.0_Aug01_10.40.24.tif\n\u251c\u2500\u2500 2Dvs3D_53-23_00018_18.0_Aug01_10.41.07.tif\n\u251c\u2500\u2500 2Dvs3D_53-23_00019_20.0_Aug01_10.41.47.tif\n\u251c\u2500\u2500 2Dvs3D_53-23_00020_-18.0_Aug01_10.42.32.tif\n\u251c\u2500\u2500 2Dvs3D_53-23_00021_-20.0_Aug01_10.43.14.tif\n\u251c\u2500\u2500 2Dvs3D_53-23_00022_22.0_Aug01_10.43.57.tif\n\u251c\u2500\u2500 2Dvs3D_53-23_00023_24.0_Aug01_10.44.38.tif\n\u251c\u2500\u2500 2Dvs3D_53-23_00024_-22.0_Aug01_10.45.24.tif\n\u251c\u2500\u2500 2Dvs3D_53-23_00025_-24.0_Aug01_10.46.06.tif\n\u251c\u2500\u2500 2Dvs3D_53-23_00026_26.0_Aug01_10.46.50.tif\n\u251c\u2500\u2500 2Dvs3D_53-23_00027_28.0_Aug01_10.47.31.tif\n\u251c\u2500\u2500 2Dvs3D_53-23_00028_-26.0_Aug01_10.48.16.tif\n\u251c\u2500\u2500 2Dvs3D_53-23_00029_-28.0_Aug01_10.48.58.tif\n\u251c\u2500\u2500 2Dvs3D_53-23_00030_30.0_Aug01_10.49.50.tif\n\u251c\u2500\u2500 2Dvs3D_53-23_00031_32.0_Aug01_10.50.30.tif\n\u251c\u2500\u2500 2Dvs3D_53-23_00032_-30.0_Aug01_10.51.17.tif\n\u251c\u2500\u2500 2Dvs3D_53-23_00033_-32.0_Aug01_10.51.59.tif\n\u251c\u2500\u2500 2Dvs3D_53-23_00034_34.0_Aug01_10.52.51.tif\n\u251c\u2500\u2500 2Dvs3D_53-23_00035_36.0_Aug01_10.53.39.tif\n\u251c\u2500\u2500 2Dvs3D_53-23_00036_-34.0_Aug01_10.54.28.tif\n\u251c\u2500\u2500 2Dvs3D_53-23_00037_-36.0_Aug01_10.55.10.tif\n\u251c\u2500\u2500 2Dvs3D_53-23_00038_38.0_Aug01_10.56.03.tif\n\u251c\u2500\u2500 2Dvs3D_53-23_00039_40.0_Aug01_10.56.43.tif\n\u251c\u2500\u2500 2Dvs3D_53-23_00040_-38.0_Aug01_10.57.30.tif\n\u251c\u2500\u2500 2Dvs3D_53-23_00041_-40.0_Aug01_10.58.12.tif\n\u251c\u2500\u2500 2Dvs3D_53-32_00001_-0.0_Aug01_19.22.49.tif\n\u251c\u2500\u2500 2Dvs3D_53-32_00002_2.0_Aug01_19.23.29.tif\n\u251c\u2500\u2500 2Dvs3D_53-32_00003_4.0_Aug01_19.24.09.tif\n\u251c\u2500\u2500 2Dvs3D_53-32_00004_-2.0_Aug01_19.24.51.tif\n\u251c\u2500\u2500 2Dvs3D_53-32_00005_-4.0_Aug01_19.25.33.tif\n\u251c\u2500\u2500 2Dvs3D_53-32_00006_6.0_Aug01_19.26.14.tif\n\u251c\u2500\u2500 2Dvs3D_53-32_00007_8.0_Aug01_19.26.54.tif\n\u251c\u2500\u2500 2Dvs3D_53-32_00008_-6.0_Aug01_19.27.38.tif\n\u251c\u2500\u2500 2Dvs3D_53-32_00009_-8.0_Aug01_19.28.19.tif\n\u251c\u2500\u2500 2Dvs3D_53-32_00010_10.0_Aug01_19.29.01.tif\n\u251c\u2500\u2500 2Dvs3D_53-32_00011_12.0_Aug01_19.29.53.tif\n\u251c\u2500\u2500 2Dvs3D_53-32_00012_-10.0_Aug01_19.30.36.tif\n\u251c\u2500\u2500 2Dvs3D_53-32_00013_-12.0_Aug01_19.31.18.tif\n\u251c\u2500\u2500 2Dvs3D_53-32_00014_14.0_Aug01_19.32.01.tif\n\u251c\u2500\u2500 2Dvs3D_53-32_00015_16.0_Aug01_19.32.40.tif\n\u251c\u2500\u2500 2Dvs3D_53-32_00016_-14.0_Aug01_19.33.25.tif\n\u251c\u2500\u2500 2Dvs3D_53-32_00017_-16.0_Aug01_19.34.07.tif\n\u251c\u2500\u2500 2Dvs3D_53-32_00018_18.0_Aug01_19.34.49.tif\n\u251c\u2500\u2500 2Dvs3D_53-32_00019_20.0_Aug01_19.35.29.tif\n\u251c\u2500\u2500 2Dvs3D_53-32_00020_-18.0_Aug01_19.36.14.tif\n\u251c\u2500\u2500 2Dvs3D_53-32_00021_-20.0_Aug01_19.36.56.tif\n\u251c\u2500\u2500 2Dvs3D_53-32_00022_22.0_Aug01_19.38.03.tif\n\u251c\u2500\u2500 2Dvs3D_53-32_00023_24.0_Aug01_19.38.43.tif\n\u251c\u2500\u2500 2Dvs3D_53-32_00024_26.0_Aug01_19.39.23.tif\n\u251c\u2500\u2500 2Dvs3D_53-32_00025_28.0_Aug01_19.40.03.tif\n\u251c\u2500\u2500 2Dvs3D_53-32_00026_30.0_Aug01_19.40.43.tif\n\u251c\u2500\u2500 2Dvs3D_53-32_00027_32.0_Aug01_19.41.23.tif\n\u251c\u2500\u2500 2Dvs3D_53-32_00028_34.0_Aug01_19.42.02.tif\n\u251c\u2500\u2500 2Dvs3D_53-32_00029_36.0_Aug01_19.42.42.tif\n\u251c\u2500\u2500 2Dvs3D_53-32_00030_38.0_Aug01_19.43.22.tif\n\u251c\u2500\u2500 2Dvs3D_53-32_00031_40.0_Aug01_19.44.02.tif\n\u251c\u2500\u2500 2Dvs3D_53-32_00032_-22.0_Aug01_19.45.21.tif\n\u251c\u2500\u2500 2Dvs3D_53-32_00033_-24.0_Aug01_19.46.03.tif\n\u251c\u2500\u2500 2Dvs3D_53-32_00034_-26.0_Aug01_19.46.45.tif\n\u251c\u2500\u2500 2Dvs3D_53-32_00035_-28.0_Aug01_19.47.28.tif\n\u251c\u2500\u2500 2Dvs3D_53-32_00036_-30.0_Aug01_19.48.11.tif\n\u251c\u2500\u2500 2Dvs3D_53-32_00037_-32.0_Aug01_19.48.54.tif\n\u251c\u2500\u2500 2Dvs3D_53-32_00038_-34.0_Aug01_19.49.43.tif\n\u251c\u2500\u2500 2Dvs3D_53-32_00039_-36.0_Aug01_19.50.33.tif\n\u251c\u2500\u2500 2Dvs3D_53-32_00040_-38.0_Aug01_19.51.16.tif\n\u251c\u2500\u2500 2Dvs3D_53-32_00041_-40.0_Aug01_19.51.58.tif\n\u251c\u2500\u2500 2Dvs3D_59-11_00001_-0.0_Aug02_01.08.03.tif\n\u251c\u2500\u2500 2Dvs3D_59-11_00002_2.0_Aug02_01.08.43.tif\n\u251c\u2500\u2500 2Dvs3D_59-11_00003_4.0_Aug02_01.09.23.tif\n\u251c\u2500\u2500 2Dvs3D_59-11_00004_-2.0_Aug02_01.10.06.tif\n\u251c\u2500\u2500 2Dvs3D_59-11_00005_-4.0_Aug02_01.10.47.tif\n\u251c\u2500\u2500 2Dvs3D_59-11_00006_6.0_Aug02_01.11.29.tif\n\u251c\u2500\u2500 2Dvs3D_59-11_00007_8.0_Aug02_01.12.09.tif\n\u251c\u2500\u2500 2Dvs3D_59-11_00008_-6.0_Aug02_01.12.52.tif\n\u251c\u2500\u2500 2Dvs3D_59-11_00009_-8.0_Aug02_01.13.34.tif\n\u251c\u2500\u2500 2Dvs3D_59-11_00010_10.0_Aug02_01.14.15.tif\n\u251c\u2500\u2500 2Dvs3D_59-11_00011_12.0_Aug02_01.14.55.tif\n\u251c\u2500\u2500 2Dvs3D_59-11_00012_-10.0_Aug02_01.15.39.tif\n\u251c\u2500\u2500 2Dvs3D_59-11_00013_-12.0_Aug02_01.16.21.tif\n\u251c\u2500\u2500 2Dvs3D_59-11_00014_14.0_Aug02_01.17.03.tif\n\u251c\u2500\u2500 2Dvs3D_59-11_00015_16.0_Aug02_01.17.43.tif\n\u251c\u2500\u2500 2Dvs3D_59-11_00016_-14.0_Aug02_01.18.28.tif\n\u251c\u2500\u2500 2Dvs3D_59-11_00017_-16.0_Aug02_01.19.10.tif\n\u251c\u2500\u2500 2Dvs3D_59-11_00018_18.0_Aug02_01.19.53.tif\n\u251c\u2500\u2500 2Dvs3D_59-11_00019_20.0_Aug02_01.20.32.tif\n\u251c\u2500\u2500 2Dvs3D_59-11_00020_-18.0_Aug02_01.21.17.tif\n\u251c\u2500\u2500 2Dvs3D_59-11_00021_-20.0_Aug02_01.22.00.tif\n\u251c\u2500\u2500 2Dvs3D_59-11_00022_22.0_Aug02_01.23.04.tif\n\u251c\u2500\u2500 2Dvs3D_59-11_00023_24.0_Aug02_01.23.44.tif\n\u251c\u2500\u2500 2Dvs3D_59-11_00024_26.0_Aug02_01.24.24.tif\n\u251c\u2500\u2500 2Dvs3D_59-11_00025_28.0_Aug02_01.25.04.tif\n\u251c\u2500\u2500 2Dvs3D_59-11_00026_30.0_Aug02_01.25.44.tif\n\u251c\u2500\u2500 2Dvs3D_59-11_00027_32.0_Aug02_01.26.24.tif\n\u251c\u2500\u2500 2Dvs3D_59-11_00028_34.0_Aug02_01.27.04.tif\n\u251c\u2500\u2500 2Dvs3D_59-11_00029_36.0_Aug02_01.27.45.tif\n\u251c\u2500\u2500 2Dvs3D_59-11_00030_38.0_Aug02_01.28.25.tif\n\u251c\u2500\u2500 2Dvs3D_59-11_00031_40.0_Aug02_01.29.05.tif\n\u251c\u2500\u2500 2Dvs3D_59-11_00032_-22.0_Aug02_01.30.24.tif\n\u251c\u2500\u2500 2Dvs3D_59-11_00033_-24.0_Aug02_01.31.06.tif\n\u251c\u2500\u2500 2Dvs3D_59-11_00034_-26.0_Aug02_01.31.48.tif\n\u251c\u2500\u2500 2Dvs3D_59-11_00035_-28.0_Aug02_01.32.30.tif\n\u251c\u2500\u2500 2Dvs3D_59-11_00036_-30.0_Aug02_01.33.12.tif\n\u251c\u2500\u2500 2Dvs3D_59-11_00037_-32.0_Aug02_01.33.55.tif\n\u251c\u2500\u2500 2Dvs3D_59-11_00038_-34.0_Aug02_01.34.44.tif\n\u251c\u2500\u2500 2Dvs3D_59-11_00039_-36.0_Aug02_01.35.26.tif\n\u251c\u2500\u2500 2Dvs3D_59-11_00040_-38.0_Aug02_01.36.16.tif\n\u251c\u2500\u2500 2Dvs3D_59-11_00041_-40.0_Aug02_01.36.58.tif\n\u251c\u2500\u2500 2Dvs3D_59-32_00001_-0.0_Aug02_10.40.58.tif\n\u251c\u2500\u2500 2Dvs3D_59-32_00002_2.0_Aug02_10.41.38.tif\n\u251c\u2500\u2500 2Dvs3D_59-32_00003_4.0_Aug02_10.42.19.tif\n\u251c\u2500\u2500 2Dvs3D_59-32_00004_-2.0_Aug02_10.43.04.tif\n\u251c\u2500\u2500 2Dvs3D_59-32_00005_-4.0_Aug02_10.43.49.tif\n\u251c\u2500\u2500 2Dvs3D_59-32_00006_6.0_Aug02_10.44.31.tif\n\u251c\u2500\u2500 2Dvs3D_59-32_00007_8.0_Aug02_10.45.10.tif\n\u251c\u2500\u2500 2Dvs3D_59-32_00008_-6.0_Aug02_10.45.55.tif\n\u251c\u2500\u2500 2Dvs3D_59-32_00009_-8.0_Aug02_10.46.37.tif\n\u251c\u2500\u2500 2Dvs3D_59-32_00010_10.0_Aug02_10.47.19.tif\n\u251c\u2500\u2500 2Dvs3D_59-32_00011_12.0_Aug02_10.47.58.tif\n\u251c\u2500\u2500 2Dvs3D_59-32_00012_-10.0_Aug02_10.48.50.tif\n\u251c\u2500\u2500 2Dvs3D_59-32_00013_-12.0_Aug02_10.49.31.tif\n\u251c\u2500\u2500 2Dvs3D_59-32_00014_14.0_Aug02_10.50.15.tif\n\u251c\u2500\u2500 2Dvs3D_59-32_00015_16.0_Aug02_10.50.54.tif\n\u251c\u2500\u2500 2Dvs3D_59-32_00016_-14.0_Aug02_10.51.47.tif\n\u251c\u2500\u2500 2Dvs3D_59-32_00017_-16.0_Aug02_10.52.29.tif\n\u251c\u2500\u2500 2Dvs3D_59-32_00018_18.0_Aug02_10.53.11.tif\n\u251c\u2500\u2500 2Dvs3D_59-32_00019_20.0_Aug02_10.53.58.tif\n\u251c\u2500\u2500 2Dvs3D_59-32_00020_-18.0_Aug02_10.54.51.tif\n\u251c\u2500\u2500 2Dvs3D_59-32_00021_-20.0_Aug02_10.55.33.tif\n\u251c\u2500\u2500 2Dvs3D_59-32_00022_22.0_Aug02_10.56.37.tif\n\u251c\u2500\u2500 2Dvs3D_59-32_00023_24.0_Aug02_10.57.26.tif\n\u251c\u2500\u2500 2Dvs3D_59-32_00024_26.0_Aug02_10.58.13.tif\n\u251c\u2500\u2500 2Dvs3D_59-32_00025_28.0_Aug02_10.59.01.tif\n\u251c\u2500\u2500 2Dvs3D_59-32_00026_30.0_Aug02_10.59.49.tif\n\u251c\u2500\u2500 2Dvs3D_59-32_00027_32.0_Aug02_11.00.37.tif\n\u251c\u2500\u2500 2Dvs3D_59-32_00028_34.0_Aug02_11.01.24.tif\n\u251c\u2500\u2500 2Dvs3D_59-32_00029_36.0_Aug02_11.02.11.tif\n\u251c\u2500\u2500 2Dvs3D_59-32_00030_38.0_Aug02_11.03.00.tif\n\u251c\u2500\u2500 2Dvs3D_59-32_00031_40.0_Aug02_11.03.47.tif\n\u251c\u2500\u2500 2Dvs3D_59-32_00032_-22.0_Aug02_11.05.03.tif\n\u251c\u2500\u2500 2Dvs3D_59-32_00033_-24.0_Aug02_11.05.46.tif\n\u251c\u2500\u2500 2Dvs3D_59-32_00034_-26.0_Aug02_11.06.28.tif\n\u251c\u2500\u2500 2Dvs3D_59-32_00035_-28.0_Aug02_11.07.10.tif\n\u251c\u2500\u2500 2Dvs3D_59-32_00036_-30.0_Aug02_11.07.52.tif\n\u251c\u2500\u2500 2Dvs3D_59-32_00037_-32.0_Aug02_11.08.34.tif\n\u251c\u2500\u2500 2Dvs3D_59-32_00038_-34.0_Aug02_11.09.16.tif\n\u251c\u2500\u2500 2Dvs3D_59-32_00039_-36.0_Aug02_11.09.58.tif\n\u251c\u2500\u2500 2Dvs3D_59-32_00040_-38.0_Aug02_11.10.41.tif\n\u2514\u2500\u2500 2Dvs3D_59-32_00041_-40.0_Aug02_11.11.23.tif\n</code></pre> <pre><code>./mdoc\n\u251c\u2500\u2500 TS_11.mrc.mdoc\n\u251c\u2500\u2500 TS_17.mrc.mdoc\n\u251c\u2500\u2500 TS_1.mrc.mdoc\n\u251c\u2500\u2500 TS_23.mrc.mdoc\n\u2514\u2500\u2500 TS_32.mrc.mdoc\n</code></pre>"},{"location":"user_guide/warptools/quick_start_warptools_tilt_series/#create-warp-settings-files","title":"Create Warp Settings Files","text":"<p>Settings files are config files which tell WarpTools</p> <ol> <li>where to look for data to process</li> <li>where to store results</li> <li>relevant metadata</li> </ol> <p>We will create two settings files, <code>warp_frameseries.settings</code> and <code>warp_tiltseries.settings</code>. These will be used for frame series and tilt series processing respectively.</p> Frame SeriesTilt Series Create Frame Series Settings File<pre><code>WarpTools create_settings \\\n--folder_data frames \\\n--folder_processing warp_frameseries \\\n--output warp_frameseries.settings \\\n--extension \"*.tif\" \\\n--angpix 0.7894 \\\n--gain_path gain_ref.mrc \\\n--gain_flip_y \\\n--exposure 2.64\n</code></pre> Create Tilt Series Settings File<pre><code>WarpTools create_settings \\\n--output warp_tiltseries.settings \\\n--folder_processing warp_tiltseries \\\n--folder_data tomostar \\\n--extension \"*.tomostar\" \\\n--angpix 0.7894 \\\n--gain_path gain_ref.mrc \\\n--gain_flip_y \\\n--exposure 2.64 \\\n--tomo_dimensions 4400x6000x1000 # (1)!\n</code></pre> <ol> <li> These are the dimensions of your tomograms in unbinned pixels.     Tomograms are reconstructed with the tilt axis aligned along Y, remember to      account for rotation of the tilt axis when setting these dimensions!</li> </ol> <p>Processing EER files?</p> <p>add <code>--eer_ngroups</code> or <code>--eer_groupexposure</code> to your settings creation command</p>"},{"location":"user_guide/warptools/quick_start_warptools_tilt_series/#preprocessing-from-frames-to-tomograms","title":"Preprocessing: From Frames to Tomograms","text":""},{"location":"user_guide/warptools/quick_start_warptools_tilt_series/#frame-series-motion-and-ctf-estimation","title":"Frame Series: Motion and CTF Estimation","text":"<p>The first step in processing tilt movies involves estimating 2D sample motion and contrast transfer function.</p> Frame Series Motion and CTF Estimation<pre><code>WarpTools fs_motion_and_ctf \\\n--settings warp_frameseries.settings \\\n--m_grid 1x1x3 \\\n--c_grid 2x2x1 \\\n--c_range_max 7 \\\n--c_defocus_max 8 \\\n--c_use_sum \\\n--out_averages \\\n--out_average_halves # (1)!\n</code></pre> <ol> <li> averages of half sets of frames are required for Noise2Noise    based denoising of images and tomograms</li> </ol> <p>Motion corrected averages will be written out to the <code>warp_frameseries/average</code> directory. Motion and CTF related metadata will be written into XML files, one per frame series, in the <code>warp_frameseries</code> directory.</p> <p>Tip</p> <p>Algorithms in WarpTools were written for GPUs with ~16GB memory. </p> <p>If you're lucky enough to access to bigger cards, try running multiple worker processes  per GPU. We typically use <code>--perdevice 4</code> on A100 cards with 80GB memory.</p> <p>Need more info?</p> <p>All command line options and associated help text can be seen on our API reference pages</p>"},{"location":"user_guide/warptools/quick_start_warptools_tilt_series/#parameters-explained","title":"Parameters explained","text":""},{"location":"user_guide/warptools/quick_start_warptools_tilt_series/#grids","title":"Grids","text":"<p>The <code>--m_grid 1x1x3</code> and <code>--c_grid 2x2x1</code> parameters define the resolution (<code>XxYxT</code>) of motion and CTF models that will be estimated.</p> <p>When processing tilt series data we typically recommend <code>1x1xNFrames</code> for motion grids due to the low amount of signal available per tilt and <code>2x2x1</code> for CTF grids to enable checking that defocus varies as expected across the tilt axis.</p>"},{"location":"user_guide/warptools/quick_start_warptools_tilt_series/#ctf-parameters","title":"CTF Parameters","text":"<ul> <li><code>--c_range_max</code> is the maximum spatial resolution of information used for fitting in \u00c5</li> <li><code>--c_defocus_max</code> is the maximum allowed defocus value</li> </ul> <p><code>--c_use_sum</code> controls whether CTF estimation use the power spectrum from the motion corrected average or the sum of per-frame power spectra for estimation. Estimating from the motion corrected average can be useful in the absence of an energy filter, or generally when per frame signal is low.</p>"},{"location":"user_guide/warptools/quick_start_warptools_tilt_series/#visualizing-results","title":"Visualizing Results","text":"<p>Just because you're at the command line doesn't mean you should have to dig through text files to see how your processing went. Use our handy <code>filter_quality</code> WarpTool to see various statistics about your data processing printed to the terminal.</p> Command Plot Histograms of 2D Processing Metrics<pre><code>WarpTools filter_quality --settings warp_frameseries.settings --histograms\n</code></pre> MotionDefocusAstigmatismCTF ResolutionPhase Shift\ud83d\udca9 <pre><code>Motion in first 1/3 (\u00c5):\n0.1 - 0.4: \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 72\n0.4 - 0.8: \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 84\n0.8 - 1.2: \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 55\n1.2 - 1.5: \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 27\n1.5 - 1.9: \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 18\n1.9 - 2.3: \u2588\u2588\u2588\u2588\u2588 5\n2.3 - 2.6: \u2588\u2588\u2588\u2588\u2588 5\n2.6 - 3.0: \u2588\u2588\u2588\u2588 4\n3.0 - 3.4: \u2588\u2588 2\n3.4 - 3.7: \u2588\u2588 2\n3.7 - 4.1: \u2588\u2588\u2588\u2588 4\n4.1 - 4.4: \u2588\u2588\u2588\u2588 4\n4.4 - 4.8: \u2588 1\n4.8 - 5.2: \u2588\u2588 2\n5.2 - 5.5:  0\n5.5 - 5.9: \u2588 1\n5.9 - 6.3: \u2588 1\n</code></pre> <pre><code>Defocus (\u00b5m):\n1.3 - 1.6: \u2588 1\n1.6 - 1.9:  0\n1.9 - 2.2: \u2588\u2588 4\n2.2 - 2.6: \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 149\n2.6 - 2.9: \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 132\n2.9 - 3.2:  0\n3.2 - 3.6:  0\n3.6 - 3.9:  0\n3.9 - 4.2:  0\n4.2 - 4.6:  0\n4.6 - 4.9:  0\n4.9 - 5.2:  0\n5.2 - 5.5:  0\n5.5 - 5.9:  0\n5.9 - 6.2:  0\n6.2 - 6.5:  0\n6.5 - 6.9: \u2588 1\n</code></pre> <pre><code>Astigmatism (\u00b5m): max = 26\n 0.18 - 0.20 : |            \u00b7                     |\n 0.15 - 0.18 : |                \u00b7                 |\n 0.13 - 0.15 : |                                  |\n 0.11 - 0.13 : |                        \u00b7         |\n 0.08 - 0.11 : |                \u00b7 \u00b7     \u00b7         |\n 0.06 - 0.08 : |              \u00b7   \u00b7 \u00b7 \u00b7           |\n 0.04 - 0.06 : |\u00b7       \u00b7   \u00b7 \u00b7\u00b7\u2591\u2591\u2591\u2591\u00b7\u00b7            |\n 0.01 - 0.04 : |        \u00b7\u00b7\u00b7 \u2591\u2591\u2591\u2591\u2592\u2592\u2593\u2593\u00b7\u00b7\u00b7           |\n-0.01 - 0.01 : |\u00b7         \u00b7 \u2591\u2591\u2592\u2592\u2588\u2588\u2593\u2593\u2592\u2592\u00b7         \u00b7 |\n-0.04 - -0.01: |          \u00b7 \u2591\u2591\u2592\u2592\u2593\u2593\u2592\u2592\u2591\u2591\u00b7\u00b7\u00b7         |\n-0.06 - -0.04: |        \u00b7 \u00b7 \u00b7 \u2591\u2591\u2592\u2592\u2593\u2593\u00b7\u00b7  \u00b7\u00b7\u00b7       |\n-0.08 - -0.06: |          \u00b7 \u00b7 \u00b7\u00b7\u00b7\u00b7\u00b7\u00b7\u00b7 \u00b7\u00b7          |\n-0.11 - -0.08: |                \u00b7\u00b7\u00b7     \u00b7         |\n-0.13 - -0.11: |        \u00b7     \u00b7                   |\n-0.15 - -0.13: |                                  |\n-0.18 - -0.15: |                                  |\n-0.20 - -0.18: |                                  |\n</code></pre> <pre><code>CTF resolution (\u00c5):\n3.7 - 4.2 : \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 8\n4.2 - 4.6 : \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 29\n4.6 - 5.1 : \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 38\n5.1 - 5.5 : \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 64\n5.5 - 6.0 : \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 51\n6.0 - 6.5 : \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 66\n6.5 - 6.9 : \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 23\n6.9 - 7.4 : \u2588\u2588\u2588\u2588\u2588 4\n7.4 - 7.8 : \u2588\u2588 2\n7.8 - 8.3 : \u2588 1\n8.3 - 8.7 :  0\n8.7 - 9.2 :  0\n9.2 - 9.7 :  0\n9.7 - 10.1:  0\n10.1 - 10.6:  0\n10.6 - 11.0:  0\n11.0 - 11.5: \u2588 1\n</code></pre> <pre><code>Phase shift (\u03c0):\n0.0 - 0.0: \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 287\n</code></pre> <pre><code>Masked area (%):\n0.0 - 0.0: \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 287\n</code></pre>"},{"location":"user_guide/warptools/quick_start_warptools_tilt_series/#tilt-series-import","title":"Tilt Series: Import","text":"<p>Next we have to tell WarpTools which movies belong to which tilt series so we can process them.</p> <p>We tell WarpTools about the per-tilt exposure so that we can keep track of the cumulative dose received for each tilt. We also have an option to remove images which are darker than expected by supplying <code>--min_intensity</code> at this stage. (1)</p> <ol> <li> images are removed if their intensity is less    than <code>min_intensity</code> * <code>cos(tilt_angle)</code> * <code>0-tilt intensity</code></li> </ol> <p>This command produces files with the tomostar extension, these are STAR files with necessary information in them for further processing in WarpTools. We put these in a folder called <code>tomostar</code></p> Import Tilt Series Metadata<pre><code>WarpTools ts_import \\\n--mdocs mdoc \\\n--frameseries warp_frameseries \\\n--tilt_exposure 2.64 \\\n--min_intensity 0.3 \\\n--dont_invert \\ # (1)!\n--output tomostar\n</code></pre> <ol> <li> this option inverts geometric handedness by flipping the    tomogram reconstruction through the XY plane, we do this here because we know for    this dataset it leads to the correct geometric handedness in the tomogram.</li> </ol> example tomoSTAR file TS_1.tomostar<pre><code>data_\n\nloop_\n_wrpMovieName #1\n_wrpAngleTilt #2\n_wrpAxisAngle #3\n_wrpDose #4\n_wrpAverageIntensity #5\n_wrpMaskedFraction #6\n../warp_frameseries/2Dvs3D_53-1_00041_-40.0_Jul31_11.05.12.tif   40.01  -93.500  105.600006  3.854  0.000\n../warp_frameseries/2Dvs3D_53-1_00040_-38.0_Jul31_11.04.30.tif   38.00  -93.500   102.96001  3.950  0.000\n../warp_frameseries/2Dvs3D_53-1_00037_-36.0_Jul31_11.02.04.tif   36.01  -93.500       95.04  3.953  0.000\n../warp_frameseries/2Dvs3D_53-1_00036_-34.0_Jul31_11.01.23.tif   34.01  -93.500        92.4  3.905  0.000\n../warp_frameseries/2Dvs3D_53-1_00033_-32.0_Jul31_10.59.02.tif   32.01  -93.500       84.48  4.018  0.000\n../warp_frameseries/2Dvs3D_53-1_00032_-30.0_Jul31_10.58.12.tif   30.01  -93.500   81.840004  3.996  0.000\n../warp_frameseries/2Dvs3D_53-1_00029_-28.0_Jul31_10.56.01.tif   28.01  -93.500   73.920006  3.906  0.000\n../warp_frameseries/2Dvs3D_53-1_00028_-26.0_Jul31_10.55.20.tif   26.01  -93.500    71.28001  3.927  0.000\n../warp_frameseries/2Dvs3D_53-1_00025_-24.0_Jul31_10.53.10.tif   24.01  -93.500       63.36  3.955  0.000\n../warp_frameseries/2Dvs3D_53-1_00024_-22.0_Jul31_10.52.29.tif   22.01  -93.500       60.72  3.979  0.000\n../warp_frameseries/2Dvs3D_53-1_00021_-20.0_Jul31_10.50.20.tif   20.01  -93.500   52.800003  3.951  0.000\n../warp_frameseries/2Dvs3D_53-1_00020_-18.0_Jul31_10.49.38.tif   18.01  -93.500   50.160004  3.956  0.000\n../warp_frameseries/2Dvs3D_53-1_00017_-16.0_Jul31_10.47.29.tif   16.01  -93.500       42.24  3.993  0.000\n../warp_frameseries/2Dvs3D_53-1_00016_-14.0_Jul31_10.46.47.tif   14.02  -93.500   39.600002  4.054  0.000\n../warp_frameseries/2Dvs3D_53-1_00013_-12.0_Jul31_10.44.21.tif   12.02  -93.500       31.68  4.071  0.000\n../warp_frameseries/2Dvs3D_53-1_00012_-10.0_Jul31_10.43.39.tif   10.01  -93.500       29.04  4.054  0.000\n../warp_frameseries/2Dvs3D_53-1_00009_-8.0_Jul31_10.41.34.tif    8.01  -93.500       21.12  4.063  0.000\n../warp_frameseries/2Dvs3D_53-1_00008_-6.0_Jul31_10.40.51.tif    6.01  -93.500   18.480001  4.030  0.000\n../warp_frameseries/2Dvs3D_53-1_00005_-4.0_Jul31_10.38.47.tif    4.01  -93.500       10.56  4.033  0.000\n../warp_frameseries/2Dvs3D_53-1_00004_-2.0_Jul31_10.38.06.tif    2.01  -93.500        7.92  4.015  0.000\n../warp_frameseries/2Dvs3D_53-1_00001_-0.0_Jul31_10.36.03.tif    0.02  -93.500           0  3.999  0.000\n../warp_frameseries/2Dvs3D_53-1_00002_2.0_Jul31_10.36.43.tif   -1.99  -93.500        2.64  4.029  0.000\n../warp_frameseries/2Dvs3D_53-1_00003_4.0_Jul31_10.37.23.tif   -3.99  -93.500        5.28  3.980  0.000\n../warp_frameseries/2Dvs3D_53-1_00006_6.0_Jul31_10.39.28.tif   -5.98  -93.500   13.200001  4.019  0.000\n../warp_frameseries/2Dvs3D_53-1_00007_8.0_Jul31_10.40.08.tif   -7.99  -93.500       15.84  3.977  0.000\n../warp_frameseries/2Dvs3D_53-1_00010_10.0_Jul31_10.42.16.tif   -9.98  -93.500       23.76  3.961  0.000\n../warp_frameseries/2Dvs3D_53-1_00011_12.0_Jul31_10.42.56.tif  -11.98  -93.500   26.400002  4.025  0.000\n../warp_frameseries/2Dvs3D_53-1_00014_14.0_Jul31_10.45.03.tif  -13.98  -93.500       34.32  4.035  0.000\n../warp_frameseries/2Dvs3D_53-1_00015_16.0_Jul31_10.45.51.tif  -15.98  -93.500   36.960003  4.034  0.000\n../warp_frameseries/2Dvs3D_53-1_00018_18.0_Jul31_10.48.13.tif  -17.98  -93.500       44.88  4.022  0.000\n../warp_frameseries/2Dvs3D_53-1_00019_20.0_Jul31_10.48.53.tif  -19.98  -93.500       47.52  3.976  0.000\n../warp_frameseries/2Dvs3D_53-1_00022_22.0_Jul31_10.51.04.tif  -21.98  -93.500   55.440002  3.953  0.000\n../warp_frameseries/2Dvs3D_53-1_00023_24.0_Jul31_10.51.44.tif  -23.98  -93.500       58.08  3.984  0.000\n../warp_frameseries/2Dvs3D_53-1_00026_26.0_Jul31_10.53.54.tif  -25.98  -93.500          66  3.998  0.000\n../warp_frameseries/2Dvs3D_53-1_00027_28.0_Jul31_10.54.34.tif  -27.99  -93.500       68.64  3.952  0.000\n../warp_frameseries/2Dvs3D_53-1_00030_30.0_Jul31_10.56.46.tif  -29.99  -93.500   76.560005  3.964  0.000\n../warp_frameseries/2Dvs3D_53-1_00031_32.0_Jul31_10.57.26.tif  -31.98  -93.500   79.200005  3.875  0.000\n../warp_frameseries/2Dvs3D_53-1_00034_34.0_Jul31_10.59.47.tif  -33.98  -93.500       87.12  3.841  0.000\n../warp_frameseries/2Dvs3D_53-1_00035_36.0_Jul31_11.00.36.tif  -35.98  -93.500       89.76  3.844  0.000\n../warp_frameseries/2Dvs3D_53-1_00038_38.0_Jul31_11.03.02.tif  -37.98  -93.500       97.68  3.729  0.000\n../warp_frameseries/2Dvs3D_53-1_00039_40.0_Jul31_11.03.42.tif  -39.98  -93.500   100.32001  3.797  0.000\n</code></pre>"},{"location":"user_guide/warptools/quick_start_warptools_tilt_series/#tilt-series-alignment","title":"Tilt Series: Alignment","text":"<p>Tilt series alignment is the determination of parameters of a projection model required for reconstructing a tomogram from a set of projection images. WarpTools doesn't have its own solution for this step at the moment, instead we provide wrappers around IMOD and AreTomo.</p> <p>In this case, we will use patch tracking from IMOD via the <code>etomo_patches</code> WarpTool. (1)</p> <ol> <li> <code>ts_etomo_fiducials</code> and <code>ts_aretomo</code> are also available.</li> </ol> Tilt Series Alignment in Etomo using Patch Tracking<pre><code>WarpTools ts_etomo_patches \\\n--settings warp_tiltseries.settings \\\n--angpix 10 \\\n--patch_size 500 \\ # (1)!\n--initial_axis -85.6\n</code></pre> <ol> <li> this option is the sidelength of patches in \u00c5ngstroms. Patches    are arranged on a regular grid with 80% overlap.</li> </ol>"},{"location":"user_guide/warptools/quick_start_warptools_tilt_series/#tilt-series-check-defocus-handedness","title":"Tilt Series: Check Defocus Handedness","text":"<p>WarpTools contains a program, <code>ts_defocus_hand</code> for checking defocus handedness across a dataset and applying a correction to the model if necessary.</p> <p>First, we check how well our data match expectations. (1)</p> <ol> <li> this check requires that defocus was estimated with at least    two points in each spatial dimension (i.e. minimum <code>2x2x1</code>).</li> </ol> Defocus Handedness Check<pre><code>WarpTools ts_defocus_hand \\\n--settings warp_tiltseries.settings \\\n--check\n</code></pre> <p>In this case, the program tells us that the data match our expectations so we don't need to do anything.</p> Output from Defocus Handedness Check<pre><code>Checking defocus handedness for all tilt series...\n5/5, 0.932                                                                                                                                                                                \nAverage correlation: 0.932\nThe average correlation is positive, which means that the defocus handedness should be set to 'no flip'\n</code></pre> <p>Tip</p> <p>If the correlation had been negative, we would rerun the program with the <code>--set_flip</code>  flag to set the correct defocus handedness for all tilt series.</p> Defocus Handedness Correction<pre><code>WarpTools ts_defocus_hand \\\n--settings warp_tiltseries.settings \\\n--set_flip\n</code></pre>"},{"location":"user_guide/warptools/quick_start_warptools_tilt_series/#tilt-series-ctf-estimation","title":"Tilt Series: CTF Estimation","text":"<p>The initial defocus estimates from 2D frame series processing are great for getting an idea about how defocus changes but obtaining accurate estimates is challenging due to the lower amount of signal available in typical tilt images.</p> <p>Even if a tilt series accumulates 120 e<sup>\u2212</sup>\u00c5<sup>2</sup> throughout a tilt series each tilt contains only a few electrons per square angstrom. This provides much less signal than the 40 e<sup>\u2212</sup>\u00c5<sup>2</sup> typical of single particle images whilst striving for the same accuracy.</p> <p>WarpTools contains a <code>ts_ctf</code> tool which estimates a single defocus value per image in a tilt series whilst ensuring that data in all tilt images respect constraints common to the whole series. (1)</p> <ol> <li> this procedure is described in detail over at    Tilt Series CTF Estimation.</li> </ol> Tilt Series CTF Estimation<pre><code>WarpTools ts_ctf \\\n--settings warp_tiltseries.settings \\\n--range_high 7 \\\n--defocus_max 8\n</code></pre> <p>Tip</p> <p>Remember, you can use <code>ts_filter_quality</code> to print histograms of metrics from processing!</p>"},{"location":"user_guide/warptools/quick_start_warptools_tilt_series/#tilt-series-reconstruct-tomograms","title":"Tilt Series: Reconstruct Tomograms","text":"<p>Now that we have an estimate of the projection geometry and good CTF estimates for our tilt series we can move on to tomogram reconstruction. Tomogram reconstruction is available as <code>ts_reconstruct</code> in WarpTools.</p> Tomogram Reconstruction<pre><code>WarpTools ts_reconstruct \\\n--settings warp_tiltseries.settings \\\n--angpix 10 \n</code></pre> <p>Tomograms will be reconstructed and placed in <code>warp_tiltseries/reconstruction</code> alongside preview images providing some quick visual feedback. It's recommended that you look at volumes in a viewer like 3dmod to assess alignment quality.</p> <p>Warning</p> <p>Warp writes images as 16 bit MRC files, saving you valuable disk space and speeding up  file input/output. If you need 32 bit images for compatibility see  <code>WARP_FORCE_MRC_FLOAT32</code>.</p> preview image of tomogram reconstruction <p>If you would like to reconstruct half-tomograms for subsequent denoising using Noise2Map add the <code>--halfmap_frames</code> option to your command.</p>"},{"location":"user_guide/warptools/quick_start_warptools_tilt_series/#improving-alignments-in-etomo","title":"Improving alignments in Etomo","text":"<p>Running tilt series alignment programs in a fully automated way does not always give the best results. If you would like to improve results for a particlular tilt series you can run through Etomo yourself in the <code>tiltstack</code> folder for your tilt series and import the results.</p> importing improved alignments for TS_1<pre><code>WarpTools ts_import_alignments \\\n--settings warp_tiltseries.settings \\\n--alignments warp_tiltseries/tiltstack/TS_1 \\\n--alignment_angpix 10 \n</code></pre>"},{"location":"user_guide/warptools/quick_start_warptools_tilt_series/#particle-picking","title":"Particle Picking","text":"<p>You can pick particles in tomograms using whichever software you like the most, we just need the particle poses in a RELION particle STAR file for subsequent particle export.</p>"},{"location":"user_guide/warptools/quick_start_warptools_tilt_series/#template-matching","title":"Template Matching","text":"<p>We provide a CTF aware template matching routine, <code>ts_template_match</code>, for automated particle picking within WarpTools. In this example, we will match against an apoferritin template from the EMDB, EMD-15854.</p> Template Matching with a Template from the EMDB<pre><code>WarpTools ts_template_match \\\n--settings warp_tiltseries.settings \\\n--tomo_angpix 10 \\\n--subdivisions 3 \\\n--template_emdb 15854 \\\n--template_diameter 130 \\\n--symmetry O \\\n--whiten \\\n--check_hand 2 \n</code></pre> <p>A <code>--subdivisions</code> parameter controls the number of subdivisions defining the angular search step: 2 = 15\u00b0 step, 3 = 7.5\u00b0, 4 = 3.75\u00b0 and so on.</p> <p>The <code>--check_hand</code> parameter allows you to check the physical handedness of your tomograms by running template matching against both the template and a flipped version for a number of tilt series and comparing the height of the top scoring peaks in each case.</p> <p>When should I use spectral whitening?</p> <p>Low resolution information typically has much more spectral power than high resolution in our templates. This leads to low resolution information dominating the calculation of  correlation scores. </p> <p>The <code>--whiten</code> flag turns on spectral whitening, boosting high frequency information  to the same power as low frequency information.  This option improves matching results if your  tomograms are well aligned and have meaningful information at the resolution you are  using for matching.</p> <p>Templates are saved in <code>warp_tiltseries/template</code> and correlation volumes are written into the <code>warp_tiltseries/matching</code> directory. Images showing particle picks for each tilt series at a number of different thresholds are written into corresponding <code>*_picks</code> directories inside the <code>matching</code> directory.</p> preview image of template matching results <p>Scores are normalised to the mean and standard deviation of background of the whole volume so should be comparable across different tomograms and datasets.</p>"},{"location":"user_guide/warptools/quick_start_warptools_tilt_series/#visualizing-results_1","title":"Visualizing Results","text":"<p>We have developed warp-tm-vis as a standalone tool for visualizing template matching results and simulating the effects of thresholding at different cutoffs.</p> screenshot of the warp-tm-vis user interface <p>Tip</p> <p>warp-tm-vis is a graphical application which is designed to be run locally.  If your data are on a remote server, download them first before visualizing.</p>"},{"location":"user_guide/warptools/quick_start_warptools_tilt_series/#generating-particle-picks","title":"Generating Particle Picks","text":"<p>We can generate particle picks for subsequent processing by finding local maxima in a thresholded correlation volume. This is done in the <code>threshold_picks</code> WarpTool</p> Select Peaks from Template Matching Results<pre><code>WarpTools threshold_picks \\\n--settings warp_tiltseries.settings \\\n--in_suffix 15854 \\\n--out_suffix clean \\\n--minimum 3\n</code></pre> <p>This generates a number of STAR files containing particle positions with a <code>clean</code> suffix in the filename</p> Output Files from Peak Picking<pre><code>warp_tiltseries/matching\n\u251c\u2500\u2500 TS_1_10.00Apx_emd_15854_clean.star\n\u251c\u2500\u2500 TS_11_10.00Apx_emd_15854_clean.star\n\u251c\u2500\u2500 TS_17_10.00Apx_emd_15854_clean.star\n\u251c\u2500\u2500 TS_23_10.00Apx_emd_15854_clean.star\n\u2514\u2500\u2500 TS_32_10.00Apx_emd_15854_clean.star\n</code></pre>"},{"location":"user_guide/warptools/quick_start_warptools_tilt_series/#export-particles","title":"Export Particles","text":"<p>You can write particles using the <code>ts_export_particles</code> tool as either</p> <ul> <li>3D volumes and corresponding CTF volumes</li> <li>CTF corrected 2D particle image series</li> </ul> <p>Both output types are compatible with the latest version of RELION, RELION-5. For this tutorial we will write out 2D particle image series. (1)</p> <ol> <li> if using 3D particles you need to launch refinements from    the <code>relion</code> GUI,    not the <code>relion --tomo</code> GUI.</li> </ol> Export 2D particle series<pre><code>WarpTools ts_export_particles \\\n--settings warp_tiltseries.settings \\\n--input_directory warp_tiltseries/matching \\\n--input_pattern \"*15854_clean.star\" \\\n--normalized_coords \\\n--output_star relion/matching.star \\\n--output_angpix 4 \\\n--box 64 \\\n--diameter 130 \\\n--relative_output_paths \\\n--2d\n</code></pre> <p>This will write particle images the <code>warp_tiltseries/particleseries</code> directory. Per tilt averages (2D or 3D, depending on output dimensionality) are written into the same directory for debugging, you should see a blob in the center of these images.</p> Per tilt 2D average of apoferritin <p>Why 4\u00c5 per pixel?</p> <p>The major features of apoferritin are alpha helices which resolve nicely at around 9\u00c5. 9\u00c5 is slightly lower than the Nyquist limit of 8\u00c5.</p> <p>A particle STAR file will be written to the file specified as <code>--output_star</code>. In the case of 2D averages, a RELION compatible <code>optimisation_set</code> STAR file will be written out which points at a description of the tilt series in <code>*_tomograms.star</code> and the particle star file. This file can be used as input for refinement in the <code>relion --tomo</code> GUI in RELION 5. A <code>dummy_tiltseries.mrc</code> file is written out for compatibility with RELION.</p> RELION directory structure after particle export<pre><code>relion\n\u251c\u2500\u2500 matching.star\n\u251c\u2500\u2500 matching_tomograms.star\n\u251c\u2500\u2500 matching_optimisation_set.star\n\u2514\u2500\u2500 dummy_tiltseries.mrc\n</code></pre> <p>Tip</p> <p>Want to play with different particle sets at the same time? You can specify  <code>--output_processing</code> to override the processing directory (<code>warp_tiltseries</code>)  in the settings file at any time!</p>"},{"location":"user_guide/warptools/quick_start_warptools_tilt_series/#initial-3d-refinement-in-relion","title":"Initial 3D Refinement in RELION","text":"<p>We use RELION to determine good initial particle positions and orientations before attempting high resolution refinements in M. 3D classification in RELION can also be used to separate particles into different classes.</p> <p>For this apoferritin dataset, an unmasked 3D refinement starting from a 130\u00c5 sphere filtered to 60\u00c5 refines directly to the Nyquist limit of 8\u00c5.</p> Refine3D text output<pre><code> Auto-refine: Refinement has converged, stopping now... \n Auto-refine: + Final reconstruction from all particles is saved as: Refine3D/job001/run_class001.mrc\n Auto-refine: + Final model parameters are stored in: Refine3D/job001/run_model.star\n Auto-refine: + Final data parameters are stored in: Refine3D/job001/run_data.star\n Auto-refine: + Final resolution (without masking) is: 8.17021\n</code></pre> 8\u00c5 apoferritin from Refine3D RELION Refine3D command <p>This is the command that was run via the <code>RELION --tomo</code> GUI.</p> <pre><code>mpirun -n 3 `which relion_refine_mpi` \\\n--o Refine3D/job001/run \\\n--auto_refine \\\n--split_random_halves \\\n--ios matching_optimisation_set.star \\\n--ref sphere.mrc \\\n--trust_ref_size \\\n--ini_high 40 \\\n--dont_combine_weights_via_disc \\\n--pool 10 \\\n--pad 2  \\\n--ctf \\\n--particle_diameter 130 \\\n--flatten_solvent \\\n--zero_mask \\\n--oversampling 1 \\\n--healpix_order 2 \\\n--auto_local_healpix_order 4\\\n--offset_range 5 \\\n--offset_step 2 \\\n--sym O \\\n--low_resol_join_halves 40 \\\n--norm \\\n--scale  \\\n--j 2 \\\n--gpu \"\"  \\\n--pipeline_control Refine3D/job001/\n</code></pre>"},{"location":"user_guide/warptools/quick_start_warptools_tilt_series/#high-resolution-refinements-in-m","title":"High Resolution Refinements in M","text":"<p>While Warp handles the first stages of the data processing pipeline, M lives on its opposite end. It allows you to take refinement results from RELION and perform a multi-particle refinement. For tilt series data, M will likely deliver a noticeable resolution boost compared to initial tilt series alignments from IMOD or AreTomo. Refinement of in situ data will also benefit significantly from the unlimited number of classes and transparent mechanisms for combining data from different sources.</p> <p>M strives to be a great tool for in situ data, which have been compared to \u201cmolecular sociology\u201c. Thus, its terminology takes a somewhat sociological angle. A project in M is referred to as a Population. A population contains at least one Data Source and at least one Species. A Data Source contains a set of frame series or tilt series and their metadata. A Species is a map that is refined, as well as particle metadata for the available data sources.</p>"},{"location":"user_guide/warptools/quick_start_warptools_tilt_series/#setup-in-mtools","title":"Setup in <code>MTools</code>","text":""},{"location":"user_guide/warptools/quick_start_warptools_tilt_series/#population-creation","title":"Population Creation","text":"<p>To create a population we run the <code>create_population</code> command from MTools</p> Create Population<pre><code>MTools create_population \\\n--directory m \\\n--name 10491\n</code></pre>"},{"location":"user_guide/warptools/quick_start_warptools_tilt_series/#data-source-setup","title":"Data Source Setup","text":"<p>Next we create a data source from our tilt series settings file.</p> Create Data Source<pre><code>MTools create_source \\\n--name 10491 \\\n--population m/10491.population \\\n--processing_settings warp_tiltseries.settings\n</code></pre>"},{"location":"user_guide/warptools/quick_start_warptools_tilt_series/#species-setup","title":"Species Setup","text":""},{"location":"user_guide/warptools/quick_start_warptools_tilt_series/#create-mask-using-relion","title":"Create Mask Using RELION","text":"<p>M requires a binary mask around the particle (or region of interest). This mask will be expanded and a soft edge will be added automatically during refinement.</p> Mask Creation in RELION<pre><code>relion_mask_create \\\n--i relion/Refine3D/job002/run_class001.mrc \\\n--o m/mask_4apx.mrc \\\n--ini_threshold 0.04\n</code></pre>"},{"location":"user_guide/warptools/quick_start_warptools_tilt_series/#setup-species-with-create_species","title":"Setup Species with <code>create_species</code>","text":"<p>Now we create our species, resampling to a smaller pixel size as we hope to reach higher resolution.</p> Create Species with MTools<pre><code>MTools create_species \\\n--population m/10491.population \\\n--name apoferritin \\\n--diameter 130 \\\n--sym O \\\n--temporal_samples 1 \\\n--half1 relion/Refine3D/job002/run_half1_class001_unfil.mrc \\\n--half2 relion/Refine3D/job002/run_half2_class001_unfil.mrc \\\n--mask m/mask_4apx.mrc \\\n--particles_relion relion/Refine3D/job002/run_data.star \\\n--angpix_resample 0.7894 \\\n--lowpass 10\n</code></pre>"},{"location":"user_guide/warptools/quick_start_warptools_tilt_series/#running-m-with-mcore","title":"Running M with <code>MCore</code>","text":""},{"location":"user_guide/warptools/quick_start_warptools_tilt_series/#checking-our-setup","title":"Checking our Setup","text":"<p>First, we run an iteration of M without any refinements to check that everything imported correctly.</p> Run M to Check Setup<pre><code>MCore \\\n--population m/10491.population \\\n--iter 0\n</code></pre> <p>This yields a 6.4\u00c5 map in our hands.</p> <p>Tip</p> <p><code>--perdevice_refine</code> can be used to run multiple worker processes per GPU</p>"},{"location":"user_guide/warptools/quick_start_warptools_tilt_series/#first-refinement","title":"First Refinement","text":"<p>Now we know things have imported correctly we run an iteration of M with 2D image warp refinement, particle pose refinement and CTF refinement. We use an exhaustive defocus search in the first sub-iteration (<code>--ctf_defocusexhaustive</code>) as initial estimates can be quite far from the true value and the gradient based optimisation in M may get stuck in local minima.</p> First M Refinement with 2D Image Warp, Particle Poses Refinement and CTF Refinement<pre><code>MCore \\\n--population m/10491.population \\\n--refine_imagewarp 6x4 \\\n--refine_particles \\\n--ctf_defocus \\\n--ctf_defocusexhaustive \\\n--perdevice_refine 4\n</code></pre> <p>This yields a map at 3.6 \u00c5.</p>"},{"location":"user_guide/warptools/quick_start_warptools_tilt_series/#benefits-from-a-higher-resolution-reference","title":"Benefits from a Higher Resolution Reference","text":"<p>The reference now has better resolution so we can expect things to improve further without adding any additional parameters.</p> <p>Tip</p> <p>Introduce new parameters one by one when refining in M. Be wary of the potential for overfitting parameters if data are weak!</p> Second M Refinement with 2D Image Warp, Particle Poses Refinement and CTF Refinement<pre><code>MCore \\\n--population m/10491.population \\\n--refine_imagewarp 6x4 \\\n--refine_particles \\\n--ctf_defocus \n</code></pre> <p>This gave us a modest improvement and we now have a 3.1\u00c5 map.</p>"},{"location":"user_guide/warptools/quick_start_warptools_tilt_series/#stage-angle-refinement","title":"+ Stage Angle Refinement","text":"<pre><code>MCore \\\n--population m/10491.population \\\n--refine_imagewarp 6x4 \\\n--refine_particles \\\n--refine_stageangles \n</code></pre> <p>3.0 A</p>"},{"location":"user_guide/warptools/quick_start_warptools_tilt_series/#magnificationcszernike3","title":"+ Magnification/Cs/Zernike3","text":"<p>We can add more CTF parameters and see whether this yields any improvements</p> <pre><code>MCore \\\n--population m/10491.population \\\n--refine_imagewarp 6x4 \\\n--refine_particles \\\n--refine_mag \\\n--ctf_cs \\\n--ctf_defocus \\\n--ctf_zernike3 \n</code></pre> <p>In this case, the map stayed at 3.0\u00c5.</p>"},{"location":"user_guide/warptools/quick_start_warptools_tilt_series/#weights-per-tilt-series","title":"+ Weights (Per-Tilt Series)","text":"Estimate Weights (Per-Tilt Series)<pre><code>EstimateWeights \\\n--population m/10491.population \\\n--source 10491 \\\n--resolve_items\n\nMCore \\\n--population m/10491.population\n</code></pre>"},{"location":"user_guide/warptools/quick_start_warptools_tilt_series/#weights-per-tilt-averaged-over-all-tilt-series","title":"+ Weights (Per-Tilt, Averaged over all Tilt Series)","text":"<pre><code>EstimateWeights \\\n--population m/10491.population \\\n--source 10491 \\\n--resolve_frames\n\nMCore \\\n--population m/10491.population \\\n--perdevice_refine 4 \\\n--refine_particles\n</code></pre> <p>3.0 \u00c5</p>"},{"location":"user_guide/warptools/quick_start_warptools_tilt_series/#temporal-pose-resolution","title":"+ Temporal Pose Resolution","text":"<p>M is capable of refining how particle poses change over time through a tilt series.</p> <pre><code>MTools resample_trajectories \\\n--population m/10491.population \\\n--species m/species/apoferritin_797f75c2/apoferritin.species \\\n--samples 2\n\nMCore \\\n--population m/10491.population \\\n--refine_imagewarp 6x4 \\\n--refine_particles \\\n--refine_stageangles \\\n--refine_mag \\\n--ctf_cs \\\n--ctf_defocus \\\n--ctf_zernike3\n</code></pre> <p>2.9 A</p>"},{"location":"user_guide/warptools/quick_start_warptools_tilt_series/#final-map-29a","title":"Final Map: 2.9\u00c5","text":"Final Map at 2.9\u00c5 after running M"}]}